"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[8170,4320],{"./ts/Bytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>byteLength,mV:()=>concatenate,Gh:()=>fromBase64,H_:()=>fromHex,mL:()=>fromString,s3:()=>toBase64});var buffer=__webpack_require__("./node_modules/buffer/index.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _window$SignalContext,Bytes=function(){function Bytes(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Bytes)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Bytes,[{key:"fromBase64",value:function fromBase64(value){return buffer.lW.from(value,"base64")}},{key:"fromHex",value:function fromHex(value){return buffer.lW.from(value,"hex")}},{key:"fromBinary",value:function fromBinary(value){return buffer.lW.from(value,"binary")}},{key:"fromString",value:function fromString(value){return buffer.lW.from(value)}},{key:"toBase64",value:function toBase64(data){return buffer.lW.from(data).toString("base64")}},{key:"toHex",value:function toHex(data){return buffer.lW.from(data).toString("hex")}},{key:"toBinary",value:function toBinary(data){return buffer.lW.from(data).toString("binary")}},{key:"toString",value:function toString(data){return buffer.lW.from(data).toString()}},{key:"byteLength",value:function byteLength(value){return buffer.lW.byteLength(value)}},{key:"concatenate",value:function concatenate(list){return buffer.lW.concat(list)}},{key:"isEmpty",value:function isEmpty(data){return!data||0===data.length}},{key:"isNotEmpty",value:function isNotEmpty(data){return!this.isEmpty(data)}},{key:"areEqual",value:function areEqual(a,b){return a&&b?0===buffer.lW.compare(a,b):!a&&!b}}]),Bytes}(),bytes=(null===(_window$SignalContext=window.SignalContext)||void 0===_window$SignalContext?void 0:_window$SignalContext.bytes)||new Bytes;function fromBase64(value){return bytes.fromBase64(value)}function fromHex(value){return bytes.fromHex(value)}function fromString(value){return bytes.fromString(value)}function toBase64(data){return bytes.toBase64(data)}function byteLength(value){return bytes.byteLength(value)}function concatenate(list){return bytes.concatenate(list)}},"./ts/badges/BadgeCategory.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>BadgeCategory});var BadgeCategory,_util_enum__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/enum.ts");!function(BadgeCategory){BadgeCategory.Donor="donor",BadgeCategory.Other="other"}(BadgeCategory||(BadgeCategory={}));(0,_util_enum__WEBPACK_IMPORTED_MODULE_0__.m)(BadgeCategory,BadgeCategory.Other)},"./ts/components/AvatarEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{u:()=>AvatarEditor});var react=__webpack_require__("./node_modules/react/index.js"),AvatarIconEditor=__webpack_require__("./ts/components/AvatarIconEditor.tsx"),AvatarModalButtons=__webpack_require__("./ts/components/AvatarModalButtons.tsx"),AvatarPreview=__webpack_require__("./ts/components/AvatarPreview.tsx"),AvatarTextEditor=__webpack_require__("./ts/components/AvatarTextEditor.tsx"),AvatarUploadButton=__webpack_require__("./ts/components/AvatarUploadButton.tsx"),BetterAvatar=__webpack_require__("./ts/components/BetterAvatar.tsx"),avatarDataToBytes=__webpack_require__("./ts/util/avatarDataToBytes.ts"),createAvatarData=__webpack_require__("./ts/util/createAvatarData.ts");function isSameAvatarData(a,b){return!(!a||!b)&&(a.buffer&&b.buffer?a.buffer===b.buffer:a.imagePath&&b.imagePath?a.imagePath===b.imagePath:a.id===b.id)}var EditMode,missingCaseError=__webpack_require__("./ts/util/missingCaseError.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarEditor(_ref){var avatarColor=_ref.avatarColor,avatarPath=_ref.avatarPath,avatarValue=_ref.avatarValue,conversationId=_ref.conversationId,conversationTitle=_ref.conversationTitle,deleteAvatarFromDisk=_ref.deleteAvatarFromDisk,i18n=_ref.i18n,isGroup=_ref.isGroup,onCancel=_ref.onCancel,onSave=_ref.onSave,userAvatarData=_ref.userAvatarData,replaceAvatar=_ref.replaceAvatar,saveAvatarToDisk=_ref.saveAvatarToDisk,_useState2=_slicedToArray((0,react.useState)(),2),provisionalSelectedAvatar=_useState2[0],setProvisionalSelectedAvatar=_useState2[1],_useState4=_slicedToArray((0,react.useState)(avatarValue),2),avatarPreview=_useState4[0],setAvatarPreview=_useState4[1],_useState6=_slicedToArray((0,react.useState)(avatarValue),2),initialAvatar=_useState6[0],setInitialAvatar=_useState6[1],_useState8=_slicedToArray((0,react.useState)(userAvatarData.slice()),2),localAvatarData=_useState8[0],setLocalAvatarData=_useState8[1],_useState10=_slicedToArray((0,react.useState)(!1),2),pendingClear=_useState10[0],setPendingClear=_useState10[1],_useState12=_slicedToArray((0,react.useState)(EditMode.Main),2),editMode=_useState12[0],setEditMode=_useState12[1],selectedAvatar=(0,react.useCallback)((function(avatarToFind){return localAvatarData.find((function(avatarData){return isSameAvatarData(avatarData,avatarToFind)}))}),[localAvatarData])(provisionalSelectedAvatar);(0,react.useEffect)((function(){var shouldCancel=!1;return async function cacheAvatars(){var newAvatarData=await Promise.all(userAvatarData.map((async function(avatarData){if(avatarData.buffer)return avatarData;var buffer=await(0,avatarDataToBytes.u)(avatarData);return Object.assign({},avatarData,{buffer})})));shouldCancel||setLocalAvatarData(newAvatarData)}(),function(){shouldCancel=!0}}),[setLocalAvatarData,userAvatarData]);var content,updateAvatarDataList=(0,react.useCallback)((function(newAvatarData,staleAvatarData){var existingAvatarData=staleAvatarData?localAvatarData.filter((function(avatarData){return avatarData!==staleAvatarData})):localAvatarData;newAvatarData?(setAvatarPreview(newAvatarData.buffer),setLocalAvatarData([newAvatarData].concat(_toConsumableArray(existingAvatarData))),setProvisionalSelectedAvatar(newAvatarData)):(setLocalAvatarData(existingAvatarData),isSameAvatarData(selectedAvatar,staleAvatarData)&&(setAvatarPreview(void 0),setProvisionalSelectedAvatar(void 0)))}),[localAvatarData,selectedAvatar,setAvatarPreview,setLocalAvatarData,setProvisionalSelectedAvatar]),handleAvatarLoaded=(0,react.useCallback)((function(avatarBuffer){setAvatarPreview(avatarBuffer),setInitialAvatar(avatarBuffer)}),[]),hasChanges=initialAvatar!==avatarPreview||Boolean(pendingClear&&avatarPath);if(editMode===EditMode.Main)content=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{className:"AvatarEditor__preview",children:[(0,jsx_runtime.jsx)(AvatarPreview.B,{avatarColor,avatarPath:pendingClear?void 0:avatarPath,avatarValue:avatarPreview,conversationTitle,i18n,isGroup,onAvatarLoaded:handleAvatarLoaded,onClear:function(){setPendingClear(!0),setAvatarPreview(void 0),setProvisionalSelectedAvatar(void 0)}}),(0,jsx_runtime.jsxs)("div",{className:"AvatarEditor__top-buttons",children:[(0,jsx_runtime.jsx)(AvatarUploadButton.h,{className:"AvatarEditor__button AvatarEditor__button--photo",i18n,onChange:function(newAvatar){var avatarData=(0,createAvatarData.s)({buffer:newAvatar,imagePath:"TMP"});saveAvatarToDisk(avatarData,conversationId),updateAvatarDataList(avatarData)}}),(0,jsx_runtime.jsx)("button",{className:"AvatarEditor__button AvatarEditor__button--text",onClick:function(){setProvisionalSelectedAvatar(void 0),setEditMode(EditMode.Text)},type:"button",children:i18n("icu:text")})]})]}),(0,jsx_runtime.jsx)("hr",{className:"AvatarEditor__divider"}),(0,jsx_runtime.jsx)("div",{className:"AvatarEditor__avatar-selector-title",children:i18n("icu:AvatarEditor--choose")}),(0,jsx_runtime.jsx)("div",{className:"AvatarEditor__avatars",children:localAvatarData.map((function(avatarData){return(0,jsx_runtime.jsx)(BetterAvatar.Y,{avatarData,i18n,isSelected:isSameAvatarData(avatarData,selectedAvatar),onClick:function(avatarBuffer){isSameAvatarData(avatarData,selectedAvatar)?avatarData.text?setEditMode(EditMode.Text):avatarData.icon&&setEditMode(EditMode.Custom):(setAvatarPreview(avatarBuffer),setProvisionalSelectedAvatar(avatarData))},onDelete:function(){updateAvatarDataList(void 0,avatarData),deleteAvatarFromDisk(avatarData,conversationId)}},avatarData.id)}))}),(0,jsx_runtime.jsx)(AvatarModalButtons.T,{hasChanges,i18n,onCancel,onSave:function(){selectedAvatar&&replaceAvatar(selectedAvatar,selectedAvatar,conversationId),onSave(avatarPreview)}})]});else if(editMode===EditMode.Text)content=(0,jsx_runtime.jsx)(AvatarTextEditor.g,{avatarData:selectedAvatar,i18n,onCancel:function(){if(setEditMode(EditMode.Main),!selectedAvatar){var actualAvatarSelected=localAvatarData.find((function(avatarData){return avatarData.buffer===avatarPreview}));actualAvatarSelected&&setProvisionalSelectedAvatar(actualAvatarSelected)}},onDone:function(avatarBuffer,avatarData){var newAvatarData=Object.assign({},avatarData,{buffer:avatarBuffer});updateAvatarDataList(newAvatarData,selectedAvatar),setEditMode(EditMode.Main),replaceAvatar(newAvatarData,selectedAvatar,conversationId)}});else{if(editMode!==EditMode.Custom)throw(0,missingCaseError.b)(editMode);if(!selectedAvatar)throw new Error("No selected avatar and editMode is custom");content=(0,jsx_runtime.jsx)(AvatarIconEditor.J,{avatarData:selectedAvatar,i18n,onClose:function(avatarData){avatarData&&(updateAvatarDataList(avatarData,selectedAvatar),replaceAvatar(avatarData,selectedAvatar,conversationId)),setEditMode(EditMode.Main)}})}return(0,jsx_runtime.jsx)("div",{className:"AvatarEditor",children:content})}!function(EditMode){EditMode.Main="Main",EditMode.Custom="Custom",EditMode.Text="Text"}(EditMode||(EditMode={})),AvatarEditor.displayName="AvatarEditor"},"./ts/components/AvatarLightbox.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>AvatarLightbox});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),_AvatarPreview__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./ts/components/AvatarPreview.tsx")),_Lightbox__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Lightbox.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AvatarLightbox(_ref){var avatarColor=_ref.avatarColor,avatarPath=_ref.avatarPath,conversationTitle=_ref.conversationTitle,i18n=_ref.i18n,isGroup=_ref.isGroup,onClose=_ref.onClose;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Lightbox__WEBPACK_IMPORTED_MODULE_3__.e,{closeLightbox:onClose,i18n,isViewOnce:!0,media:[],saveAttachment:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),toggleForwardMessagesModal:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),onMediaPlaybackStart:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),onNextAttachment:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),onPrevAttachment:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),onSelectAttachment:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default(),selectedIndex:0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_AvatarPreview__WEBPACK_IMPORTED_MODULE_2__.B,{avatarColor,avatarPath,conversationTitle,i18n,isGroup,style:{fontSize:"16em",height:"2em",maxHeight:512,maxWidth:512,width:"2em"}})})}AvatarLightbox.displayName="AvatarLightbox"},"./ts/components/AvatarTextEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>AvatarTextEditor});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_util_grapheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/grapheme.ts"),_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/AvatarColorPicker.tsx"),_types_Colors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/types/Colors.ts"),_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/AvatarModalButtons.tsx"),_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/BetterAvatarBubble.tsx"),_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/util/avatarDataToBytes.ts"),_util_createAvatarData__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/util/createAvatarData.ts"),_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ts/util/avatarTextSizeCalculator.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarTextEditor(_ref){var avatarData=_ref.avatarData,i18n=_ref.i18n,onCancel=_ref.onCancel,onDone=_ref.onDone,initialText=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(null==avatarData?void 0:avatarData.text)||""}),[avatarData]),initialColor=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(null==avatarData?void 0:avatarData.color)||_types_Colors__WEBPACK_IMPORTED_MODULE_4__.sj[0]}),[avatarData]),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialText),2),inputText=_useState2[0],setInputText=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__.$)(120).text),2),fontSize=_useState4[0],setFontSize=_useState4[1],_useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialColor),2),selectedColor=_useState6[0],setSelectedColor=_useState6[1],inputRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),focusInput=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){var inputEl=null==inputRef?void 0:inputRef.current;inputEl&&inputEl.focus()}),[]),handleChange=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(ev){var value=ev.target.value;_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(value)<=3&&setInputText(ev.target.value)}),[setInputText]),handlePaste=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(ev){var inputEl=ev.currentTarget,selectionStart=inputEl.selectionStart||0,selectionEnd=inputEl.selectionEnd||inputEl.selectionStart||0,textBeforeSelection=inputText.slice(0,selectionStart),textAfterSelection=inputText.slice(selectionEnd),pastedText=ev.clipboardData.getData("Text");_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(textBeforeSelection)+_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(pastedText)+_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(textAfterSelection)>3&&ev.preventDefault()}),[inputText]),onDoneRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(onDone);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){onDoneRef.current=onDone}),[onDone]);var handleDone=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((async function(){var newAvatarData=(0,_util_createAvatarData__WEBPACK_IMPORTED_MODULE_8__.s)({color:selectedColor,text:inputText}),buffer=await(0,_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_7__.u)(newAvatarData);onDoneRef.current(buffer,newAvatarData)}),[inputText,selectedColor]);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return function(){onDoneRef.current=lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}}),[]);var measureElRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){var measureEl=measureElRef.current;if(measureEl){var nextFontSize=(0,_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__.Z)(120,inputText,(function(candidateFontSize){measureEl.style.fontSize=`${candidateFontSize}px`;var _measureEl$getBoundin=measureEl.getBoundingClientRect(),width=_measureEl$getBoundin.width;return{height:_measureEl$getBoundin.height,width}}));setFontSize(nextFontSize)}}),[inputText]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){focusInput()}),[focusInput]);var hasChanges=initialText!==inputText||selectedColor!==initialColor;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("div",{className:"AvatarEditor__preview",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_6__.p,{color:selectedColor,i18n,onSelect:focusInput,style:{height:120,width:120},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("input",{className:"AvatarTextEditor__input",onChange:handleChange,onPaste:handlePaste,ref:inputRef,style:{fontSize},type:"text",dir:"auto",value:inputText})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("hr",{className:"AvatarEditor__divider"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_3__.n,{i18n,onColorSelected:function(color){setSelectedColor(color),focusInput()},selectedColor}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_5__.T,{hasChanges,i18n,onCancel,onSave:handleDone}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("div",{className:"AvatarTextEditor__measure",ref:measureElRef,children:inputText})]})}},"./ts/components/AvatarUploadButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>AvatarUploadButton});var noop=__webpack_require__("./node_modules/lodash/noop.js"),noop_default=__webpack_require__.n(noop),react=__webpack_require__("./node_modules/react/index.js"),js=__webpack_require__("./node_modules/blueimp-load-image/js/index.js"),js_default=__webpack_require__.n(js),canvasToBytes=__webpack_require__("./ts/util/canvasToBytes.ts");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarUploadButton(_ref){var className=_ref.className,i18n=_ref.i18n,onChange=_ref.onChange,fileInputRef=(0,react.useRef)(null),_useState2=_slicedToArray((0,react.useState)(),2),processingFile=_useState2[0],setProcessingFile=_useState2[1];(0,react.useEffect)((function(){if(!processingFile)return noop_default();var shouldCancel=!1;return async function(){var newAvatar;try{newAvatar=await async function processImageFile(file){var image=(await js_default()(file,{canvas:!0,cover:!0,crop:!0,imageSmoothingQuality:"medium",maxHeight:512,maxWidth:512,minHeight:2,minWidth:2})).image;if(!(image instanceof HTMLCanvasElement))throw new Error("Loaded image was not a canvas");return(0,canvasToBytes.E)(image)}(processingFile)}catch(err){return}shouldCancel||(setProcessingFile(void 0),onChange(newAvatar))}(),function(){shouldCancel=!0}}),[onChange,processingFile]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{className,onClick:function(){var fileInput=fileInputRef.current;fileInput&&(fileInput.value="",fileInput.click())},type:"button",children:i18n("icu:photo")}),(0,jsx_runtime.jsx)("input",{accept:".gif,.jpg,.jpeg,.png,.webp,image/gif,image/jpeg,image/png,image/webp",hidden:!0,onChange:function(event){var file=event.target.files&&event.target.files[0];file&&setProcessingFile(file)},ref:fileInputRef,type:"file"})]})}},"./ts/components/BadgeDescription.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>BadgeDescription});__webpack_require__("./node_modules/react/index.js");var _conversation_ContactName__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BadgeDescription(_ref){var _step,firstName=_ref.firstName,template=_ref.template,title=_ref.title,result=[],lastIndex=0,_iterator=_createForOfIteratorHelper(template.matchAll(/\{short_name\}/g));try{for(_iterator.s();!(_step=_iterator.n()).done;){var matchIndex=_step.value.index||0;result.push(template.slice(lastIndex,matchIndex)),result.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_conversation_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{firstName,title,preferFirstName:!0},matchIndex)),lastIndex=matchIndex+12}}catch(err){_iterator.e(err)}finally{_iterator.f()}return result.push(template.slice(lastIndex)),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:result})}},"./ts/components/BadgeDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{v:()=>BadgeDialog});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),assert=__webpack_require__("./ts/util/assert.ts"),BadgeCategory=__webpack_require__("./ts/badges/BadgeCategory.ts"),Modal=__webpack_require__("./ts/components/Modal.tsx"),Button=__webpack_require__("./ts/components/Button.tsx"),BadgeDescription=__webpack_require__("./ts/components/BadgeDescription.tsx"),Spinner=__webpack_require__("./ts/components/Spinner.tsx"),getBadgeImageFileLocalPath=__webpack_require__("./ts/badges/getBadgeImageFileLocalPath.ts"),BadgeImageTheme=__webpack_require__("./ts/badges/BadgeImageTheme.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function BadgeImage(_ref){var badge=_ref.badge,size=_ref.size,name=badge.name,imagePath=(0,getBadgeImageFileLocalPath.p)(badge,size,BadgeImageTheme.c.Transparent);return imagePath?(0,jsx_runtime.jsx)("img",{alt:name,className:"BadgeImage",src:imagePath,style:{width:size,height:size}}):(0,jsx_runtime.jsx)(Spinner.$j,{ariaLabel:name,moduleClassName:"BadgeImage BadgeImage__loading",size:`${size}px`,svgSize:"normal"})}BadgeImage.displayName="BadgeImage";var times=__webpack_require__("./node_modules/lodash/times.js"),times_default=__webpack_require__.n(times);function BadgeCarouselIndex(_ref){var currentIndex=_ref.currentIndex,totalCount=_ref.totalCount;return(0,assert.Yj)(totalCount>=1,"Expected 1 or more items"),(0,assert.Yj)(currentIndex<totalCount,"Expected current index to be in range"),totalCount<2?null:(0,jsx_runtime.jsx)("div",{"aria-hidden":!0,className:"BadgeCarouselIndex",children:times_default()(totalCount,(function(index){return(0,jsx_runtime.jsx)("div",{className:classnames_default()("BadgeCarouselIndex__dot",currentIndex===index&&"BadgeCarouselIndex__dot--selected")},index)}))})}function BadgeSustainerInstructionsDialog(_ref){var i18n=_ref.i18n,onClose=_ref.onClose;return(0,jsx_runtime.jsxs)(Modal.u_,{modalName:"BadgeSustainerInstructionsDialog",hasXButton:!0,moduleClassName:"BadgeSustainerInstructionsDialog",i18n,onClose,children:[(0,jsx_runtime.jsx)("h1",{className:"BadgeSustainerInstructionsDialog__header",children:i18n("icu:BadgeSustainerInstructions__header")}),(0,jsx_runtime.jsx)("h2",{className:"BadgeSustainerInstructionsDialog__subheader",children:i18n("icu:BadgeSustainerInstructions__subheader")}),(0,jsx_runtime.jsxs)("ol",{className:"BadgeSustainerInstructionsDialog__instructions",children:[(0,jsx_runtime.jsx)("li",{children:i18n("icu:BadgeSustainerInstructions__instructions__1")}),(0,jsx_runtime.jsx)("li",{children:i18n("icu:BadgeSustainerInstructions__instructions__2")}),(0,jsx_runtime.jsx)("li",{children:i18n("icu:BadgeSustainerInstructions__instructions__3")})]})]})}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BadgeDialog(props){var badges=props.badges,i18n=props.i18n,onClose=props.onClose,_useState2=_slicedToArray((0,react.useState)(!1),2),isShowingInstructions=_useState2[0],setIsShowingInstructions=_useState2[1],hasBadges=badges.length>0;return(0,react.useEffect)((function(){hasBadges||isShowingInstructions||onClose()}),[hasBadges,isShowingInstructions,onClose]),isShowingInstructions?(0,jsx_runtime.jsx)(BadgeSustainerInstructionsDialog,{i18n,onClose:function(){return setIsShowingInstructions(!1)}}):hasBadges?(0,jsx_runtime.jsx)(BadgeDialogWithBadges,Object.assign({},props,{onShowInstructions:function(){return setIsShowingInstructions(!0)}})):null}function BadgeDialogWithBadges(_ref){var areWeASubscriber=_ref.areWeASubscriber,badges=_ref.badges,firstName=_ref.firstName,i18n=_ref.i18n,onClose=_ref.onClose,onShowInstructions=_ref.onShowInstructions,title=_ref.title,firstBadge=badges[0];(0,assert.Yj)(firstBadge,"<BadgeDialogWithBadges> got an empty array of badges");var currentBadge,_useState4=_slicedToArray((0,react.useState)(firstBadge.id),2),currentBadgeId=_useState4[0],setCurrentBadgeId=_useState4[1],currentBadgeIndex=badges.findIndex((function(b){return b.id===currentBadgeId}));-1===currentBadgeIndex?(currentBadgeIndex=0,currentBadge=firstBadge):currentBadge=badges[currentBadgeIndex];var navigate=function(change){var newBadge;newBadge=badges[currentBadgeIndex+change],(0,assert.Yj)(newBadge,"<BadgeDialog> tried to select a nonexistent badge"),setCurrentBadgeId(newBadge.id)};return(0,jsx_runtime.jsx)(Modal.u_,{modalName:"BadgeDialog",hasXButton:!0,moduleClassName:"BadgeDialog",i18n,onClose,children:(0,jsx_runtime.jsxs)("div",{className:"BadgeDialog__contents",children:[(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:previous"),className:"BadgeDialog__nav BadgeDialog__nav--previous",disabled:0===currentBadgeIndex,onClick:function(){return navigate(-1)},type:"button"}),(0,jsx_runtime.jsxs)("div",{className:"BadgeDialog__main",children:[(0,jsx_runtime.jsx)(BadgeImage,{badge:currentBadge,size:160}),(0,jsx_runtime.jsx)("div",{className:"BadgeDialog__name",children:currentBadge.name}),(0,jsx_runtime.jsx)("div",{className:"BadgeDialog__description",children:(0,jsx_runtime.jsx)(BadgeDescription.o,{firstName,template:currentBadge.descriptionTemplate,title})}),!areWeASubscriber&&(0,jsx_runtime.jsx)(Button.zx,{className:classnames_default()("BadgeDialog__instructions-button",currentBadge.category!==BadgeCategory.Q.Donor&&"BadgeDialog__instructions-button--hidden"),onClick:onShowInstructions,size:Button.qE.Large,children:i18n("icu:BadgeDialog__become-a-sustainer-button")}),(0,jsx_runtime.jsx)(BadgeCarouselIndex,{currentIndex:currentBadgeIndex,totalCount:badges.length})]}),(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:next"),className:"BadgeDialog__nav BadgeDialog__nav--next",disabled:currentBadgeIndex===badges.length-1,onClick:function(){return navigate(1)},type:"button"})]})})}BadgeCarouselIndex.displayName="BadgeCarouselIndex",BadgeSustainerInstructionsDialog.displayName="BadgeSustainerInstructionsDialog",BadgeDialogWithBadges.displayName="BadgeDialogWithBadges"},"./ts/components/BetterAvatar.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Y:()=>BetterAvatar});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/BetterAvatarBubble.tsx"),_Spinner__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Spinner.tsx"),_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/util/avatarDataToBytes.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BetterAvatar(_ref){var avatarData=_ref.avatarData,i18n=_ref.i18n,isSelected=_ref.isSelected,onClick=_ref.onClick,onDelete=_ref.onDelete,_ref$size=_ref.size,size=void 0===_ref$size?48:_ref$size,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(avatarData.buffer),2),avatarBuffer=_useState2[0],setAvatarBuffer=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(void 0),2),avatarURL=_useState4[0],setAvatarURL=_useState4[1];(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){var shouldCancel=!1;return avatarBuffer?lodash_noop__WEBPACK_IMPORTED_MODULE_0___default():(async function makeAvatar(){var buffer=await(0,_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_4__.u)(avatarData);shouldCancel||setAvatarBuffer(buffer)}(),function(){shouldCancel=!0})}),[avatarBuffer,avatarData]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){if(avatarBuffer){var url=URL.createObjectURL(new Blob([avatarBuffer]));setAvatarURL(url)}}),[avatarBuffer]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return function(){avatarURL&&URL.revokeObjectURL(avatarURL)}}),[avatarURL]);var isEditable=Boolean(avatarData.color),handleDelete=avatarData.icon?void 0:function(ev){ev.preventDefault(),ev.stopPropagation(),onDelete()};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__.p,{i18n,isSelected,onDelete:handleDelete,onSelect:function(){onClick(avatarBuffer)},style:{backgroundImage:avatarURL?`url(${avatarURL})`:void 0,backgroundSize:size,height:size+8,width:size+8},children:[isEditable&&isSelected&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"BetterAvatarBubble--editable"}),!avatarURL&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("div",{className:"module-Avatar__spinner-container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_3__.$j,{size:size-8+"px",svgSize:"small",direction:"on-avatar"})})]})}BetterAvatar.displayName="BetterAvatar"},"./ts/components/DisappearingTimeDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>DisappearingTimeDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),_Select__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/Select.tsx"),_util_durations__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/durations/index.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CSS_MODULE="module-disappearing-time-dialog",UNITS=["seconds","minutes","hours","days","weeks"],UNIT_TO_SEC=new Map([["seconds",1],["minutes",60],["hours",3600],["days",86400],["weeks",604800]]),RANGES=new Map([["seconds",[1,60]],["minutes",[1,60]],["hours",[1,24]],["days",[1,7]],["weeks",[1,5]]]);function DisappearingTimeDialog(props){var _step,i18n=props.i18n,theme=props.theme,_props$initialValue=props.initialValue,initialValue=void 0===_props$initialValue?60:_props$initialValue,onSubmit=props.onSubmit,onClose=props.onClose,initialUnit="seconds",initialUnitValue=1,_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(UNITS);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _unit=_step.value,sec=UNIT_TO_SEC.get(_unit)||1;if(initialValue<sec)break;initialUnit=_unit,initialUnitValue=Math.floor(initialValue/sec)}}catch(err){_iterator.e(err)}finally{_iterator.f()}for(var _useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialUnitValue),2),unitValue=_useState2[0],setUnitValue=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialUnit),2),unit=_useState4[0],setUnit=_useState4[1],range=RANGES.get(unit)||[1,1],values=[],i=range[0];i<range[1];i+=1)values.push(i);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__.U,{dialogName:"DisappearingTimerDialog",moduleClassName:CSS_MODULE,i18n,theme,onClose,title:i18n("icu:DisappearingTimeDialog__title"),hasXButton:!0,actions:[{text:i18n("icu:DisappearingTimeDialog__set"),style:"affirmative",action:function(){var _UNIT_TO_SEC$get;onSubmit(_util_durations__WEBPACK_IMPORTED_MODULE_3__.kC.fromSeconds(unitValue*(null!==(_UNIT_TO_SEC$get=UNIT_TO_SEC.get(unit))&&void 0!==_UNIT_TO_SEC$get?_UNIT_TO_SEC$get:1)))}}],children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("p",{children:i18n("icu:DisappearingTimeDialog__body")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("section",{className:`${CSS_MODULE}__time-boxes`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Select__WEBPACK_IMPORTED_MODULE_2__.P,{ariaLabel:i18n("icu:DisappearingTimeDialog__label--value"),moduleClassName:`${CSS_MODULE}__time-boxes__value`,value:unitValue,onChange:function(newValue){return setUnitValue(parseInt(newValue,10))},options:values.map((function(value){return{value,text:value.toString()}}))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Select__WEBPACK_IMPORTED_MODULE_2__.P,{ariaLabel:i18n("icu:DisappearingTimeDialog__label--units"),moduleClassName:`${CSS_MODULE}__time-boxes__units`,value:unit,onChange:function(newUnit){setUnit(newUnit);var ranges=RANGES.get(newUnit);if(ranges){var _ranges=_slicedToArray(ranges,2),min=_ranges[0],max=_ranges[1];setUnitValue(Math.max(min,Math.min(max-1,unitValue)))}},options:UNITS.map((function(unitName){return{value:unitName,text:{seconds:i18n("icu:DisappearingTimeDialog__seconds"),minutes:i18n("icu:DisappearingTimeDialog__minutes"),hours:i18n("icu:DisappearingTimeDialog__hours"),days:i18n("icu:DisappearingTimeDialog__days"),weeks:i18n("icu:DisappearingTimeDialog__weeks")}[unitName]}}))})]})]})}DisappearingTimeDialog.displayName="DisappearingTimeDialog"},"./ts/components/DisappearingTimerSelect.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>DisappearingTimerSelect});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_expirationTimer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/expirationTimer.ts"),_util_durations__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/durations/index.ts"),_DisappearingTimeDialog__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/DisappearingTimeDialog.tsx"),_Select__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/Select.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CSS_MODULE="module-disappearing-timer-select";function DisappearingTimerSelect(props){var i18n=props.i18n,_props$value=props.value,value=void 0===_props$value?_util_durations__WEBPACK_IMPORTED_MODULE_3__.kC.ZERO:_props$value,onChange=props.onChange,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isModalOpen=_useState2[0],setIsModalOpen=_useState2[1],expirationTimerOptions=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){return _util_expirationTimer__WEBPACK_IMPORTED_MODULE_2__.UD.map((function(seconds){return{value:seconds,text:_util_expirationTimer__WEBPACK_IMPORTED_MODULE_2__.WU(i18n,seconds,{capitalizeOff:!0})}}))}),[i18n]),isCustomTimeSelected=!_util_expirationTimer__WEBPACK_IMPORTED_MODULE_2__.h5.has(value),onSelectChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(newValue){var intValue=_util_durations__WEBPACK_IMPORTED_MODULE_3__.kC.fromSeconds(parseInt(newValue,10));-1===intValue?setTimeout((function(){return setIsModalOpen(!0)}),0):onChange(intValue)}),[onChange]);expirationTimerOptions=[].concat(_toConsumableArray(expirationTimerOptions),[{value:_util_durations__WEBPACK_IMPORTED_MODULE_3__.kC.fromSeconds(-1),text:i18n(isCustomTimeSelected?"icu:selectedCustomDisappearingTimeOption":"icu:customDisappearingTimeOption")}]);var info,modalNode=null;return isModalOpen&&(modalNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_DisappearingTimeDialog__WEBPACK_IMPORTED_MODULE_4__.H,{i18n,initialValue:value,onSubmit:function(newValue){setIsModalOpen(!1),onChange(newValue)},onClose:function(){return setIsModalOpen(!1)}})),isCustomTimeSelected&&(info=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:`${CSS_MODULE}__info`,children:_util_expirationTimer__WEBPACK_IMPORTED_MODULE_2__.WU(i18n,value)})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(CSS_MODULE,!!isCustomTimeSelected&&`${CSS_MODULE}--custom-time`),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Select__WEBPACK_IMPORTED_MODULE_5__.P,{onChange:onSelectChange,value:isCustomTimeSelected?-1:value,options:expirationTimerOptions}),info,modalNode]})}DisappearingTimerSelect.displayName="DisappearingTimerSelect"},"./ts/components/GroupDescriptionInput.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>GroupDescriptionInput});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Input__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Input.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),GroupDescriptionInput=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function GroupDescriptionInput(_ref,ref){var i18n=_ref.i18n,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,onChangeValue=_ref.onChangeValue,value=_ref.value;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Input__WEBPACK_IMPORTED_MODULE_1__.I,{disabled,expandable:!0,i18n,onChange:onChangeValue,placeholder:i18n("icu:setGroupMetadata__group-description-placeholder"),maxLengthCount:480,maxByteCount:8192,ref,value,whenToShowRemainingCount:380})}))},"./ts/components/GroupDescriptionText.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>GroupDescriptionText});__webpack_require__("./node_modules/react/index.js");var _conversation_AddNewLines__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/AddNewLines.tsx"),_conversation_Emojify__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/Emojify.tsx"),_conversation_Linkify__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/Linkify.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js"),renderNonLink=function(_ref){var key=_ref.key,text=_ref.text;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_conversation_Emojify__WEBPACK_IMPORTED_MODULE_2__.u,{text},key)};renderNonLink.displayName="renderNonLink";var renderNonNewLine=function(_ref2){var key=_ref2.key,text=_ref2.text;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_conversation_Linkify__WEBPACK_IMPORTED_MODULE_3__.zR,{text,renderNonLink},key)};function GroupDescriptionText(_ref3){var text=_ref3.text;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_conversation_AddNewLines__WEBPACK_IMPORTED_MODULE_1__.K,{text,renderNonNewLine})}renderNonNewLine.displayName="renderNonNewLine",GroupDescriptionText.displayName="GroupDescriptionText"},"./ts/components/GroupTitleInput.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>GroupTitleInput});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Input__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Input.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),GroupTitleInput=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function GroupTitleInputInner(_ref,ref){var i18n=_ref.i18n,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,onChangeValue=_ref.onChangeValue,value=_ref.value;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Input__WEBPACK_IMPORTED_MODULE_1__.I,{disabled,i18n,onChange:onChangeValue,placeholder:i18n("icu:setGroupMetadata__group-name-placeholder"),maxLengthCount:32,ref,value})}))},"./ts/components/Input.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>Input});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_grapheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/grapheme.ts"),_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/getClassNamesFor.ts"),_hooks_useRefMerger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/hooks/useRefMerger.ts"),_Bytes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/Bytes.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var Input=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function InputInner(_ref,ref){var _ref$countBytes=_ref.countBytes,countBytes=void 0===_ref$countBytes?_Bytes__WEBPACK_IMPORTED_MODULE_5__.k:_ref$countBytes,_ref$countLength=_ref.countLength,countLength=void 0===_ref$countLength?_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX:_ref$countLength,disabled=_ref.disabled,disableSpellcheck=_ref.disableSpellcheck,expandable=_ref.expandable,hasClearButton=_ref.hasClearButton,i18n=_ref.i18n,icon=_ref.icon,_ref$maxByteCount=_ref.maxByteCount,maxByteCount=void 0===_ref$maxByteCount?0:_ref$maxByteCount,_ref$maxLengthCount=_ref.maxLengthCount,maxLengthCount=void 0===_ref$maxLengthCount?0:_ref$maxLengthCount,moduleClassName=_ref.moduleClassName,onChange=_ref.onChange,onEnter=_ref.onEnter,placeholder=_ref.placeholder,_ref$value=_ref.value,value=void 0===_ref$value?"":_ref$value,_ref$whenToShowRemain=_ref.whenToShowRemainingCount,whenToShowRemainingCount=void 0===_ref$whenToShowRemain?1/0:_ref$whenToShowRemain,children=_ref.children,innerRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),valueOnKeydownRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(value),selectionStartOnKeydownRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(value.length),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isLarge=_useState2[0],setIsLarge=_useState2[1],refMerger=(0,_hooks_useRefMerger__WEBPACK_IMPORTED_MODULE_4__.T)(),maybeSetLarge=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){if(expandable){var inputEl=innerRef.current;inputEl&&(inputEl.scrollHeight>inputEl.clientHeight||inputEl.scrollWidth>inputEl.clientWidth)&&setIsLarge(!0)}}),[expandable]),handleKeyDown=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event){onEnter&&"Enter"===event.key&&onEnter();var inputEl=innerRef.current;inputEl&&(valueOnKeydownRef.current=inputEl.value,selectionStartOnKeydownRef.current=inputEl.selectionStart||0)}),[onEnter]),handleChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){var inputEl=innerRef.current;if(inputEl){var newValue=inputEl.value,newLengthCount=maxLengthCount?countLength(newValue):0,newByteCount=maxByteCount?countBytes(newValue):0;newLengthCount<=maxLengthCount&&newByteCount<=maxByteCount?onChange(newValue):(inputEl.value=valueOnKeydownRef.current,inputEl.selectionStart=selectionStartOnKeydownRef.current,inputEl.selectionEnd=selectionStartOnKeydownRef.current),maybeSetLarge()}}),[countLength,countBytes,maxLengthCount,maxByteCount,maybeSetLarge,onChange]),handlePaste=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event){var inputEl=innerRef.current;if(inputEl&&maxLengthCount&&maxByteCount){var selectionStart=inputEl.selectionStart||0,selectionEnd=inputEl.selectionEnd||inputEl.selectionStart||0,textBeforeSelection=value.slice(0,selectionStart),textAfterSelection=value.slice(selectionEnd),pastedText=event.clipboardData.getData("Text"),newLengthCount=countLength(textBeforeSelection)+countLength(pastedText)+countLength(textAfterSelection),newByteCount=countBytes(textBeforeSelection)+countBytes(pastedText)+countBytes(textAfterSelection);(newLengthCount>maxLengthCount||newByteCount>maxByteCount)&&event.preventDefault(),maybeSetLarge()}}),[countLength,countBytes,maxLengthCount,maxByteCount,maybeSetLarge,value]);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){maybeSetLarge()}),[maybeSetLarge]);var lengthCount=maxLengthCount?countLength(value):-1,getClassName=(0,_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_3__.h)("Input",moduleClassName),inputProps={className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__input"),icon&&getClassName("__input--with-icon"),isLarge&&getClassName("__input--large"),expandable&&getClassName("__input--expandable")),disabled:Boolean(disabled),spellCheck:!disableSpellcheck,onChange:handleChange,onKeyDown:handleKeyDown,onPaste:handlePaste,placeholder,ref:refMerger(ref,innerRef),type:"text",value},clearButtonElement=hasClearButton&&value?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{tabIndex:-1,className:getClassName("__clear-icon"),onClick:function(){return onChange("")},type:"button","aria-label":i18n("icu:cancel")}):null,lengthCountElement=lengthCount>=whenToShowRemainingCount&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:getClassName("__remaining-count"),children:maxLengthCount-lengthCount});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__container"),expandable&&getClassName("__container--expandable"),disabled&&getClassName("__container--disabled")),children:[icon?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:getClassName("__icon"),children:icon}):null,expandable?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("textarea",Object.assign({dir:"auto",rows:1},inputProps)):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("input",Object.assign({dir:"auto"},inputProps)),isLarge?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:getClassName("__controls"),children:[clearButtonElement,children]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:getClassName("__remaining-count--large"),children:lengthCountElement})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:getClassName("__controls"),children:[lengthCountElement,clearButtonElement,children]})]})}))},"./ts/components/Lightbox.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>Lightbox});var noop=__webpack_require__("./node_modules/lodash/noop.js"),noop_default=__webpack_require__.n(noop),react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),react_dom=__webpack_require__("./node_modules/react-dom/index.js"),react_spring_web_esm=__webpack_require__("./node_modules/@react-spring/web/dist/react-spring-web.esm.js"),GoogleChrome=__webpack_require__("./ts/util/GoogleChrome.ts"),log=__webpack_require__("./ts/logging/log.ts"),Avatar=__webpack_require__("./ts/components/Avatar.tsx"),MIME=__webpack_require__("./ts/types/MIME.ts"),timestamp=__webpack_require__("./ts/util/timestamp.ts"),moment=__webpack_require__("./node_modules/moment/moment.js"),moment_default=__webpack_require__.n(moment);var Attachment=__webpack_require__("./ts/types/Attachment.ts"),useRestoreFocus=__webpack_require__("./ts/hooks/useRestoreFocus.ts"),usePrevious=__webpack_require__("./ts/hooks/usePrevious.ts"),keyboard=__webpack_require__("./ts/util/keyboard.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var INITIAL_IMAGE_TRANSFORM={scale:1,translateX:0,translateY:0,config:{clamp:!0,friction:20,mass:.5,tension:350}},THUMBNAIL_SPRING_CONFIG={mass:1,tension:986,friction:64,velocity:0};function Lightbox(_ref){var _media$at,children=_ref.children,closeLightbox=_ref.closeLightbox,getConversation=_ref.getConversation,media=_ref.media,i18n=_ref.i18n,_ref$isViewOnce=_ref.isViewOnce,isViewOnce=void 0!==_ref$isViewOnce&&_ref$isViewOnce,saveAttachment=_ref.saveAttachment,selectedIndex=_ref.selectedIndex,toggleForwardMessagesModal=_ref.toggleForwardMessagesModal,onMediaPlaybackStart=_ref.onMediaPlaybackStart,onNextAttachment=_ref.onNextAttachment,onPrevAttachment=_ref.onPrevAttachment,onSelectAttachment=_ref.onSelectAttachment,hasNextMessage=_ref.hasNextMessage,hasPrevMessage=_ref.hasPrevMessage,hasThumbnails=media.length>1,messageId=null===(_media$at=media.at(0))||void 0===_media$at?void 0:_media$at.message.id,needsAnimation=messageId!==(0,usePrevious.D)(messageId,messageId),_React$useState2=_slicedToArray(react.useState(),2),root=_React$useState2[0],setRoot=_React$useState2[1],_useState2=_slicedToArray((0,react.useState)(null),2),videoElement=_useState2[0],setVideoElement=_useState2[1],_useState4=_slicedToArray((0,react.useState)(),2),videoTime=_useState4[0],setVideoTime=_useState4[1],_useState6=_slicedToArray((0,react.useState)(!1),2),isZoomed=_useState6[0],setIsZoomed=_useState6[1],containerRef=(0,react.useRef)(null),focusRef=_slicedToArray((0,useRestoreFocus.H)(),1)[0],animateRef=(0,react.useRef)(null),dragCacheRef=(0,react.useRef)(),imageRef=(0,react.useRef)(null),zoomCacheRef=(0,react.useRef)(),onPrevious=(0,react.useCallback)((function(event){event.preventDefault(),event.stopPropagation(),isZoomed||onPrevAttachment()}),[isZoomed,onPrevAttachment]),onNext=(0,react.useCallback)((function(event){event.preventDefault(),event.stopPropagation(),isZoomed||onNextAttachment()}),[isZoomed,onNextAttachment]),onTimeUpdate=(0,react.useCallback)((function(){videoElement&&setVideoTime(videoElement.currentTime)}),[setVideoTime,videoElement]),onKeyDown=(0,react.useCallback)((function(event){switch(event.key){case"Escape":closeLightbox(),event.preventDefault(),event.stopPropagation();break;case(0,keyboard.x)("start"):onPrevious(event);break;case(0,keyboard.x)("end"):onNext(event)}}),[closeLightbox,onNext,onPrevious]),onClose=function(event){event.stopPropagation(),event.preventDefault(),closeLightbox()},playVideo=(0,react.useCallback)((function(){videoElement&&(videoElement.paused?(onMediaPlaybackStart(),videoElement.play()):videoElement.pause())}),[videoElement,onMediaPlaybackStart]);(0,react.useEffect)((function(){var div=document.createElement("div");return document.body.appendChild(div),setRoot(div),function(){document.body.removeChild(div),setRoot(void 0)}}),[]),(0,react.useEffect)((function(){return document.addEventListener("keydown",onKeyDown,true),function(){document.removeEventListener("keydown",onKeyDown,true)}}),[onKeyDown]);var _ref2=media[selectedIndex]||{},attachment=_ref2.attachment,contentType=_ref2.contentType,_ref2$loop=_ref2.loop,loop=void 0!==_ref2$loop&&_ref2$loop,objectURL=_ref2.objectURL,message=_ref2.message,isAttachmentGIF=(0,Attachment.DQ)(attachment?[attachment]:void 0);(0,react.useEffect)((function(){return playVideo(),videoElement&&isViewOnce?isAttachmentGIF?noop_default():(videoElement.addEventListener("timeupdate",onTimeUpdate),function(){videoElement.removeEventListener("timeupdate",onTimeUpdate)}):noop_default()}),[isViewOnce,isAttachmentGIF,onTimeUpdate,playVideo,videoElement]);var _useSpring2=_slicedToArray((0,react_spring_web_esm.useSpring)((function(){return INITIAL_IMAGE_TRANSFORM})),2),_useSpring2$=_useSpring2[0],scale=_useSpring2$.scale,translateX=_useSpring2$.translateX,translateY=_useSpring2$.translateY,springApi=_useSpring2[1],thumbnailsMarginInlineStart=0-(52*selectedIndex+22),_useSpring4=_slicedToArray((0,react_spring_web_esm.useSpring)({config:THUMBNAIL_SPRING_CONFIG,to:{marginInlineStart:thumbnailsMarginInlineStart,opacity:hasThumbnails?1:0}},[selectedIndex,hasThumbnails]),2),thumbnailsStyle=_useSpring4[0],thumbnailsAnimation=_useSpring4[1];(0,react.useEffect)((function(){needsAnimation&&(thumbnailsAnimation.stop(),thumbnailsAnimation.set({marginInlineStart:thumbnailsMarginInlineStart+52*(0===selectedIndex?1:-1),opacity:0}),thumbnailsAnimation.start({marginInlineStart:thumbnailsMarginInlineStart,opacity:1}))}),[needsAnimation,selectedIndex,thumbnailsMarginInlineStart,thumbnailsAnimation]);var maxBoundsLimiter=(0,react.useCallback)((function(x,y){var zoomCache=zoomCacheRef.current;if(!zoomCache)return[0,0];var maxX=zoomCache.maxX,maxY=zoomCache.maxY;return[Math.min(maxX,Math.max(-maxX,x)),Math.min(maxY,Math.max(-maxY,y))]}),[]),positionImage=(0,react.useCallback)((function(ev){var zoomCache=zoomCacheRef.current;if(zoomCache){var maxX=zoomCache.maxX,maxY=zoomCache.maxY,screenWidth=zoomCache.screenWidth,screenHeight=zoomCache.screenHeight,shouldTranslateX=3*maxX>screenWidth,shouldTranslateY=3*maxY>screenHeight,offsetX=screenWidth/2-ev.clientX,offsetY=screenHeight/2-ev.clientY,_maxBoundsLimiter2=_slicedToArray(maxBoundsLimiter(3*offsetX,3*offsetY),2),x=_maxBoundsLimiter2[0],y=_maxBoundsLimiter2[1];springApi.start({scale:3,translateX:shouldTranslateX?x:void 0,translateY:shouldTranslateY?y:void 0})}}),[maxBoundsLimiter,springApi]),handleTouchStart=(0,react.useCallback)((function(ev){var touch=_slicedToArray(ev.touches,1)[0];dragCacheRef.current={startX:touch.clientX,startY:touch.clientY,translateX:translateX.get(),translateY:translateY.get()}}),[translateY,translateX]),handleTouchMove=(0,react.useCallback)((function(ev){var dragCache=dragCacheRef.current;if(dragCache){var touch=_slicedToArray(ev.touches,1)[0],deltaX=touch.clientX-dragCache.startX,deltaY=touch.clientY-dragCache.startY,x=dragCache.translateX+deltaX,y=dragCache.translateY+deltaY;springApi.start({scale:3,translateX:x,translateY:y})}}),[springApi]),zoomButtonHandler=(0,react.useCallback)((function(ev){ev.preventDefault(),ev.stopPropagation();var imageNode=imageRef.current,animateNode=animateRef.current;if(imageNode&&animateNode)if(isZoomed)springApi.start(INITIAL_IMAGE_TRANSFORM),setIsZoomed(!1);else{var maxX=imageNode.offsetWidth,maxY=imageNode.offsetHeight,screenHeight=window.innerHeight,screenWidth=window.innerWidth;zoomCacheRef.current={maxX,maxY,screenHeight,screenWidth};var shouldTranslateX=3*maxX>screenWidth,shouldTranslateY=3*maxY>screenHeight,_animateNode$getBound=animateNode.getBoundingClientRect(),height=_animateNode$getBound.height,left=_animateNode$getBound.left,top=_animateNode$getBound.top,width=_animateNode$getBound.width,offsetX=ev.clientX-left-width/2,offsetY=ev.clientY-top-height/2,posX=3*-offsetX+translateX.get(),posY=3*-offsetY+translateY.get(),_maxBoundsLimiter4=_slicedToArray(maxBoundsLimiter(posX,posY),2),x=_maxBoundsLimiter4[0],y=_maxBoundsLimiter4[1];springApi.start({scale:3,translateX:shouldTranslateX?x:void 0,translateY:shouldTranslateY?y:void 0}),setIsZoomed(!0)}}),[isZoomed,maxBoundsLimiter,translateX,translateY,springApi]);(0,react.useEffect)((function(){var animateNode=animateRef.current,hasListener=!1;return animateNode&&isZoomed&&(hasListener=!0,document.addEventListener("mousemove",positionImage),document.addEventListener("touchmove",handleTouchMove),document.addEventListener("touchstart",handleTouchStart)),function(){hasListener&&(document.removeEventListener("mousemove",positionImage),document.removeEventListener("touchmove",handleTouchMove),document.removeEventListener("touchstart",handleTouchStart))}}),[handleTouchMove,handleTouchStart,isZoomed,positionImage]);var content,caption=null==attachment?void 0:attachment.caption,hasControls=!1;if(contentType){var isImageTypeSupported=GoogleChrome.T(contentType),isVideoTypeSupported=GoogleChrome.eq(contentType),isUnsupportedImageType=!isImageTypeSupported&&(0,MIME.Or)(contentType),isUnsupportedVideoType=!isVideoTypeSupported&&(0,MIME.Wv)(contentType);if(isImageTypeSupported)content=objectURL?(0,jsx_runtime.jsx)("div",{className:"Lightbox__zoomable-container",children:(0,jsx_runtime.jsx)("button",{className:"Lightbox__zoom-button",onClick:zoomButtonHandler,type:"button",children:(0,jsx_runtime.jsx)("img",{alt:i18n("icu:lightboxImageAlt"),className:"Lightbox__object",onContextMenu:function(ev){ev&&contentType!==MIME.Ih&&!/image\/jpe?g/g.test(contentType)&&ev.preventDefault()},src:objectURL,ref:imageRef})})}):(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:lightboxImageAlt"),className:classnames_default()({Lightbox__object:!0,Lightbox__unsupported:!0,"Lightbox__unsupported--missing":!0}),onClick:onClose,type:"button"});else if(isVideoTypeSupported){var shouldLoop=loop||isAttachmentGIF||isViewOnce;content=(0,jsx_runtime.jsx)("video",{className:"Lightbox__object Lightbox__object--video",controls:!shouldLoop,loop:shouldLoop,ref:setVideoElement,children:(0,jsx_runtime.jsx)("source",{src:objectURL})},objectURL),hasControls=!0}else isUnsupportedImageType||isUnsupportedVideoType?content=(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:unsupportedAttachment"),className:classnames_default()({Lightbox__object:!0,Lightbox__unsupported:!0,"Lightbox__unsupported--image":isUnsupportedImageType,"Lightbox__unsupported--video":isUnsupportedVideoType}),onClick:onClose,type:"button"}):(log.info("Lightbox: Unexpected content type",{contentType}),content=(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:unsupportedAttachment"),className:"Lightbox__object Lightbox__unsupported Lightbox__unsupported--file",onClick:onClose,type:"button"}))}else content=(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children});var seconds,time,hasNext=!isZoomed&&(selectedIndex<media.length-1||hasNextMessage),hasPrevious=!isZoomed&&(selectedIndex>0||hasPrevMessage);return root?(0,react_dom.createPortal)((0,jsx_runtime.jsx)("div",{className:classnames_default()("Lightbox Lightbox__container",{"Lightbox__container--zoom":isZoomed,"Lightbox__container--has-controls":hasControls}),onClick:function(event){event.stopPropagation(),event.preventDefault(),closeLightbox()},onKeyUp:function(event){containerRef&&event.target!==containerRef.current||27!==event.keyCode||closeLightbox()},ref:containerRef,role:"presentation",children:(0,jsx_runtime.jsxs)("div",{className:"Lightbox__animated",children:[(0,jsx_runtime.jsxs)("div",{className:"Lightbox__main-container",tabIndex:-1,ref:focusRef,children:[(0,jsx_runtime.jsxs)("div",{className:"Lightbox__header",children:[getConversation?(0,jsx_runtime.jsx)(LightboxHeader,{getConversation,i18n,message}):(0,jsx_runtime.jsx)("div",{}),(0,jsx_runtime.jsxs)("div",{className:"Lightbox__controls",children:[isViewOnce?null:(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:forwardMessage"),className:"Lightbox__button Lightbox__button--forward",onClick:function(event){if(!isViewOnce){event.preventDefault(),event.stopPropagation(),closeLightbox();var mediaItem=media[selectedIndex];toggleForwardMessagesModal([mediaItem.message.id])}},type:"button"}),isViewOnce?null:(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:save"),className:"Lightbox__button Lightbox__button--save",onClick:function(event){if(!isViewOnce){event.stopPropagation(),event.preventDefault();var mediaItem=media[selectedIndex],attachment=mediaItem.attachment,message=mediaItem.message,index=mediaItem.index;saveAttachment(attachment,message.sent_at,index+1)}},type:"button"}),(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:close"),className:"Lightbox__button Lightbox__button--close",onClick:closeLightbox,type:"button"})]})]}),(0,jsx_runtime.jsxs)(react_spring_web_esm.animated.div,{className:classnames_default()("Lightbox__object--container",{"Lightbox__object--container--zoom":isZoomed}),ref:animateRef,style:{transform:(0,react_spring_web_esm.to)([scale,translateX,translateY],(function(s,x,y){return`translate(${x}px, ${y}px) scale(${s})`}))},children:[content,hasPrevious&&(0,jsx_runtime.jsx)("div",{className:"Lightbox__nav-prev",children:(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:previous"),className:"Lightbox__button Lightbox__button--previous",onClick:onPrevious,type:"button"})}),hasNext&&(0,jsx_runtime.jsx)("div",{className:"Lightbox__nav-next",children:(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:next"),className:"Lightbox__button Lightbox__button--next",onClick:onNext,type:"button"})})]})]}),(0,jsx_runtime.jsxs)("div",{className:"Lightbox__footer",children:[isViewOnce&&videoTime?(0,jsx_runtime.jsx)("div",{className:"Lightbox__timestamp",children:(seconds=videoTime,time=moment_default().utc(1e3*seconds),seconds>36e5?time.format("H:mm:ss"):time.format("m:ss"))}):null,caption?(0,jsx_runtime.jsx)("div",{className:"Lightbox__caption",children:caption}):null,(0,jsx_runtime.jsx)("div",{className:"Lightbox__thumbnails--container",children:(0,jsx_runtime.jsx)(react_spring_web_esm.animated.div,{className:"Lightbox__thumbnails",style:thumbnailsStyle,children:hasThumbnails?media.map((function(item,index){return(0,jsx_runtime.jsx)("button",{className:classnames_default()({Lightbox__thumbnail:!0,"Lightbox__thumbnail--selected":index===selectedIndex}),type:"button",onClick:function(event){event.stopPropagation(),event.preventDefault(),onSelectAttachment(index)},children:item.thumbnailObjectUrl?(0,jsx_runtime.jsx)("img",{alt:i18n("icu:lightboxImageAlt"),src:item.thumbnailObjectUrl}):(0,jsx_runtime.jsx)("div",{className:"Lightbox__thumbnail--unavailable"})},item.thumbnailObjectUrl)})):void 0})})]})]})}),root):null}function LightboxHeader(_ref3){var _message$received_at_,getConversation=_ref3.getConversation,i18n=_ref3.i18n,message=_ref3.message,conversation=getConversation(message.conversationId),now=Date.now();return(0,jsx_runtime.jsxs)("div",{className:"Lightbox__header--container",children:[(0,jsx_runtime.jsx)("div",{className:"Lightbox__header--avatar",children:(0,jsx_runtime.jsx)(Avatar.qE,{acceptedMessageRequest:conversation.acceptedMessageRequest,avatarPath:conversation.avatarPath,badge:void 0,color:conversation.color,conversationType:conversation.type,i18n,isMe:conversation.isMe,phoneNumber:conversation.e164,profileName:conversation.profileName,sharedGroupNames:conversation.sharedGroupNames,size:Avatar.DZ.THIRTY_TWO,title:conversation.title,unblurredAvatarPath:conversation.unblurredAvatarPath})}),(0,jsx_runtime.jsxs)("div",{className:"Lightbox__header--content",children:[(0,jsx_runtime.jsx)("div",{className:"Lightbox__header--name",children:conversation.title}),(0,jsx_runtime.jsx)("div",{className:"Lightbox__header--timestamp",children:(0,timestamp.Wl)(i18n,null!==(_message$received_at_=message.received_at_ms)&&void 0!==_message$received_at_?_message$received_at_:now)})]})]})}LightboxHeader.displayName="LightboxHeader"},"./ts/components/Select.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>Select});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),Select=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function SelectInner(_ref,ref){var ariaLabel=_ref.ariaLabel,disabled=_ref.disabled,id=_ref.id,moduleClassName=_ref.moduleClassName,name=_ref.name,onChange=_ref.onChange,options=_ref.options,value=_ref.value,onSelectChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event){onChange(event.target.value)}),[onChange]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(["module-select",moduleClassName]),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("select",{"aria-label":ariaLabel,disabled,id,name,value,onChange:onSelectChange,ref,children:options.map((function(_ref2){var optionDisabled=_ref2.disabled,text=_ref2.text,optionValue=_ref2.value;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("option",{disabled:optionDisabled,value:optionValue,"aria-label":text,children:text},optionValue)}))})})}))},"./ts/components/Tooltip.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{TQ:()=>TooltipPlacement,u:()=>Tooltip});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__),react_popper__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/react-popper/lib/esm/Manager.js"),react_popper__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react-popper/lib/esm/Reference.js"),react_popper__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react-popper/lib/esm/Popper.js"),_util_theme__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/theme.ts"),_util_refMerger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/util/refMerger.ts"),_util_popperUtil__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/util/popperUtil.ts"),_services_InteractionMode__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/services/InteractionMode.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TooltipPlacement,TooltipEventWrapper=react__WEBPACK_IMPORTED_MODULE_1__.forwardRef((function TooltipEvent(_ref,ref){var onHoverChanged=_ref.onHoverChanged,children=_ref.children,wrapperRef=react__WEBPACK_IMPORTED_MODULE_1__.useRef(null),on=react__WEBPACK_IMPORTED_MODULE_1__.useCallback((function(){onHoverChanged(!0)}),[onHoverChanged]),off=react__WEBPACK_IMPORTED_MODULE_1__.useCallback((function(){onHoverChanged(!1)}),[onHoverChanged]),onFocus=react__WEBPACK_IMPORTED_MODULE_1__.useCallback((function(){"keyboard"===(0,_services_InteractionMode__WEBPACK_IMPORTED_MODULE_7__.G)()&&on()}),[on]);return react__WEBPACK_IMPORTED_MODULE_1__.useEffect((function(){var wrapperEl=wrapperRef.current;return wrapperEl?(wrapperEl.addEventListener("mouseenter",on),wrapperEl.addEventListener("mouseleave",off),function(){wrapperEl.removeEventListener("mouseenter",on),wrapperEl.removeEventListener("mouseleave",off)}):lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}),[on,off]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("span",{onFocus,onBlur:off,ref:(0,_util_refMerger__WEBPACK_IMPORTED_MODULE_4__.M)(ref,wrapperRef),children})}));function Tooltip(_ref2){var children=_ref2.children,className=_ref2.className,content=_ref2.content,direction=_ref2.direction,sticky=_ref2.sticky,theme=_ref2.theme,_ref2$popperModifiers=_ref2.popperModifiers,popperModifiers=void 0===_ref2$popperModifiers?[]:_ref2$popperModifiers,_React$useState2=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_1__.useState(!1),2),isHovering=_React$useState2[0],setIsHovering=_React$useState2[1],showTooltip=isHovering||Boolean(sticky),tooltipThemeClassName=theme?`module-tooltip--${(0,_util_theme__WEBPACK_IMPORTED_MODULE_3__.j)(theme)}`:void 0;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_popper__WEBPACK_IMPORTED_MODULE_8__.dK,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_popper__WEBPACK_IMPORTED_MODULE_9__.s,{children:function(_ref3){var ref=_ref3.ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(TooltipEventWrapper,{ref,onHoverChanged:setIsHovering,children})}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_popper__WEBPACK_IMPORTED_MODULE_10__.r,{placement:direction,modifiers:[(0,_util_popperUtil__WEBPACK_IMPORTED_MODULE_5__.E)(12)].concat(_toConsumableArray(popperModifiers)),children:function(_ref4){var arrowProps=_ref4.arrowProps,placement=_ref4.placement,ref=_ref4.ref,style=_ref4.style;return showTooltip&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_2___default()("module-tooltip",tooltipThemeClassName,className),ref,style,"data-placement":placement,children:[content,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"module-tooltip-arrow",ref:arrowProps.ref,style:arrowProps.style})]})}})]})}!function(TooltipPlacement){TooltipPlacement.Top="top",TooltipPlacement.Right="right",TooltipPlacement.Bottom="bottom",TooltipPlacement.Left="left"}(TooltipPlacement||(TooltipPlacement={})),Tooltip.displayName="Tooltip"},"./ts/components/conversation/GroupDescription.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>GroupDescription});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Modal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Modal.tsx"),_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/GroupDescriptionText.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function GroupDescription(_ref){var i18n=_ref.i18n,title=_ref.title,text=_ref.text,textRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),hasReadMore=_useState2[0],setHasReadMore=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),showFullDescription=_useState4[0],setShowFullDescription=_useState4[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){textRef&&textRef.current&&setHasReadMore(textRef.current.scrollHeight-5>textRef.current.clientHeight)}),[setHasReadMore,text,textRef]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[showFullDescription&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Modal__WEBPACK_IMPORTED_MODULE_1__.u_,{modalName:"GroupDescription",hasXButton:!0,i18n,onClose:function(){return setShowFullDescription(!1)},title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__.F,{text})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"GroupDescription__text",ref:textRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__.F,{text})}),hasReadMore&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("button",{className:"GroupDescription__read-more",onClick:function(ev){ev.preventDefault(),ev.stopPropagation(),setShowFullDescription(!0)},type:"button",children:i18n("icu:GroupDescription__read-more")})]})}},"./ts/components/conversation/conversation-details/ConversationDetails.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AsAdmin:()=>AsAdmin,AsLastAdmin:()=>AsLastAdmin,AsOnlyAdmin:()=>AsOnlyAdmin,Basic:()=>Basic,GroupEditable:()=>GroupEditable,GroupEditableWithCustomDisappearingTimeout:()=>GroupEditableWithCustomDisappearingTimeout,GroupLinksOn:()=>GroupLinksOn,_11:()=>_11,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ConversationDetails_stories});var times=__webpack_require__("./node_modules/lodash/times.js"),times_default=__webpack_require__.n(times),react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),setupI18n=__webpack_require__("./ts/util/setupI18n.ts"),messages=__webpack_require__("./_locales/en/messages.json"),Button=__webpack_require__("./ts/components/Button.tsx"),Tooltip=__webpack_require__("./ts/components/Tooltip.tsx"),assert=__webpack_require__("./ts/util/assert.ts"),getMutedUntilText=__webpack_require__("./ts/util/getMutedUntilText.ts"),missingCaseError=__webpack_require__("./ts/util/missingCaseError.ts"),durations=__webpack_require__("./ts/util/durations/index.ts"),DisappearingTimerSelect=__webpack_require__("./ts/components/DisappearingTimerSelect.tsx"),PanelRow=__webpack_require__("./ts/components/conversation/conversation-details/PanelRow.tsx"),PanelSection=__webpack_require__("./ts/components/conversation/conversation-details/PanelSection.tsx"),AddGroupMembersModal=__webpack_require__("./ts/components/conversation/conversation-details/AddGroupMembersModal.tsx"),ConversationDetailsActions=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsActions.tsx"),ConversationDetailsHeader=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsHeader.tsx"),ConversationDetailsIcon=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsIcon.tsx"),ConversationDetailsMediaList=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsMediaList.tsx"),ConversationDetailsMembershipList=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsMembershipList.tsx"),EditConversationAttributesModal=__webpack_require__("./ts/components/conversation/conversation-details/EditConversationAttributesModal.tsx"),util=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),getCustomColorStyle=__webpack_require__("./ts/util/getCustomColorStyle.ts"),ConfirmationDialog=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),uuid_browser=__webpack_require__("./node_modules/uuid-browser/index.js"),uuid_browser_default=__webpack_require__.n(uuid_browser),getMuteOptions=__webpack_require__("./ts/util/getMuteOptions.ts"),parseIntOrThrow=__webpack_require__("./ts/util/parseIntOrThrow.ts"),CircleCheckbox=__webpack_require__("./ts/components/CircleCheckbox.tsx"),Modal=__webpack_require__("./ts/components/Modal.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ConversationNotificationsModal(_ref){var i18n=_ref.i18n,id=_ref.id,muteExpiresAt=_ref.muteExpiresAt,onClose=_ref.onClose,setMuteExpiration=_ref.setMuteExpiration,muteOptions=(0,react.useMemo)((function(){return(0,getMuteOptions.L)(muteExpiresAt,i18n).map((function(_ref2){return{disabled:_ref2.disabled,text:_ref2.name,value:_ref2.value}})).filter((function(x){return x.value>0}))}),[i18n,muteExpiresAt]),_useState2=_slicedToArray((0,react.useState)(muteExpiresAt),2),muteExpirationValue=_useState2[0],setMuteExpirationValue=_useState2[1],htmlIds=(0,react.useMemo)((function(){return Array.from({length:muteOptions.length},(function(){return uuid_browser_default()()}))}),[muteOptions.length]);return(0,jsx_runtime.jsx)(Modal.u_,{modalName:"ConversationNotificationsModal",hasXButton:!0,onClose,i18n,title:i18n("icu:muteNotificationsTitle"),modalFooter:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.zx,{onClick:onClose,variant:Button.Wu.Secondary,children:i18n("icu:cancel")}),(0,jsx_runtime.jsx)(Button.zx,{onClick:function(){var ms=(0,parseIntOrThrow.Q)(muteExpirationValue,"NotificationSettings: mute ms was not an integer");setMuteExpiration(id,ms),onClose()},variant:Button.Wu.Primary,children:i18n("icu:mute")})]}),children:muteOptions.map((function(option,i){return(0,jsx_runtime.jsxs)("label",{className:"Preferences__settings-radio__label",htmlFor:htmlIds[i],children:[(0,jsx_runtime.jsx)(CircleCheckbox.p,{id:htmlIds[i],checked:muteExpirationValue===option.value,variant:CircleCheckbox.$.Small,disabled:option.disabled,isRadio:!0,moduleClassName:"ConversationDetails__radio",name:"mute",onChange:function(value){return value&&setMuteExpirationValue(option.value)}}),option.text]},htmlIds[i])}))})}ConversationNotificationsModal.displayName="ConversationNotificationsModal";var isConversationMuted=__webpack_require__("./ts/util/isConversationMuted.ts"),Avatar=__webpack_require__("./ts/components/Avatar.tsx");function ConversationDetailsGroups_slicedToArray(arr,i){return function ConversationDetailsGroups_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ConversationDetailsGroups_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ConversationDetailsGroups_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ConversationDetailsGroups_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ConversationDetailsGroups_arrayLikeToArray(o,minLen)}(arr,i)||function ConversationDetailsGroups_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ConversationDetailsGroups_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ConversationDetailsGroups(_ref){var contactId=_ref.contactId,i18n=_ref.i18n,groupsInCommon=_ref.groupsInCommon,toggleAddUserToAnotherGroupModal=_ref.toggleAddUserToAnotherGroupModal,showConversation=_ref.showConversation,_React$useState2=ConversationDetailsGroups_slicedToArray(react.useState(!1),2),showAllGroups=_React$useState2[0],setShowAllGroups=_React$useState2[1],isMoreThanMaxShown=groupsInCommon.length-5>1,groupsToShow=showAllGroups?groupsInCommon.length:5;return(0,jsx_runtime.jsxs)(PanelSection.c,{title:groupsInCommon.length>0?i18n("icu:ConversationDetailsGroups--title",{count:groupsInCommon.length}):i18n("icu:ConversationDetailsGroups--title--with-zero-groups-in-common"),children:[(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)("div",{className:"ConversationDetails-groups__add-to-group-icon"}),label:i18n("icu:ConversationDetailsGroups--add-to-group"),onClick:function(){return toggleAddUserToAnotherGroupModal(contactId)}}),groupsInCommon.slice(0,groupsToShow).map((function(group){return(0,jsx_runtime.jsx)(PanelRow.n,{onClick:function(){return showConversation({conversationId:group.id,switchToAssociatedView:!0})},icon:(0,jsx_runtime.jsx)(Avatar.qE,Object.assign({conversationType:"group",badge:void 0,i18n,size:Avatar.DZ.THIRTY_TWO},group)),label:group.title},group.id)})),!showAllGroups&&isMoreThanMaxShown&&(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetailsGroups--show-all"),icon:ConversationDetailsIcon.T.down}),onClick:function(){return setShowAllGroups(!0)},label:i18n("icu:ConversationDetailsGroups--show-all")})]})}ConversationDetailsGroups.displayName="ConversationDetailsGroups";var ModalState,Panels=__webpack_require__("./ts/types/Panels.ts");function ConversationDetails_slicedToArray(arr,i){return function ConversationDetails_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ConversationDetails_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ConversationDetails_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ConversationDetails_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ConversationDetails_arrayLikeToArray(o,minLen)}(arr,i)||function ConversationDetails_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ConversationDetails_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ConversationDetails(_ref){var acceptConversation=_ref.acceptConversation,addMembersToGroup=_ref.addMembersToGroup,areWeASubscriber=_ref.areWeASubscriber,badges=_ref.badges,blockConversation=_ref.blockConversation,canEditGroupInfo=_ref.canEditGroupInfo,canAddNewMembers=_ref.canAddNewMembers,conversation=_ref.conversation,deleteAvatarFromDisk=_ref.deleteAvatarFromDisk,hasGroupLink=_ref.hasGroupLink,getPreferredBadge=_ref.getPreferredBadge,getProfilesForConversation=_ref.getProfilesForConversation,groupsInCommon=_ref.groupsInCommon,hasActiveCall=_ref.hasActiveCall,i18n=_ref.i18n,isAdmin=_ref.isAdmin,isGroup=_ref.isGroup,leaveGroup=_ref.leaveGroup,loadRecentMediaItems=_ref.loadRecentMediaItems,memberships=_ref.memberships,maxGroupSize=_ref.maxGroupSize,maxRecommendedGroupSize=_ref.maxRecommendedGroupSize,onOutgoingAudioCallInConversation=_ref.onOutgoingAudioCallInConversation,onOutgoingVideoCallInConversation=_ref.onOutgoingVideoCallInConversation,pendingApprovalMemberships=_ref.pendingApprovalMemberships,pendingMemberships=_ref.pendingMemberships,pushPanelForConversation=_ref.pushPanelForConversation,renderChooseGroupMembersModal=_ref.renderChooseGroupMembersModal,renderConfirmAdditionsModal=_ref.renderConfirmAdditionsModal,replaceAvatar=_ref.replaceAvatar,saveAvatarToDisk=_ref.saveAvatarToDisk,searchInConversation=_ref.searchInConversation,setDisappearingMessages=_ref.setDisappearingMessages,setMuteExpiration=_ref.setMuteExpiration,showContactModal=_ref.showContactModal,showConversation=_ref.showConversation,showLightboxWithMedia=_ref.showLightboxWithMedia,theme=_ref.theme,toggleSafetyNumberModal=_ref.toggleSafetyNumberModal,toggleAddUserToAnotherGroupModal=_ref.toggleAddUserToAnotherGroupModal,updateGroupAttributes=_ref.updateGroupAttributes,userAvatarData=_ref.userAvatarData,_useState2=ConversationDetails_slicedToArray((0,react.useState)(ModalState.NothingOpen),2),modalState=_useState2[0],setModalState=_useState2[1],_useState4=ConversationDetails_slicedToArray((0,react.useState)(util.y.Inactive),2),editGroupAttributesRequestState=_useState4[0],setEditGroupAttributesRequestState=_useState4[1],_useState6=ConversationDetails_slicedToArray((0,react.useState)(util.y.Inactive),2),addGroupMembersRequestState=_useState6[0],setAddGroupMembersRequestState=_useState6[1];if(void 0===conversation)throw new Error("ConversationDetails rendered without a conversation");(0,react.useEffect)((function(){getProfilesForConversation(conversation.id)}),[conversation.id,getProfilesForConversation]);var modalNode,invitesCount=pendingMemberships.length+pendingApprovalMemberships.length,otherMemberships=memberships.filter((function(_ref2){return!_ref2.member.isMe})),isJustMe=0===otherMemberships.length,isAnyoneElseAnAdmin=otherMemberships.some((function(membership){return membership.isAdmin})),cannotLeaveBecauseYouAreLastAdmin=isAdmin&&!isJustMe&&!isAnyoneElseAnAdmin,onCloseModal=(0,react.useCallback)((function(){setModalState(ModalState.NothingOpen),setEditGroupAttributesRequestState(util.y.Inactive)}),[]);switch(modalState){case ModalState.NothingOpen:modalNode=void 0;break;case ModalState.EditingGroupDescription:case ModalState.EditingGroupTitle:modalNode=(0,jsx_runtime.jsx)(EditConversationAttributesModal.C,{avatarColor:conversation.color,avatarPath:conversation.avatarPath,conversationId:conversation.id,groupDescription:conversation.groupDescription,i18n,initiallyFocusDescription:modalState===ModalState.EditingGroupDescription,makeRequest:async function(options){setEditGroupAttributesRequestState(util.y.Active),updateGroupAttributes(conversation.id,options,{onSuccess:function(){setModalState(ModalState.NothingOpen),setEditGroupAttributesRequestState(util.y.Inactive)},onFailure:function(){setEditGroupAttributesRequestState(util.y.InactiveWithError)}})},onClose:onCloseModal,requestState:editGroupAttributesRequestState,title:conversation.title,deleteAvatarFromDisk,replaceAvatar,saveAvatarToDisk,userAvatarData});break;case ModalState.AddingGroupMembers:modalNode=(0,jsx_runtime.jsx)(AddGroupMembersModal.T,{renderChooseGroupMembersModal,renderConfirmAdditionsModal,clearRequestError:function(){setAddGroupMembersRequestState((function(oldRequestState){return(0,assert.q8)(oldRequestState!==util.y.Active,"Should not be clearing an active request state"),util.y.Inactive}))},conversationIdsAlreadyInGroup:new Set(memberships.map((function(membership){return membership.member.id}))),groupTitle:conversation.title,i18n,makeRequest:async function(conversationIds){setAddGroupMembersRequestState(util.y.Active),addMembersToGroup(conversation.id,conversationIds,{onSuccess:function(){setModalState(ModalState.NothingOpen),setAddGroupMembersRequestState(util.y.Inactive)},onFailure:function(){setAddGroupMembersRequestState(util.y.InactiveWithError)}})},maxGroupSize,maxRecommendedGroupSize,onClose:onCloseModal,requestState:addGroupMembersRequestState});break;case ModalState.MuteNotifications:modalNode=(0,jsx_runtime.jsx)(ConversationNotificationsModal,{i18n,id:conversation.id,muteExpiresAt:conversation.muteExpiresAt,onClose:onCloseModal,setMuteExpiration});break;case ModalState.UnmuteNotifications:modalNode=(0,jsx_runtime.jsx)(ConfirmationDialog.U,{dialogName:"ConversationDetails.unmuteNotifications",actions:[{action:function(){return setMuteExpiration(conversation.id,0)},style:"affirmative",text:i18n("icu:unmute")}],hasXButton:!0,i18n,title:i18n("icu:ConversationDetails__unmute--title"),onClose:onCloseModal,children:(0,getMutedUntilText.x)(Number(conversation.muteExpiresAt),i18n)});break;default:throw(0,missingCaseError.b)(modalState)}var isMuted=(0,isConversationMuted.c)(conversation);return(0,jsx_runtime.jsxs)("div",{className:"conversation-details-panel",children:[(0,jsx_runtime.jsx)(ConversationDetailsHeader.t,{areWeASubscriber,badges,canEdit:canEditGroupInfo,conversation,i18n,isMe:conversation.isMe,isGroup,memberships,startEditing:function(isGroupTitle){setModalState(isGroupTitle?ModalState.EditingGroupTitle:ModalState.EditingGroupDescription)},theme}),(0,jsx_runtime.jsxs)("div",{className:"ConversationDetails__header-buttons",children:[!conversation.isMe&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ConversationDetailsCallButton,{disabled:hasActiveCall,i18n,onClick:function(){return onOutgoingVideoCallInConversation(conversation.id)},type:"video"}),!isGroup&&(0,jsx_runtime.jsx)(ConversationDetailsCallButton,{disabled:hasActiveCall,i18n,onClick:function(){return onOutgoingAudioCallInConversation(conversation.id)},type:"audio"})]}),(0,jsx_runtime.jsx)(Button.zx,{icon:isMuted?Button.c.muted:Button.c.unmuted,onClick:function(){setModalState(isMuted?ModalState.UnmuteNotifications:ModalState.MuteNotifications)},variant:Button.Wu.Details,children:i18n(isMuted?"icu:unmute":"icu:mute")}),(0,jsx_runtime.jsx)(Button.zx,{icon:Button.c.search,onClick:function(){searchInConversation(conversation.id)},variant:Button.Wu.Details,children:i18n("icu:search")})]}),(0,jsx_runtime.jsxs)(PanelSection.c,{children:[!isGroup||canEditGroupInfo?(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetails--disappearing-messages-label"),icon:ConversationDetailsIcon.T.timer}),info:i18n(isGroup?"icu:ConversationDetails--disappearing-messages-info--group":"icu:ConversationDetails--disappearing-messages-info--direct"),label:i18n("icu:ConversationDetails--disappearing-messages-label"),right:(0,jsx_runtime.jsx)(DisappearingTimerSelect.R,{i18n,value:conversation.expireTimer||durations.kC.ZERO,onChange:function(value){return setDisappearingMessages(conversation.id,value)}})}):null,(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:showChatColorEditor"),icon:ConversationDetailsIcon.T.color}),label:i18n("icu:showChatColorEditor"),onClick:function(){pushPanelForConversation({type:Panels.w.ChatColorEditor})},right:(0,jsx_runtime.jsx)("div",{className:`ConversationDetails__chat-color ConversationDetails__chat-color--${conversation.conversationColor}`,style:Object.assign({},(0,getCustomColorStyle.X)(conversation.customColor))})}),isGroup&&(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetails--notifications"),icon:ConversationDetailsIcon.T.notifications}),label:i18n("icu:ConversationDetails--notifications"),onClick:function(){return pushPanelForConversation({type:Panels.w.NotificationSettings})},right:conversation.muteExpiresAt?(0,getMutedUntilText.x)(conversation.muteExpiresAt,i18n):void 0}),!isGroup&&!conversation.isMe&&(0,jsx_runtime.jsx)(PanelRow.n,{onClick:function(){return toggleSafetyNumberModal(conversation.id)},icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetails__viewSafetyNumber"),icon:ConversationDetailsIcon.T.verify}),label:(0,jsx_runtime.jsx)("div",{className:"ConversationDetails__safety-number",children:i18n("icu:ConversationDetails__viewSafetyNumber")})})]}),isGroup&&(0,jsx_runtime.jsx)(ConversationDetailsMembershipList.k,{canAddNewMembers,conversationId:conversation.id,getPreferredBadge,i18n,memberships,showContactModal,startAddingNewMembers:function(){setModalState(ModalState.AddingGroupMembers)},theme}),isGroup&&(0,jsx_runtime.jsxs)(PanelSection.c,{children:[isAdmin||hasGroupLink?(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetails--group-link"),icon:ConversationDetailsIcon.T.link}),label:i18n("icu:ConversationDetails--group-link"),onClick:function(){return pushPanelForConversation({type:Panels.w.GroupLinkManagement})},right:i18n(hasGroupLink?"icu:on":"icu:off")}):null,(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:ConversationDetails--requests-and-invites"),icon:ConversationDetailsIcon.T.invites}),label:i18n("icu:ConversationDetails--requests-and-invites"),onClick:function(){return pushPanelForConversation({type:Panels.w.GroupInvites})},right:invitesCount}),isAdmin?(0,jsx_runtime.jsx)(PanelRow.n,{icon:(0,jsx_runtime.jsx)(ConversationDetailsIcon.J,{ariaLabel:i18n("icu:permissions"),icon:ConversationDetailsIcon.T.lock}),label:i18n("icu:permissions"),onClick:function(){return pushPanelForConversation({type:Panels.w.GroupPermissions})}}):null]}),(0,jsx_runtime.jsx)(ConversationDetailsMediaList.G,{conversation,i18n,loadRecentMediaItems,showAllMedia:function(){return pushPanelForConversation({type:Panels.w.AllMedia})},showLightboxWithMedia}),!isGroup&&!conversation.isMe&&(0,jsx_runtime.jsx)(ConversationDetailsGroups,{contactId:conversation.id,i18n,groupsInCommon,toggleAddUserToAnotherGroupModal,showConversation}),!conversation.isMe&&(0,jsx_runtime.jsx)(ConversationDetailsActions.T,{acceptConversation,blockConversation,cannotLeaveBecauseYouAreLastAdmin,conversationId:conversation.id,conversationTitle:conversation.title,i18n,isBlocked:Boolean(conversation.isBlocked),isGroup,left:Boolean(conversation.left),onLeave:function(){return leaveGroup(conversation.id)}}),modalNode]})}function ConversationDetailsCallButton(_ref3){var disabled=_ref3.disabled,i18n=_ref3.i18n,onClick=_ref3.onClick,type=_ref3.type,button=(0,jsx_runtime.jsx)(Button.zx,{disabled,icon:Button.c[type],onClick,variant:Button.Wu.Details,children:i18n("audio"===type?"icu:audio":"icu:video")});return disabled?(0,jsx_runtime.jsx)(Tooltip.u,{content:i18n("icu:calling__in-another-call-tooltip"),children:button}):button}!function(ModalState){ModalState[ModalState.NothingOpen=0]="NothingOpen",ModalState[ModalState.EditingGroupDescription=1]="EditingGroupDescription",ModalState[ModalState.EditingGroupTitle=2]="EditingGroupTitle",ModalState[ModalState.AddingGroupMembers=3]="AddingGroupMembers",ModalState[ModalState.MuteNotifications=4]="MuteNotifications",ModalState[ModalState.UnmuteNotifications=5]="UnmuteNotifications"}(ModalState||(ModalState={})),ConversationDetails.displayName="ConversationDetails";var ChooseGroupMembersModal=__webpack_require__("./ts/components/conversation/conversation-details/AddGroupMembersModal/ChooseGroupMembersModal.tsx"),ConfirmAdditionsModal=__webpack_require__("./ts/components/conversation/conversation-details/AddGroupMembersModal/ConfirmAdditionsModal.tsx"),getDefaultConversation=__webpack_require__("./ts/test-both/helpers/getDefaultConversation.ts"),fakeLookupConversationWithoutUuid=__webpack_require__("./ts/test-both/helpers/fakeLookupConversationWithoutUuid.ts"),Util=__webpack_require__("./ts/types/Util.ts"),i18n=(0,setupI18n.E5)("en",messages);const ConversationDetails_stories={title:"Components/Conversation/ConversationDetails/ConversationDetails"};var conversation=(0,getDefaultConversation.E$)({id:"",lastUpdated:0,title:"Some Conversation",groupDescription:"Hello World!",type:"group",sharedGroupNames:[],conversationColor:"ultramarine"}),allCandidateContacts=times_default()(10,(function(){return(0,getDefaultConversation.E$)()})),createProps=function(){var hasGroupLink=arguments.length>0&&void 0!==arguments[0]&&arguments[0],expireTimer=arguments.length>1?arguments[1]:void 0;return{acceptConversation:(0,esm.action)("acceptConversation"),addMembersToGroup:async function(){(0,esm.action)("addMembersToGroup")},areWeASubscriber:!1,blockConversation:(0,esm.action)("blockConversation"),canEditGroupInfo:!1,canAddNewMembers:!1,conversation:expireTimer?Object.assign({},conversation,{expireTimer}):conversation,hasActiveCall:!1,hasGroupLink,getPreferredBadge:function(){},getProfilesForConversation:(0,esm.action)("getProfilesForConversation"),groupsInCommon:[],i18n,isAdmin:!1,isGroup:!0,leaveGroup:(0,esm.action)("leaveGroup"),loadRecentMediaItems:(0,esm.action)("loadRecentMediaItems"),memberships:times_default()(32,(function(i){return{isAdmin:1===i,member:(0,getDefaultConversation.E$)({isMe:2===i})}})),maxGroupSize:1001,maxRecommendedGroupSize:151,pendingApprovalMemberships:times_default()(8,(function(){return{member:(0,getDefaultConversation.E$)()}})),pendingMemberships:times_default()(5,(function(){return{metadata:{},member:(0,getDefaultConversation.E$)()}})),setDisappearingMessages:(0,esm.action)("setDisappearingMessages"),showContactModal:(0,esm.action)("showContactModal"),pushPanelForConversation:(0,esm.action)("pushPanelForConversation"),showConversation:(0,esm.action)("showConversation"),showLightboxWithMedia:(0,esm.action)("showLightboxWithMedia"),updateGroupAttributes:async function(){(0,esm.action)("updateGroupAttributes")()},deleteAvatarFromDisk:(0,esm.action)("deleteAvatarFromDisk"),replaceAvatar:(0,esm.action)("replaceAvatar"),saveAvatarToDisk:(0,esm.action)("saveAvatarToDisk"),setMuteExpiration:(0,esm.action)("setMuteExpiration"),userAvatarData:[],toggleSafetyNumberModal:(0,esm.action)("toggleSafetyNumberModal"),toggleAddUserToAnotherGroupModal:(0,esm.action)("toggleAddUserToAnotherGroup"),onOutgoingAudioCallInConversation:(0,esm.action)("onOutgoingAudioCallInConversation"),onOutgoingVideoCallInConversation:(0,esm.action)("onOutgoingVideoCallInConversation"),searchInConversation:(0,esm.action)("searchInConversation"),theme:Util.f8.light,renderChooseGroupMembersModal:function(props){return(0,jsx_runtime.jsx)(ChooseGroupMembersModal.d,Object.assign({},props,{candidateContacts:allCandidateContacts,selectedContacts:[],regionCode:"US",getPreferredBadge:function(){},theme:Util.f8.light,i18n,lookupConversationWithoutUuid:(0,fakeLookupConversationWithoutUuid.y)(),showUserNotFoundModal:(0,esm.action)("showUserNotFoundModal"),isUsernamesEnabled:!0}))},renderConfirmAdditionsModal:function(props){return(0,jsx_runtime.jsx)(ConfirmAdditionsModal.x,Object.assign({},props,{selectedContacts:[],i18n}))}}};function Basic(){var props=createProps();return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props))}function AsAdmin(){var props=createProps();return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{isAdmin:!0}))}function AsLastAdmin(){var props=createProps();return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{isAdmin:!0,memberships:times_default()(32,(function(i){return{isAdmin:2===i,member:(0,getDefaultConversation.E$)({isMe:2===i})}}))}))}function AsOnlyAdmin(){var props=createProps();return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{isAdmin:!0,memberships:[{isAdmin:!0,member:(0,getDefaultConversation.E$)({isMe:!0})}]}))}function GroupEditable(){var props=createProps();return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{canEditGroupInfo:!0}))}function GroupEditableWithCustomDisappearingTimeout(){var props=createProps(!1,durations.kC.fromDays(3));return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{canEditGroupInfo:!0}))}function GroupLinksOn(){var props=createProps(!0);return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},props,{isAdmin:!0}))}Basic.displayName="Basic",AsAdmin.displayName="AsAdmin",AsAdmin.story={name:"as Admin"},AsLastAdmin.displayName="AsLastAdmin",AsLastAdmin.story={name:"as last admin"},AsOnlyAdmin.displayName="AsOnlyAdmin",AsOnlyAdmin.story={name:"as only admin"},GroupEditable.displayName="GroupEditable",GroupEditableWithCustomDisappearingTimeout.displayName="GroupEditableWithCustomDisappearingTimeout",GroupEditableWithCustomDisappearingTimeout.story={name:"Group Editable with custom disappearing timeout"},GroupLinksOn.displayName="GroupLinksOn";var _11=function(){return(0,jsx_runtime.jsx)(ConversationDetails,Object.assign({},createProps(),{isGroup:!1}))};_11.displayName="_11",_11.story={name:"1:1"};var __namedExportsOrder=["Basic","AsAdmin","AsLastAdmin","AsOnlyAdmin","GroupEditable","GroupEditableWithCustomDisappearingTimeout","GroupLinksOn","_11"]},"./ts/components/conversation/conversation-details/ConversationDetailsActions.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>ConversationDetailsActions});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),_Tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Tooltip.tsx"),_PanelRow__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/conversation/conversation-details/PanelRow.tsx"),_PanelSection__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/conversation/conversation-details/PanelSection.tsx"),_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsIcon.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ConversationDetailsActions(_ref){var leaveGroupNode,blockNode,acceptConversation=_ref.acceptConversation,blockConversation=_ref.blockConversation,cannotLeaveBecauseYouAreLastAdmin=_ref.cannotLeaveBecauseYouAreLastAdmin,conversationId=_ref.conversationId,conversationTitle=_ref.conversationTitle,i18n=_ref.i18n,isBlocked=_ref.isBlocked,isGroup=_ref.isGroup,left=_ref.left,onLeave=_ref.onLeave,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),confirmLeave=_useState2[0],gLeave=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),confirmGroupBlock=_useState4[0],gGroupBlock=_useState4[1],_useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),confirmGroupUnblock=_useState6[0],gGroupUnblock=_useState6[1],_useState8=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),confirmDirectBlock=_useState8[0],gDirectBlock=_useState8[1],_useState10=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),confirmDirectUnblock=_useState10[0],gDirectUnblock=_useState10[1];if(isGroup&&!left&&(leaveGroupNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{disabled:cannotLeaveBecauseYouAreLastAdmin,onClick:function(){return gLeave(!0)},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.J,{ariaLabel:i18n("icu:ConversationDetailsActions--leave-group"),disabled:cannotLeaveBecauseYouAreLastAdmin,icon:_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.T.leave}),label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("ConversationDetails__leave-group",cannotLeaveBecauseYouAreLastAdmin&&"ConversationDetails__leave-group--disabled"),children:i18n("icu:ConversationDetailsActions--leave-group")})}),cannotLeaveBecauseYouAreLastAdmin&&(leaveGroupNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Tooltip__WEBPACK_IMPORTED_MODULE_3__.u,{content:i18n("icu:ConversationDetailsActions--leave-group-must-choose-new-admin"),direction:_Tooltip__WEBPACK_IMPORTED_MODULE_3__.TQ.Top,children:leaveGroupNode}))),isGroup&&!isBlocked)blockNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{disabled:cannotLeaveBecauseYouAreLastAdmin,onClick:function(){return gGroupBlock(!0)},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.J,{ariaLabel:i18n("icu:ConversationDetailsActions--block-group"),icon:_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.T.block}),label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"ConversationDetails__block-group",children:i18n("icu:ConversationDetailsActions--block-group")})});else if(isGroup&&isBlocked)blockNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{onClick:function(){return gGroupUnblock(!0)},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.J,{ariaLabel:i18n("icu:ConversationDetailsActions--unblock-group"),icon:_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.T.unblock}),label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:"ConversationDetails__unblock-group",children:i18n("icu:ConversationDetailsActions--unblock-group")})});else{var label=i18n(isBlocked?"icu:MessageRequests--unblock":"icu:MessageRequests--block");blockNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{onClick:function(){return isBlocked?gDirectUnblock(!0):gDirectBlock(!0)},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.J,{ariaLabel:label,icon:isBlocked?_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.T.unblock:_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_6__.T.block}),label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)("div",{className:isBlocked?"ConversationDetails__unblock-group":"ConversationDetails__block-group",children:label})})}return cannotLeaveBecauseYouAreLastAdmin&&(blockNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Tooltip__WEBPACK_IMPORTED_MODULE_3__.u,{content:i18n("icu:ConversationDetailsActions--leave-group-must-choose-new-admin"),direction:_Tooltip__WEBPACK_IMPORTED_MODULE_3__.TQ.Top,children:blockNode})),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(_PanelSection__WEBPACK_IMPORTED_MODULE_5__.c,{children:[leaveGroupNode,blockNode]}),confirmLeave&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"ConversationDetailsAction.confirmLeave",actions:[{text:i18n("icu:ConversationDetailsActions--leave-group-modal-confirm"),action:onLeave,style:"affirmative"}],i18n,onClose:function(){return gLeave(!1)},title:i18n("icu:ConversationDetailsActions--leave-group-modal-title"),children:i18n("icu:ConversationDetailsActions--leave-group-modal-content")}),confirmGroupBlock&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"ConversationDetailsAction.confirmBlock",actions:[{text:i18n("icu:ConversationDetailsActions--block-group-modal-confirm"),action:function(){return blockConversation(conversationId)},style:"affirmative"}],i18n,onClose:function(){return gGroupBlock(!1)},title:i18n("icu:ConversationDetailsActions--block-group-modal-title",{groupName:conversationTitle}),children:i18n("icu:ConversationDetailsActions--block-group-modal-content")}),confirmGroupUnblock&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"ConversationDetailsAction.confirmUnblock",actions:[{text:i18n("icu:ConversationDetailsActions--unblock-group-modal-confirm"),action:function(){return acceptConversation(conversationId)},style:"affirmative"}],i18n,onClose:function(){return gGroupUnblock(!1)},title:i18n("icu:ConversationDetailsActions--unblock-group-modal-title",{groupName:conversationTitle}),children:i18n("icu:ConversationDetailsActions--unblock-group-modal-content")}),confirmDirectBlock&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"ConversationDetailsAction.confirmDirectBlock",actions:[{text:i18n("icu:MessageRequests--block"),action:function(){return blockConversation(conversationId)},style:"affirmative"}],i18n,onClose:function(){return gDirectBlock(!1)},title:i18n("icu:MessageRequests--block-direct-confirm-title",{title:conversationTitle}),children:i18n("icu:MessageRequests--block-direct-confirm-body")}),confirmDirectUnblock&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"ConversationDetailsAction.confirmDirectUnblock",actions:[{text:i18n("icu:MessageRequests--unblock"),action:function(){return acceptConversation(conversationId)},style:"affirmative"}],i18n,onClose:function(){return gDirectUnblock(!1)},title:i18n("icu:MessageRequests--unblock-direct-confirm-title",{name:conversationTitle}),children:i18n("icu:MessageRequests--unblock-direct-confirm-body")})]})}},"./ts/components/conversation/conversation-details/ConversationDetailsHeader.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{t:()=>ConversationDetailsHeader});var ConversationDetailsHeaderActiveModal,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Avatar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Avatar.tsx"),_AvatarLightbox__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/AvatarLightbox.tsx"),_GroupDescription__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/GroupDescription.tsx"),_About__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/conversation/About.tsx"),_util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),_BadgeDialog__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/BadgeDialog.tsx"),_UserText__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/components/UserText.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(ConversationDetailsHeaderActiveModal){ConversationDetailsHeaderActiveModal[ConversationDetailsHeaderActiveModal.ShowingAvatar=0]="ShowingAvatar",ConversationDetailsHeaderActiveModal[ConversationDetailsHeaderActiveModal.ShowingBadges=1]="ShowingBadges"}(ConversationDetailsHeaderActiveModal||(ConversationDetailsHeaderActiveModal={}));var bem=(0,_util__WEBPACK_IMPORTED_MODULE_5__.q)("ConversationDetails-header");function ConversationDetailsHeader(_ref){var preferredBadge,subtitle,areWeASubscriber=_ref.areWeASubscriber,badges=_ref.badges,canEdit=_ref.canEdit,conversation=_ref.conversation,i18n=_ref.i18n,isGroup=_ref.isGroup,isMe=_ref.isMe,memberships=_ref.memberships,startEditing=_ref.startEditing,theme=_ref.theme,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(),2),activeModal=_useState2[0],setActiveModal=_useState2[1],hasNestedButton=!1;isGroup?conversation.groupDescription?(subtitle=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_GroupDescription__WEBPACK_IMPORTED_MODULE_3__.m,{i18n,text:conversation.groupDescription,title:conversation.title}),hasNestedButton=!0):subtitle=canEdit?i18n("icu:ConversationDetailsHeader--add-group-description"):i18n("icu:ConversationDetailsHeader--members",{number:memberships.length}):isMe||(subtitle=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:bem("subtitle__about"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_About__WEBPACK_IMPORTED_MODULE_4__.C,{text:conversation.about})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:bem("subtitle__phone-number"),children:conversation.phoneNumber})]}),preferredBadge=null==badges?void 0:badges[0]);var modal,avatar=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_Avatar__WEBPACK_IMPORTED_MODULE_1__.qE,Object.assign({badge:preferredBadge,conversationType:conversation.type,i18n,size:_Avatar__WEBPACK_IMPORTED_MODULE_1__.DZ.EIGHTY},conversation,{noteToSelf:isMe,onClick:function(){setActiveModal(ConversationDetailsHeaderActiveModal.ShowingAvatar)},onClickBadge:function(){setActiveModal(ConversationDetailsHeaderActiveModal.ShowingBadges)},sharedGroupNames:[],theme})),contents=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:bem("title"),children:[isMe?i18n("icu:noteToSelf"):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_UserText__WEBPACK_IMPORTED_MODULE_7__.a,{text:conversation.title}),isMe&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("span",{className:"ContactModal__official-badge__large"})]})});switch(activeModal){case ConversationDetailsHeaderActiveModal.ShowingAvatar:modal=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_AvatarLightbox__WEBPACK_IMPORTED_MODULE_2__.S,{avatarColor:conversation.color,avatarPath:conversation.avatarPath,conversationTitle:conversation.title,i18n,isGroup,onClose:function(){setActiveModal(void 0)}});break;case ConversationDetailsHeaderActiveModal.ShowingBadges:modal=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_BadgeDialog__WEBPACK_IMPORTED_MODULE_6__.v,{areWeASubscriber,badges:badges||[],firstName:conversation.firstName,i18n,onClose:function(){setActiveModal(void 0)},title:conversation.title});break;default:modal=null}return canEdit?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:bem("root"),"data-testid":"ConversationDetailsHeader",children:[modal,avatar,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("button",{type:"button",onClick:function(ev){ev.preventDefault(),ev.stopPropagation(),startEditing(!0)},className:bem("root","editable"),children:contents}),hasNestedButton?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:bem("subtitle"),children:subtitle}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("button",{type:"button",onClick:function(ev){ev.target instanceof HTMLAnchorElement||(ev.preventDefault(),ev.stopPropagation(),startEditing(!1))},className:bem("root","editable"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:bem("subtitle"),children:subtitle})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:bem("root"),"data-testid":"ConversationDetailsHeader",children:[modal,avatar,contents,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:bem("subtitle"),children:subtitle})]})}ConversationDetailsHeader.displayName="ConversationDetailsHeader"},"./ts/components/conversation/conversation-details/ConversationDetailsIcon.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J:()=>ConversationDetailsIcon,T:()=>IconType});__webpack_require__("./node_modules/react/index.js");var IconType,classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_Spinner__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/Spinner.tsx"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");!function(IconType){IconType.block="block",IconType.unblock="unblock",IconType.color="color",IconType.down="down",IconType.invites="invites",IconType.leave="leave",IconType.link="link",IconType.lock="lock",IconType.mention="mention",IconType.mute="mute",IconType.notifications="notifications",IconType.reset="reset",IconType.share="share",IconType.spinner="spinner",IconType.timer="timer",IconType.trash="trash",IconType.verify="verify"}(IconType||(IconType={}));var bem=(0,_util__WEBPACK_IMPORTED_MODULE_3__.q)("ConversationDetails-icon");function ConversationDetailsIcon(_ref){var content,ariaLabel=_ref.ariaLabel,disabled=_ref.disabled,icon=_ref.icon,fakeButton=_ref.fakeButton,onClick=_ref.onClick;if(icon===IconType.spinner)content=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_2__.$j,{svgSize:"small",size:"24"});else{var iconClassName=bem("icon",icon);content=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(iconClassName,disabled&&`${iconClassName}--disabled`)})}return onClick&&fakeButton&&!disabled?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{"aria-label":ariaLabel,role:"button",className:bem("button"),tabIndex:0,onClick:function(event){event.preventDefault(),event.stopPropagation(),onClick()},onKeyDown:function(event){"Enter"!==event.key&&" "!==event.key||(event.preventDefault(),event.stopPropagation(),onClick())},children:content}):onClick?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{"aria-label":ariaLabel,className:bem("button"),disabled,type:"button",onClick:function(event){event.preventDefault(),event.stopPropagation(),onClick()},children:content}):content}},"./ts/components/conversation/conversation-details/ConversationDetailsMediaList.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>ConversationDetailsMediaList});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_PanelSection__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/conversation-details/PanelSection.tsx"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),_media_gallery_MediaGridItem__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/media-gallery/MediaGridItem.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js"),bem=(0,_util__WEBPACK_IMPORTED_MODULE_2__.q)("ConversationDetails-media-list");function ConversationDetailsMediaList(_ref){var conversation=_ref.conversation,i18n=_ref.i18n,loadRecentMediaItems=_ref.loadRecentMediaItems,showAllMedia=_ref.showAllMedia,showLightboxWithMedia=_ref.showLightboxWithMedia,mediaItems=conversation.recentMediaItems||[],mediaItemsLength=mediaItems.length;return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){loadRecentMediaItems(conversation.id,6)}),[conversation.id,loadRecentMediaItems,mediaItemsLength]),0===mediaItemsLength?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_PanelSection__WEBPACK_IMPORTED_MODULE_1__.c,{actions:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{className:bem("show-all"),onClick:showAllMedia,type:"button",children:i18n("icu:ConversationDetailsMediaList--show-all")}),title:i18n("icu:ConversationDetailsMediaList--shared-media"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:bem("root"),children:mediaItems.slice(0,6).map((function(mediaItem){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_media_gallery_MediaGridItem__WEBPACK_IMPORTED_MODULE_3__.w,{mediaItem,i18n,onClick:function(){return showLightboxWithMedia(mediaItem.attachment.path,mediaItems)}},`${mediaItem.message.id}-${mediaItem.index}`)}))})})}ConversationDetailsMediaList.displayName="ConversationDetailsMediaList"},"./ts/components/conversation/conversation-details/ConversationDetailsMembershipList.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>ConversationDetailsMembershipList});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Avatar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Avatar.tsx"),_Emojify__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/Emojify.tsx"),_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/conversation-details/ConversationDetailsIcon.tsx"),_PanelRow__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/conversation/conversation-details/PanelRow.tsx"),_PanelSection__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/conversation/conversation-details/PanelSection.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var collator=new Intl.Collator(void 0,{sensitivity:"base"});function sortConversationTitles(left,right){var leftTitle=left.member.title,rightTitle=right.member.title;return collator.compare(leftTitle,rightTitle)}function ConversationDetailsMembershipList(_ref){var canAddNewMembers=_ref.canAddNewMembers,conversationId=_ref.conversationId,getPreferredBadge=_ref.getPreferredBadge,i18n=_ref.i18n,_ref$maxShownMemberCo=_ref.maxShownMemberCount,maxShownMemberCount=void 0===_ref$maxShownMemberCo?5:_ref$maxShownMemberCo,memberships=_ref.memberships,showContactModal=_ref.showContactModal,startAddingNewMembers=_ref.startAddingNewMembers,theme=_ref.theme,_React$useState2=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),showAllMembers=_React$useState2[0],setShowAllMembers=_React$useState2[1],sortedMemberships=function sortMemberships(memberships){var you,admins=[],nonAdmins=[];memberships.forEach((function(membershipInfo){var isAdmin=membershipInfo.isAdmin;membershipInfo.member.isMe?you=membershipInfo:isAdmin?admins.push(membershipInfo):nonAdmins.push(membershipInfo)})),admins.sort(sortConversationTitles),nonAdmins.sort(sortConversationTitles);var sortedMemberships=[];return you&&sortedMemberships.push(you),sortedMemberships.push.apply(sortedMemberships,admins),sortedMemberships.push.apply(sortedMemberships,nonAdmins),sortedMemberships}(memberships),shouldHideRestMembers=sortedMemberships.length-maxShownMemberCount>1,membersToShow=shouldHideRestMembers&&!showAllMembers?maxShownMemberCount:sortedMemberships.length;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(_PanelSection__WEBPACK_IMPORTED_MODULE_5__.c,{title:i18n("icu:ConversationDetailsMembershipList--title",{number:sortedMemberships.length}),children:[canAddNewMembers&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"ConversationDetails-membership-list__add-members-icon"}),label:i18n("icu:ConversationDetailsMembershipList--add-members"),onClick:function(){return null==startAddingNewMembers?void 0:startAddingNewMembers()}}),sortedMemberships.slice(0,membersToShow).map((function(_ref2){var isAdmin=_ref2.isAdmin,member=_ref2.member;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{onClick:function(){return showContactModal(member.id,conversationId)},icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Avatar__WEBPACK_IMPORTED_MODULE_1__.qE,Object.assign({conversationType:"direct",badge:getPreferredBadge(member.badges),i18n,size:_Avatar__WEBPACK_IMPORTED_MODULE_1__.DZ.THIRTY_TWO,theme},member)),label:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_Emojify__WEBPACK_IMPORTED_MODULE_2__.u,{text:member.isMe?i18n("icu:you"):member.title}),right:isAdmin?i18n("icu:GroupV2--admin"):""},member.id)})),!1===showAllMembers&&shouldHideRestMembers&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_PanelRow__WEBPACK_IMPORTED_MODULE_4__.n,{className:"ConversationDetails-membership-list--show-all",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_3__.J,{ariaLabel:i18n("icu:ConversationDetailsMembershipList--show-all"),icon:_ConversationDetailsIcon__WEBPACK_IMPORTED_MODULE_3__.T.down}),onClick:function(){return setShowAllMembers(!0)},label:i18n("icu:ConversationDetailsMembershipList--show-all")})]})}ConversationDetailsMembershipList.displayName="ConversationDetailsMembershipList"},"./ts/components/conversation/conversation-details/EditConversationAttributesModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>EditConversationAttributesModal});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Modal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Modal.tsx"),_AvatarEditor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/AvatarEditor.tsx"),_AvatarPreview__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/AvatarPreview.tsx"),_Button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/Button.tsx"),_Spinner__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/Spinner.tsx"),_GroupDescriptionInput__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/GroupDescriptionInput.tsx"),_GroupTitleInput__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/components/GroupTitleInput.tsx"),_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function EditConversationAttributesModal(_ref){var content,avatarColor=_ref.avatarColor,externalAvatarPath=_ref.avatarPath,conversationId=_ref.conversationId,_ref$groupDescription=_ref.groupDescription,externalGroupDescription=void 0===_ref$groupDescription?"":_ref$groupDescription,i18n=_ref.i18n,initiallyFocusDescription=_ref.initiallyFocusDescription,makeRequest=_ref.makeRequest,onClose=_ref.onClose,requestState=_ref.requestState,externalTitle=_ref.title,deleteAvatarFromDisk=_ref.deleteAvatarFromDisk,replaceAvatar=_ref.replaceAvatar,saveAvatarToDisk=_ref.saveAvatarToDisk,userAvatarData=_ref.userAvatarData,focusDescriptionRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(initiallyFocusDescription),focusDescription=focusDescriptionRef.current,startingTitleRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(externalTitle),startingAvatarPathRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(externalAvatarPath),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),editingAvatar=_useState2[0],setEditingAvatar=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(),2),avatar=_useState4[0],setAvatar=_useState4[1],_useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(externalTitle),2),rawTitle=_useState6[0],setRawTitle=_useState6[1],_useState8=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(externalGroupDescription),2),rawGroupDescription=_useState8[0],setRawGroupDescription=_useState8[1],_useState10=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),hasAvatarChanged=_useState10[0],setHasAvatarChanged=_useState10[1],trimmedTitle=rawTitle.trim(),trimmedDescription=rawGroupDescription.trim(),focusRef=function(el){el&&(el.focus(),focusDescriptionRef.current=void 0)},hasChangedExternally=startingAvatarPathRef.current!==externalAvatarPath||startingTitleRef.current!==externalTitle,hasTitleChanged=trimmedTitle!==externalTitle.trim(),hasGroupDescriptionChanged=externalGroupDescription.trim()!==trimmedDescription,isRequestActive=requestState===_util__WEBPACK_IMPORTED_MODULE_8__.y.Active,canSubmit=!isRequestActive&&(hasChangedExternally||hasTitleChanged||hasAvatarChanged||hasGroupDescriptionChanged)&&trimmedTitle.length>0,avatarPathForPreview=hasAvatarChanged?void 0:externalAvatarPath;content=editingAvatar?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_AvatarEditor__WEBPACK_IMPORTED_MODULE_2__.u,{avatarColor,avatarPath:avatarPathForPreview,avatarValue:avatar,conversationId,deleteAvatarFromDisk,i18n,isGroup:!0,onCancel:function(){setHasAvatarChanged(!1),setEditingAvatar(!1)},onSave:function(newAvatar){setAvatar(newAvatar),setHasAvatarChanged(!0),setEditingAvatar(!1)},userAvatarData,replaceAvatar,saveAvatarToDisk}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("form",{id:"edit-conversation-form",onSubmit:function(event){event.preventDefault();var request={};hasAvatarChanged&&(request.avatar=avatar),hasTitleChanged&&(request.title=trimmedTitle),hasGroupDescriptionChanged&&(request.description=trimmedDescription),makeRequest(request)},className:"module-EditConversationAttributesModal",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_AvatarPreview__WEBPACK_IMPORTED_MODULE_3__.B,{avatarColor,avatarPath:avatarPathForPreview,avatarValue:avatar,i18n,isEditable:!0,isGroup:!0,onClick:function(){setEditingAvatar(!0)},style:{height:96,width:96}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_GroupTitleInput__WEBPACK_IMPORTED_MODULE_7__.m,{disabled:isRequestActive,i18n,onChangeValue:setRawTitle,ref:!1===focusDescription?focusRef:void 0,value:rawTitle}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_GroupDescriptionInput__WEBPACK_IMPORTED_MODULE_6__.O,{disabled:isRequestActive,i18n,onChangeValue:setRawGroupDescription,ref:!0===focusDescription?focusRef:void 0,value:rawGroupDescription}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-EditConversationAttributesModal__description-warning",children:i18n("icu:EditConversationAttributesModal__description-warning")}),requestState===_util__WEBPACK_IMPORTED_MODULE_8__.y.InactiveWithError&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-EditConversationAttributesModal__error-message",children:i18n("icu:updateGroupAttributes__error-message")})]});var modalFooter=editingAvatar?void 0:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_4__.zx,{disabled:isRequestActive,onClick:onClose,variant:_Button__WEBPACK_IMPORTED_MODULE_4__.Wu.Secondary,children:i18n("icu:cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_4__.zx,{type:"submit",form:"edit-conversation-form",variant:_Button__WEBPACK_IMPORTED_MODULE_4__.Wu.Primary,disabled:!canSubmit,children:isRequestActive?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_5__.$j,{size:"20px",svgSize:"small",direction:"on-avatar"}):i18n("icu:save")})]});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Modal__WEBPACK_IMPORTED_MODULE_1__.u_,{modalName:"EditConversationAttributesModal",hasXButton:!0,i18n,onClose,title:i18n("icu:updateGroupAttributes__title"),modalFooter,children:content})}EditConversationAttributesModal.displayName="EditConversationAttributesModal"},"./ts/components/conversation/conversation-details/PanelRow.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>PanelRow});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),bem=(0,_util__WEBPACK_IMPORTED_MODULE_2__.q)("ConversationDetails-panel-row"),PanelRow=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function PanelRowInner(_ref,ref){var alwaysShowActions=_ref.alwaysShowActions,className=_ref.className,disabled=_ref.disabled,icon=_ref.icon,label=_ref.label,info=_ref.info,right=_ref.right,actions=_ref.actions,onClick=_ref.onClick,content=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[void 0!==icon?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:bem("icon"),children:icon}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:bem("label"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{children:label}),void 0!==info?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:bem("info"),children:info}):null]}),void 0!==right?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:bem("right"),children:right}):null,void 0!==actions?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:alwaysShowActions?"":bem("actions"),children:actions}):null]});return onClick?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("button",{disabled,type:"button",className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(bem("root","button"),className),onClick,ref,children:content}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(bem("root"),className),children:content})}))},"./ts/components/conversation/conversation-details/PanelSection.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>PanelSection});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),bem=(0,_util__WEBPACK_IMPORTED_MODULE_2__.q)("ConversationDetails-panel-section"),borderlessClass=bem("root","borderless");function PanelSection(_ref){var actions=_ref.actions,borderless=_ref.borderless,centerTitle=_ref.centerTitle,children=_ref.children,title=_ref.title;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(bem("root"),borderless?borderlessClass:null),children:[(title||actions)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:bem("header",{center:centerTitle||!1}),children:[title&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:bem("title"),children:title}),actions&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{children:actions})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{children})]})}PanelSection.displayName="PanelSection"},"./ts/components/conversation/media-gallery/MediaGridItem.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>MediaGridItem});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_GoogleChrome__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/GoogleChrome.ts"),_logging_log__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/logging/log.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MediaGridItemContent(props){var mediaItem=props.mediaItem,i18n=props.i18n,attachment=mediaItem.attachment,contentType=mediaItem.contentType,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),imageBroken=_useState2[0],setImageBroken=_useState2[1],handleImageError=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){_logging_log__WEBPACK_IMPORTED_MODULE_3__.info("MediaGridItem: Image failed to load; failing over to placeholder"),setImageBroken(!0)}),[]);return attachment?contentType&&(0,_util_GoogleChrome__WEBPACK_IMPORTED_MODULE_2__.T)(contentType)?imageBroken||!mediaItem.thumbnailObjectUrl?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-media-grid-item__icon","module-media-grid-item__icon-image")}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("img",{alt:i18n("icu:lightboxImageAlt"),className:"module-media-grid-item__image",src:mediaItem.thumbnailObjectUrl,onError:handleImageError}):contentType&&(0,_util_GoogleChrome__WEBPACK_IMPORTED_MODULE_2__.eq)(contentType)?imageBroken||!mediaItem.thumbnailObjectUrl?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-media-grid-item__icon","module-media-grid-item__icon-video")}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:"module-media-grid-item__image-container",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("img",{alt:i18n("icu:lightboxImageAlt"),className:"module-media-grid-item__image",src:mediaItem.thumbnailObjectUrl,onError:handleImageError}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"module-media-grid-item__circle-overlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"module-media-grid-item__play-overlay"})})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-media-grid-item__icon","module-media-grid-item__icon-generic")}):null}function MediaGridItem(props){var onClick=props.onClick;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{type:"button",className:"module-media-grid-item",onClick,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(MediaGridItemContent,Object.assign({},props))})}MediaGridItemContent.displayName="MediaGridItemContent",MediaGridItem.displayName="MediaGridItem"},"./ts/services/InteractionMode.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>getInteractionMode});var interactionMode="mouse";function getInteractionMode(){return interactionMode}},"./ts/types/Panels.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var PanelType;__webpack_require__.d(__webpack_exports__,{w:()=>PanelType}),function(PanelType){PanelType.AllMedia="AllMedia",PanelType.ChatColorEditor="ChatColorEditor",PanelType.ContactDetails="ContactDetails",PanelType.ConversationDetails="ConversationDetails",PanelType.GroupInvites="GroupInvites",PanelType.GroupLinkManagement="GroupLinkManagement",PanelType.GroupPermissions="GroupPermissions",PanelType.GroupV1Members="GroupV1Members",PanelType.MessageDetails="MessageDetails",PanelType.NotificationSettings="NotificationSettings",PanelType.StickerManager="StickerManager"}(PanelType||(PanelType={}))},"./ts/util/expirationTimer.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{UD:()=>DEFAULT_DURATIONS_IN_SECONDS,WU:()=>format,h5:()=>DEFAULT_DURATIONS_SET});__webpack_require__("./node_modules/lodash/isNumber.js");var humanize_duration__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/humanize-duration/humanize-duration.js"),humanize_duration__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(humanize_duration__WEBPACK_IMPORTED_MODULE_1__),_durations__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/durations/index.ts"),DEFAULT_DURATIONS_IN_SECONDS=[_durations__WEBPACK_IMPORTED_MODULE_2__.kC.ZERO,_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromWeeks(4),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromWeeks(1),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromDays(1),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromHours(8),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromHours(1),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromMinutes(5),_durations__WEBPACK_IMPORTED_MODULE_2__.kC.fromSeconds(30)],DEFAULT_DURATIONS_SET=new Set(DEFAULT_DURATIONS_IN_SECONDS);function format(i18n,dirtySeconds){var _ref=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_ref$capitalizeOff=_ref.capitalizeOff,capitalizeOff=void 0!==_ref$capitalizeOff&&_ref$capitalizeOff,largest=_ref.largest,seconds=Math.abs(dirtySeconds||0);if(!seconds)return i18n(capitalizeOff?"icu:off":"icu:disappearingMessages__off");seconds=Math.max(Math.floor(seconds),1);var locale=i18n.getLocale().replace(/-/g,"_"),localeWithoutRegion=locale.split("_",1)[0],fallbacks=[];localeWithoutRegion!==locale&&fallbacks.push(localeWithoutRegion),"nb"!==localeWithoutRegion&&"nn"!==localeWithoutRegion||fallbacks.push("no"),"en"!==localeWithoutRegion&&fallbacks.push("en"),"zh_HK"===locale&&fallbacks.push("zh_TW");var allUnits=["y","mo","w","d","h","m","s"],defaultUnits=seconds%604800==0?["w"]:["d","h","m","s"];return humanize_duration__WEBPACK_IMPORTED_MODULE_1___default()(seconds*_durations__WEBPACK_IMPORTED_MODULE_2__.sh,Object.assign({units:largest?allUnits:defaultUnits,largest,language:locale},fallbacks.length?{fallbacks}:{}))}},"./ts/util/getCustomColorStyle.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>getCustomColorStyle});var Util=__webpack_require__("./ts/types/Util.ts"),getHSL=__webpack_require__("./ts/util/getHSL.ts"),es=__webpack_require__("./node_modules/reselect/es/index.js"),version=__webpack_require__("./ts/util/version.ts"),getUser=function(state){return state.user},getPlatform=((0,es.P1)(getUser,(function(state){return state.ourNumber})),(0,es.P1)(getUser,(function(state){return state.ourDeviceId})),(0,es.P1)(getUser,(function(state){return state.regionCode})),(0,es.P1)(getUser,(function(state){return state.ourConversationId})),(0,es.P1)(getUser,(function(state){return state.ourACI})),(0,es.P1)(getUser,(function(state){return state.ourPNI})),(0,es.P1)(getUser,(function(state){return state.i18n})),(0,es.P1)(getUser,(function(state){return state.localeMessages})),(0,es.P1)(getUser,(function(state){return state.interactionMode})),(0,es.P1)(getUser,(function(state){return state.attachmentsPath})),(0,es.P1)(getUser,(function(state){return state.stickersPath})),(0,es.P1)(getUser,(function(state){return state.platform}))),getTheme=((0,es.P1)(getUser,(function(state){return state.tempPath})),(0,es.P1)(getUser,(function(state){return state.theme}))),getVersion=(0,es.P1)(getUser,(function(state){return state.version}));(0,es.P1)(getVersion,version.$9),(0,es.P1)(getVersion,version.hN),(0,es.P1)(getUser,(function(state){return state.isMainWindowMaximized})),(0,es.P1)(getUser,(function(state){return state.isMainWindowFullScreen})),(0,es.P1)(getUser,(function(state){return state.menuOptions})),(0,es.P1)(getPlatform,(function(platform){return"darwin"===platform}));function getUserTheme(){return getTheme(window.reduxStore.getState())}function getCustomColorStyle(color){var isQuote=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(color){var extraQuoteProps={},adjustedLightness=0;if(isQuote){var theme=getUserTheme();theme===Util.f8.light&&(adjustedLightness=.6),theme===Util.f8.dark&&(adjustedLightness=-.4),extraQuoteProps.borderLeftColor=(0,getHSL.$)(color.start)}return color.end?Object.assign({},extraQuoteProps,{backgroundImage:`linear-gradient(${270-(color.deg||0)}deg, ${(0,getHSL.$)(color.start,adjustedLightness)}, ${(0,getHSL.$)(color.end,adjustedLightness)})`}):Object.assign({},extraQuoteProps,{backgroundColor:(0,getHSL.$)(color.start,adjustedLightness)})}}},"./ts/util/getHSL.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>getHSL});var LIGHTNESS_TABLE={0:45,60:30,180:30,240:50,300:40,360:45};function getLightnessFromHue(hue,min,max){var minValue=LIGHTNESS_TABLE[min];return 100*(hue-min)/(max-min)*(LIGHTNESS_TABLE[max]-minValue)/100+minValue}function calculateLightness(hue){return hue<60?getLightnessFromHue(hue,0,60):hue<180?30:hue<240?getLightnessFromHue(hue,180,240):hue<300?getLightnessFromHue(hue,240,300):getLightnessFromHue(hue,300,360)}function adjustLightnessValue(lightness,percentIncrease){return lightness+lightness*percentIncrease}function getHSL(_ref){var hue=_ref.hue,saturation=_ref.saturation,adjustedLightness=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return`hsl(${hue}, ${saturation}%, ${adjustLightnessValue(calculateLightness(hue),adjustedLightness)}%)`}},"./ts/util/getMuteOptions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>getMuteOptions});var _durations__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/durations/index.ts"),_getMutedUntilText__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/getMutedUntilText.ts"),_isConversationMuted__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/isConversationMuted.ts");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function getMuteOptions(muteExpiresAt,i18n){return[].concat(_toConsumableArray(muteExpiresAt&&(0,_isConversationMuted__WEBPACK_IMPORTED_MODULE_2__.c)({muteExpiresAt})?[{name:(0,_getMutedUntilText__WEBPACK_IMPORTED_MODULE_1__.x)(muteExpiresAt,i18n),disabled:!0,value:-1},{name:i18n("icu:unmute"),value:0}]:[]),[{name:i18n("icu:muteHour"),value:_durations__WEBPACK_IMPORTED_MODULE_0__.kr},{name:i18n("icu:muteEightHours"),value:8*_durations__WEBPACK_IMPORTED_MODULE_0__.kr},{name:i18n("icu:muteDay"),value:_durations__WEBPACK_IMPORTED_MODULE_0__.x4},{name:i18n("icu:muteWeek"),value:_durations__WEBPACK_IMPORTED_MODULE_0__.ps},{name:i18n("icu:muteAlways"),value:Number.MAX_SAFE_INTEGER}])}},"./ts/util/getMutedUntilText.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>getMutedUntilText});var moment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/moment/moment.js"),moment__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__),_timestamp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/timestamp.ts");function getMutedUntilText(muteExpiresAt,i18n){if(Number(muteExpiresAt)>=Number.MAX_SAFE_INTEGER)return i18n("icu:muteExpirationLabelAlways");var expires=moment__WEBPACK_IMPORTED_MODULE_0___default()(muteExpiresAt);return i18n("icu:muteExpirationLabel",{duration:(0,_timestamp__WEBPACK_IMPORTED_MODULE_1__.zk)(expires)?expires.format("LT"):expires.format("L, LT")})}},"./ts/util/grapheme.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{QX:()=>count,Rc:()=>truncateAndSize,i3:()=>isSingleGrapheme});var _iterables__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/iterables.ts");function count(str){var segments=(new Intl.Segmenter).segment(str);return(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.dp)(segments)}function truncateAndSize(str,toSize){var segments=(new Intl.Segmenter).segment(str),originalSize=(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.dp)(segments);return void 0===toSize||originalSize<=toSize?[str,originalSize]:[(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.v_)((0,_iterables__WEBPACK_IMPORTED_MODULE_0__.UI)((0,_iterables__WEBPACK_IMPORTED_MODULE_0__.qn)(segments,toSize),(function(s){return s.segment})),""),toSize]}function isSingleGrapheme(str){return""!==str&&(new Intl.Segmenter).segment(str).containing(0).segment===str}},"./ts/util/isConversationMuted.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>isConversationMuted});var isConversationMuted=function(_ref){var muteExpiresAt=_ref.muteExpiresAt;return Boolean(muteExpiresAt&&Date.now()<muteExpiresAt)}},"./ts/util/keyboard.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>arrow});var logicalArrows={start:{ltr:"ArrowLeft",rtl:"ArrowRight"},end:{ltr:"ArrowRight",rtl:"ArrowLeft"}};function arrow(logicalDirection){var localeDirection=window.getResolvedMessagesLocaleDirection();return logicalArrows[logicalDirection][localeDirection]}},"./ts/util/parseIntOrThrow.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function parseIntOrThrow(value,message){var result;switch(typeof value){case"number":result=value;break;case"string":result=parseInt(value,10);break;default:result=NaN}if(!Number.isInteger(result))throw new Error(message);return result}__webpack_require__.d(__webpack_exports__,{Q:()=>parseIntOrThrow})},"./ts/util/popperUtil.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>offsetDistanceModifier,W:()=>sameWidthModifier});var offsetDistanceModifier=function(distance){return{name:"offset",options:{offset:[void 0,distance]}}},sameWidthModifier={name:"sameWidth",enabled:!0,phase:"write",fn:function(_ref){var state=_ref.state;state.elements.popper.style.width=`${state.rects.reference.width}px`}}},"./ts/util/version.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$9:()=>isAlpha,hN:()=>isBeta});var semver__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/semver/semver.js"),isBeta=function(version){var _semver$parse;return"beta"===(null===(_semver$parse=semver__WEBPACK_IMPORTED_MODULE_0__.parse(version))||void 0===_semver$parse?void 0:_semver$parse.prerelease[0])},isAlpha=function(version){var _semver$parse2;return"alpha"===(null===(_semver$parse2=semver__WEBPACK_IMPORTED_MODULE_0__.parse(version))||void 0===_semver$parse2?void 0:_semver$parse2.prerelease[0])}}}]);
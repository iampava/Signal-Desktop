"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[9035],{"./ts/components/AvatarUploadButton.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),_util_setupI18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/setupI18n.ts"),_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./_locales/en/messages.json"),_AvatarUploadButton__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/AvatarUploadButton.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js"),i18n=(0,_util_setupI18n__WEBPACK_IMPORTED_MODULE_2__.E5)("en",_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__);const __WEBPACK_DEFAULT_EXPORT__={title:"Components/AvatarUploadButton"};function Default(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_AvatarUploadButton__WEBPACK_IMPORTED_MODULE_4__.h,Object.assign({},function(){var overrideProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{className:overrideProps.className||"",i18n,onChange:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("onChange")}}()))}Default.displayName="Default";var __namedExportsOrder=["Default"]},"./ts/components/AvatarUploadButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>AvatarUploadButton});var noop=__webpack_require__("./node_modules/lodash/noop.js"),noop_default=__webpack_require__.n(noop),react=__webpack_require__("./node_modules/react/index.js"),js=__webpack_require__("./node_modules/blueimp-load-image/js/index.js"),js_default=__webpack_require__.n(js),canvasToBytes=__webpack_require__("./ts/util/canvasToBytes.ts");var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarUploadButton(_ref){var className=_ref.className,i18n=_ref.i18n,onChange=_ref.onChange,fileInputRef=(0,react.useRef)(null),_useState2=_slicedToArray((0,react.useState)(),2),processingFile=_useState2[0],setProcessingFile=_useState2[1];(0,react.useEffect)((function(){if(!processingFile)return noop_default();var shouldCancel=!1;return async function(){var newAvatar;try{newAvatar=await async function processImageFile(file){var image=(await js_default()(file,{canvas:!0,cover:!0,crop:!0,imageSmoothingQuality:"medium",maxHeight:512,maxWidth:512,minHeight:2,minWidth:2})).image;if(!(image instanceof HTMLCanvasElement))throw new Error("Loaded image was not a canvas");return(0,canvasToBytes.E)(image)}(processingFile)}catch(err){return}shouldCancel||(setProcessingFile(void 0),onChange(newAvatar))}(),function(){shouldCancel=!0}}),[onChange,processingFile]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{className,onClick:function(){var fileInput=fileInputRef.current;fileInput&&(fileInput.value="",fileInput.click())},type:"button",children:i18n("icu:photo")}),(0,jsx_runtime.jsx)("input",{accept:".gif,.jpg,.jpeg,.png,.webp,image/gif,image/jpeg,image/png,image/webp",hidden:!0,onChange:function(event){var file=event.target.files&&event.target.files[0];file&&setProcessingFile(file)},ref:fileInputRef,type:"file"})]})}},"./ts/types/MIME.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Aw:()=>isLongMessage,F0:()=>isAudio,F5:()=>VIDEO_QUICKTIME,Ih:()=>IMAGE_PNG,Oh:()=>IMAGE_ICO,Or:()=>isImage,UG:()=>IMAGE_BMP,Wv:()=>isVideo,_l:()=>IMAGE_JPEG,cJ:()=>stringToMIMEType,dB:()=>IMAGE_GIF,ml:()=>VIDEO_MP4,np:()=>TEXT_ATTACHMENT,rJ:()=>LONG_MESSAGE,sY:()=>isGif,to:()=>IMAGE_WEBP,ty:()=>AUDIO_MP3});var stringToMIMEType=function(value){return value},AUDIO_MP3=(stringToMIMEType("application/octet-stream"),stringToMIMEType("application/json"),stringToMIMEType("audio/aac"),stringToMIMEType("audio/mp3")),IMAGE_GIF=stringToMIMEType("image/gif"),IMAGE_JPEG=stringToMIMEType("image/jpeg"),IMAGE_PNG=stringToMIMEType("image/png"),IMAGE_WEBP=stringToMIMEType("image/webp"),IMAGE_ICO=stringToMIMEType("image/x-icon"),IMAGE_BMP=stringToMIMEType("image/bmp"),VIDEO_MP4=stringToMIMEType("video/mp4"),VIDEO_QUICKTIME=stringToMIMEType("video/quicktime"),LONG_MESSAGE=stringToMIMEType("text/x-signal-plain"),TEXT_ATTACHMENT=stringToMIMEType("text/x-signal-story"),isGif=function(value){return"image/gif"===value},isImage=function(value){return Boolean(value)&&value.startsWith("image/")},isVideo=function(value){return Boolean(value)&&value.startsWith("video/")},isAudio=function(value){return Boolean(value)&&value.startsWith("audio/")&&!value.endsWith("aiff")},isLongMessage=function(value){return value===LONG_MESSAGE}},"./ts/util/canvasToBlob.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>canvasToBlob});var _types_MIME__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/MIME.ts");async function canvasToBlob(canvas){var mimeType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,quality=arguments.length>2?arguments[2]:void 0;return new Promise((function(resolve,reject){return canvas.toBlob((function(result){result?resolve(result):reject(new Error("Couldn't convert the canvas to a Blob"))}),mimeType,quality)}))}},"./ts/util/canvasToBytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>canvasToBytes});var _canvasToBlob__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/canvasToBlob.ts");async function canvasToBytes(canvas,mimeType,quality){var blob=await(0,_canvasToBlob__WEBPACK_IMPORTED_MODULE_0__._)(canvas,mimeType,quality);return new Uint8Array(await blob.arrayBuffer())}}}]);
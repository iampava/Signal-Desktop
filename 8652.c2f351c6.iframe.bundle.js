"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[8652],{"./ts/components/AddGroupMemberErrorDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>AddGroupMemberErrorDialogMode,W:()=>AddGroupMemberErrorDialog});__webpack_require__("./node_modules/react/index.js");var AddGroupMemberErrorDialogMode,_Alert__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Alert.tsx"),_util_missingCaseError__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/missingCaseError.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AddGroupMemberErrorDialog(props){var title,body,i18n=props.i18n,onClose=props.onClose;switch(props.mode){case AddGroupMemberErrorDialogMode.MaximumGroupSize:var maximumNumberOfContacts=props.maximumNumberOfContacts;title=i18n("icu:chooseGroupMembers__maximum-group-size__title"),body=i18n("icu:chooseGroupMembers__maximum-group-size__body",{max:maximumNumberOfContacts});break;case AddGroupMemberErrorDialogMode.RecommendedMaximumGroupSize:var recommendedMaximumNumberOfContacts=props.recommendedMaximumNumberOfContacts;title=i18n("icu:chooseGroupMembers__maximum-recommended-group-size__title"),body=i18n("icu:chooseGroupMembers__maximum-recommended-group-size__body",{max:recommendedMaximumNumberOfContacts});break;default:throw(0,_util_missingCaseError__WEBPACK_IMPORTED_MODULE_3__.b)(props)}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Alert__WEBPACK_IMPORTED_MODULE_1__.b,{body,i18n,onClose,title})}!function(AddGroupMemberErrorDialogMode){AddGroupMemberErrorDialogMode[AddGroupMemberErrorDialogMode.MaximumGroupSize=0]="MaximumGroupSize",AddGroupMemberErrorDialogMode[AddGroupMemberErrorDialogMode.RecommendedMaximumGroupSize=1]="RecommendedMaximumGroupSize"}(AddGroupMemberErrorDialogMode||(AddGroupMemberErrorDialogMode={})),AddGroupMemberErrorDialog.displayName="AddGroupMemberErrorDialog"},"./ts/components/Alert.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>Alert});__webpack_require__("./node_modules/react/index.js");var _Button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Button.tsx"),_Modal__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/Modal.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function Alert(_ref){var body=_ref.body,i18n=_ref.i18n,onClose=_ref.onClose,theme=_ref.theme,title=_ref.title;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Modal__WEBPACK_IMPORTED_MODULE_2__.u_,{i18n,modalFooter:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.zx,{onClick:onClose,children:i18n("icu:Confirmation--confirm")}),modalName:"Alert",onClose,theme,title,children:body})}Alert.displayName="Alert"},"./ts/components/ContactPill.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>ContactPill});__webpack_require__("./node_modules/react/index.js");var _conversation_ContactName__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),_Avatar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/Avatar.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ContactPill(_ref){var acceptedMessageRequest=_ref.acceptedMessageRequest,avatarPath=_ref.avatarPath,color=_ref.color,firstName=_ref.firstName,i18n=_ref.i18n,isMe=_ref.isMe,id=_ref.id,phoneNumber=_ref.phoneNumber,profileName=_ref.profileName,sharedGroupNames=_ref.sharedGroupNames,title=_ref.title,unblurredAvatarPath=_ref.unblurredAvatarPath,onClickRemove=_ref.onClickRemove,removeLabel=i18n("icu:ContactPill--remove");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:"module-ContactPill",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Avatar__WEBPACK_IMPORTED_MODULE_2__.qE,{acceptedMessageRequest,avatarPath,badge:void 0,color,noteToSelf:!1,conversationType:"direct",i18n,isMe,phoneNumber,profileName,title,sharedGroupNames,size:_Avatar__WEBPACK_IMPORTED_MODULE_2__.DZ.TWENTY_EIGHT,unblurredAvatarPath}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_conversation_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{firstName,module:"module-ContactPill__contact-name",preferFirstName:!0,title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("button",{"aria-label":removeLabel,className:"module-ContactPill__remove",onClick:function(){onClickRemove(id)},title:removeLabel,type:"button"})]})}ContactPill.displayName="ContactPill"},"./ts/components/ContactPills.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>ContactPills});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_hooks_usePrevious__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/hooks/usePrevious.ts"),_util_scrollUtil__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/util/scrollUtil.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ContactPills(_ref){var moduleClassName=_ref.moduleClassName,children=_ref.children,elRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),childCount=react__WEBPACK_IMPORTED_MODULE_0__.Children.count(children),previousChildCount=(0,_hooks_usePrevious__WEBPACK_IMPORTED_MODULE_2__.D)(0,childCount);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var hasAddedNewChild=childCount>previousChildCount,el=elRef.current;hasAddedNewChild&&el&&(0,_util_scrollUtil__WEBPACK_IMPORTED_MODULE_4__.Og)(el)}),[childCount,previousChildCount]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-ContactPills",moduleClassName),ref:elRef,children})}ContactPills.displayName="ContactPills"},"./ts/components/SearchInput.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>SearchInput});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/getClassNamesFor.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),SearchInput=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function SearchInputInner(_ref,ref){var children=_ref.children,_ref$disabled=_ref.disabled,disabled=void 0!==_ref$disabled&&_ref$disabled,_ref$hasSearchIcon=_ref.hasSearchIcon,hasSearchIcon=void 0===_ref$hasSearchIcon||_ref$hasSearchIcon,i18n=_ref.i18n,label=_ref.label,moduleClassName=_ref.moduleClassName,onClear=_ref.onClear,onBlur=_ref.onBlur,onChange=_ref.onChange,onKeyDown=_ref.onKeyDown,placeholder=_ref.placeholder,value=_ref.value,getClassName=(0,_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__.h)("module-SearchInput",moduleClassName);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:getClassName("__container"),children:[hasSearchIcon&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("i",{className:getClassName("__icon")}),children,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("input",{"aria-label":label||i18n("icu:search"),className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__input"),value&&getClassName("__input--with-text"),children&&getClassName("__input--with-children")),dir:"auto",disabled,onBlur,onChange,onKeyDown:function(event){var ctrlKey=event.ctrlKey,key=event.key;"linux"===window.platform&&ctrlKey&&"/"===key?(event.preventDefault(),event.stopPropagation()):"Escape"===key&&onClear&&(onClear(),event.preventDefault(),event.stopPropagation()),null==onKeyDown||onKeyDown(event)},placeholder,ref,type:"text",value}),value&&onClear&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("button",{"aria-label":i18n("icu:cancel"),className:getClassName("__cancel"),onClick:onClear,tabIndex:-1,type:"button"})]})}))},"./ts/components/conversation/conversation-details/AddGroupMembersModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>AddGroupMembersModal});var OneTimeModalState,without=__webpack_require__("./node_modules/lodash/without.js"),without_default=__webpack_require__.n(without),react=__webpack_require__("./node_modules/react/index.js"),AddGroupMemberErrorDialog=__webpack_require__("./ts/components/AddGroupMemberErrorDialog.tsx");!function(OneTimeModalState){OneTimeModalState[OneTimeModalState.NeverShown=0]="NeverShown",OneTimeModalState[OneTimeModalState.Showing=1]="Showing",OneTimeModalState[OneTimeModalState.Shown=2]="Shown"}(OneTimeModalState||(OneTimeModalState={}));var Stage,ActionType,missingCaseError=__webpack_require__("./ts/util/missingCaseError.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function reducer(state,action){switch(action.type){case ActionType.CloseMaximumGroupSizeModal:return Object.assign({},state,{maximumGroupSizeModalState:OneTimeModalState.Shown});case ActionType.CloseRecommendedMaximumGroupSizeModal:return Object.assign({},state,{recommendedGroupSizeModalState:OneTimeModalState.Shown});case ActionType.ConfirmAdds:return Object.assign({},state,{stage:Stage.ConfirmingAdds});case ActionType.ReturnToContactChooser:return Object.assign({},state,{stage:Stage.ChoosingContacts});case ActionType.RemoveSelectedContact:return Object.assign({},state,{selectedConversationIds:without_default()(state.selectedConversationIds,action.conversationId)});case ActionType.ToggleSelectedContact:return Object.assign({},state,function toggleSelectedContactForGroupAddition(conversationId,currentState){var maxGroupSize=currentState.maxGroupSize,maxRecommendedGroupSize=currentState.maxRecommendedGroupSize,numberOfContactsAlreadyInGroup=currentState.numberOfContactsAlreadyInGroup,oldSelectedConversationIds=currentState.selectedConversationIds,maximumGroupSizeModalState=currentState.maximumGroupSizeModalState,recommendedGroupSizeModalState=currentState.recommendedGroupSizeModalState,selectedConversationIds=without_default()(oldSelectedConversationIds,conversationId);if(selectedConversationIds.length===oldSelectedConversationIds.length){var newExpectedMemberCount=selectedConversationIds.length+numberOfContactsAlreadyInGroup+1;newExpectedMemberCount<=maxGroupSize&&(newExpectedMemberCount===maxGroupSize&&maximumGroupSizeModalState===OneTimeModalState.NeverShown?maximumGroupSizeModalState=OneTimeModalState.Showing:newExpectedMemberCount>=maxRecommendedGroupSize&&recommendedGroupSizeModalState===OneTimeModalState.NeverShown&&(recommendedGroupSizeModalState=OneTimeModalState.Showing),selectedConversationIds.push(conversationId))}return{selectedConversationIds,maximumGroupSizeModalState,recommendedGroupSizeModalState}}(action.conversationId,{maxGroupSize:state.maxGroupSize,maxRecommendedGroupSize:state.maxRecommendedGroupSize,maximumGroupSizeModalState:state.maximumGroupSizeModalState,numberOfContactsAlreadyInGroup:action.numberOfContactsAlreadyInGroup,recommendedGroupSizeModalState:state.recommendedGroupSizeModalState,selectedConversationIds:state.selectedConversationIds}));case ActionType.UpdateSearchTerm:return Object.assign({},state,{searchTerm:action.searchTerm});default:throw(0,missingCaseError.b)(action)}}function AddGroupMembersModal(_ref){var clearRequestError=_ref.clearRequestError,conversationIdsAlreadyInGroup=_ref.conversationIdsAlreadyInGroup,groupTitle=_ref.groupTitle,i18n=_ref.i18n,onClose=_ref.onClose,makeRequest=_ref.makeRequest,maxGroupSize=_ref.maxGroupSize,maxRecommendedGroupSize=_ref.maxRecommendedGroupSize,requestState=_ref.requestState,renderChooseGroupMembersModal=_ref.renderChooseGroupMembersModal,renderConfirmAdditionsModal=_ref.renderConfirmAdditionsModal,numberOfContactsAlreadyInGroup=conversationIdsAlreadyInGroup.size,isGroupAlreadyFull=numberOfContactsAlreadyInGroup>=maxGroupSize,isGroupAlreadyOverRecommendedMaximum=numberOfContactsAlreadyInGroup>=maxRecommendedGroupSize,_useReducer2=_slicedToArray((0,react.useReducer)(reducer,{maxGroupSize,maxRecommendedGroupSize,maximumGroupSizeModalState:isGroupAlreadyFull?OneTimeModalState.Showing:OneTimeModalState.NeverShown,recommendedGroupSizeModalState:isGroupAlreadyOverRecommendedMaximum?OneTimeModalState.Shown:OneTimeModalState.NeverShown,searchTerm:"",selectedConversationIds:[],stage:Stage.ChoosingContacts}),2),_useReducer2$=_useReducer2[0],maximumGroupSizeModalState=_useReducer2$.maximumGroupSizeModalState,recommendedGroupSizeModalState=_useReducer2$.recommendedGroupSizeModalState,searchTerm=_useReducer2$.searchTerm,selectedConversationIds=_useReducer2$.selectedConversationIds,stage=_useReducer2$.stage,dispatch=_useReducer2[1];if(maximumGroupSizeModalState===OneTimeModalState.Showing)return(0,jsx_runtime.jsx)(AddGroupMemberErrorDialog.W,{i18n,maximumNumberOfContacts:maxGroupSize,mode:AddGroupMemberErrorDialog.$.MaximumGroupSize,onClose:function(){dispatch({type:ActionType.CloseMaximumGroupSizeModal})}});if(recommendedGroupSizeModalState===OneTimeModalState.Showing)return(0,jsx_runtime.jsx)(AddGroupMemberErrorDialog.W,{i18n,mode:AddGroupMemberErrorDialog.$.RecommendedMaximumGroupSize,onClose:function(){dispatch({type:ActionType.CloseRecommendedMaximumGroupSizeModal})},recommendedMaximumNumberOfContacts:maxRecommendedGroupSize});switch(stage){case Stage.ChoosingContacts:return renderChooseGroupMembersModal({confirmAdds:function(){dispatch({type:ActionType.ConfirmAdds})},selectedConversationIds,conversationIdsAlreadyInGroup,maxGroupSize,onClose,removeSelectedContact:function(conversationId){dispatch({type:ActionType.RemoveSelectedContact,conversationId})},searchTerm,setSearchTerm:function(term){dispatch({type:ActionType.UpdateSearchTerm,searchTerm:term})},toggleSelectedContact:function(conversationId){dispatch({type:ActionType.ToggleSelectedContact,conversationId,numberOfContactsAlreadyInGroup})}});case Stage.ConfirmingAdds:return renderConfirmAdditionsModal({groupTitle,makeRequest:function(){makeRequest(selectedConversationIds)},onClose:function(){dispatch({type:ActionType.ReturnToContactChooser}),clearRequestError()},requestState,selectedConversationIds});default:throw(0,missingCaseError.b)(stage)}}!function(Stage){Stage[Stage.ChoosingContacts=0]="ChoosingContacts",Stage[Stage.ConfirmingAdds=1]="ConfirmingAdds"}(Stage||(Stage={})),function(ActionType){ActionType[ActionType.CloseMaximumGroupSizeModal=0]="CloseMaximumGroupSizeModal",ActionType[ActionType.CloseRecommendedMaximumGroupSizeModal=1]="CloseRecommendedMaximumGroupSizeModal",ActionType[ActionType.ConfirmAdds=2]="ConfirmAdds",ActionType[ActionType.RemoveSelectedContact=3]="RemoveSelectedContact",ActionType[ActionType.ReturnToContactChooser=4]="ReturnToContactChooser",ActionType[ActionType.ToggleSelectedContact=5]="ToggleSelectedContact",ActionType[ActionType.UpdateSearchTerm=6]="UpdateSearchTerm"}(ActionType||(ActionType={}))},"./ts/components/conversation/conversation-details/AddGroupMembersModal/ChooseGroupMembersModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>ChooseGroupMembersModal});var lodash_omit__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/omit.js"),lodash_omit__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_omit__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_measure__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-measure/dist/index.esm.js"),_types_Username__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/types/Username.ts"),_util_assert__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/util/assert.ts"),_util_refMerger__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/util/refMerger.ts"),_hooks_useRestoreFocus__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/hooks/useRestoreFocus.ts"),_util_missingCaseError__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./ts/util/missingCaseError.ts"),_util_libphonenumberInstance__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/util/libphonenumberInstance.ts"),_util_filterAndSortConversations__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/util/filterAndSortConversations.ts"),_util_uuidFetchState__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./ts/util/uuidFetchState.ts"),_ModalHost__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ts/components/ModalHost.tsx"),_ContactPills__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./ts/components/ContactPills.tsx"),_ContactPill__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./ts/components/ContactPill.tsx"),_ConversationList__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./ts/components/ConversationList.tsx"),_conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./ts/components/conversationList/ContactCheckbox.tsx"),_Button__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./ts/components/Button.tsx"),_SearchInput__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./ts/components/SearchInput.tsx"),_ListView__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./ts/components/ListView.tsx"),_conversationList_UsernameCheckbox__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./ts/components/conversationList/UsernameCheckbox.tsx"),_conversationList_PhoneNumberCheckbox__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./ts/components/conversationList/PhoneNumberCheckbox.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ChooseGroupMembersModal(_ref){var username,phoneNumber,regionCode=_ref.regionCode,candidateContacts=_ref.candidateContacts,confirmAdds=_ref.confirmAdds,conversationIdsAlreadyInGroup=_ref.conversationIdsAlreadyInGroup,i18n=_ref.i18n,maxGroupSize=_ref.maxGroupSize,onClose=_ref.onClose,removeSelectedContact=_ref.removeSelectedContact,searchTerm=_ref.searchTerm,selectedContacts=_ref.selectedContacts,setSearchTerm=_ref.setSearchTerm,theme=_ref.theme,toggleSelectedContact=_ref.toggleSelectedContact,lookupConversationWithoutUuid=_ref.lookupConversationWithoutUuid,showUserNotFoundModal=_ref.showUserNotFoundModal,isUsernamesEnabled=_ref.isUsernamesEnabled,focusRef=_slicedToArray((0,_hooks_useRestoreFocus__WEBPACK_IMPORTED_MODULE_6__.H)(),1)[0],isUsernameChecked=!1,isUsernameVisible=!1;isUsernamesEnabled&&(username=(0,_types_Username__WEBPACK_IMPORTED_MODULE_3__.vm)(searchTerm),isUsernameChecked=selectedContacts.some((function(contact){return contact.username===username})),isUsernameVisible=Boolean(username)&&candidateContacts.every((function(contact){return contact.username!==username}))),username||(phoneNumber=(0,_util_libphonenumberInstance__WEBPACK_IMPORTED_MODULE_7__.i9)(searchTerm,regionCode));var isPhoneNumberChecked=!1,isPhoneNumberVisible=!1;if(phoneNumber){var e164=phoneNumber.e164;isPhoneNumberChecked=phoneNumber.isValid&&selectedContacts.some((function(contact){return contact.e164===e164})),isPhoneNumberVisible=candidateContacts.every((function(contact){return contact.e164!==e164}))}var inputRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),numberOfContactsAlreadyInGroup=conversationIdsAlreadyInGroup.size,hasSelectedMaximumNumberOfContacts=selectedContacts.length+numberOfContactsAlreadyInGroup>=maxGroupSize,selectedConversationIdsSet=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return new Set(selectedContacts.map((function(contact){return contact.id})))}),[selectedContacts]),canContinue=Boolean(selectedContacts.length),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_util_filterAndSortConversations__WEBPACK_IMPORTED_MODULE_8__.x)(candidateContacts,"",regionCode)),2),filteredContacts=_useState2[0],setFilteredContacts=_useState2[1],normalizedSearchTerm=searchTerm.trim();(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){var timeout=setTimeout((function(){setFilteredContacts((0,_util_filterAndSortConversations__WEBPACK_IMPORTED_MODULE_8__.x)(candidateContacts,normalizedSearchTerm,regionCode))}),200);return function(){clearTimeout(timeout)}}),[candidateContacts,normalizedSearchTerm,setFilteredContacts,regionCode]);var _useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({}),2),uuidFetchState=_useState4[0],setUuidFetchState=_useState4[1],setIsFetchingUUID=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(identifier,isFetching){setUuidFetchState((function(prevState){return isFetching?Object.assign({},prevState,{[identifier]:isFetching}):lodash_omit__WEBPACK_IMPORTED_MODULE_0___default()(prevState,identifier)}))}),[setUuidFetchState]),rowCount=0;filteredContacts.length&&(rowCount+=filteredContacts.length),(isPhoneNumberVisible||isUsernameVisible)&&(filteredContacts.length&&(rowCount+=1),rowCount+=2);var getRow=function(index){var virtualIndex=index;if((isPhoneNumberVisible||isUsernameVisible)&&filteredContacts.length){if(0===virtualIndex)return{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.Header,getHeaderText:function(i18n){return i18n("icu:contactsHeader")}};virtualIndex-=1}if(virtualIndex<filteredContacts.length){var disabledReason,contact=filteredContacts[virtualIndex],isSelected=selectedConversationIdsSet.has(contact.id),isAlreadyInGroup=conversationIdsAlreadyInGroup.has(contact.id);return isAlreadyInGroup?disabledReason=_conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__.B.AlreadyAdded:hasSelectedMaximumNumberOfContacts&&!isSelected&&(disabledReason=_conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__.B.MaximumContactsSelected),{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.ContactCheckbox,contact,isChecked:isSelected||isAlreadyInGroup,disabledReason}}if(virtualIndex-=filteredContacts.length,isPhoneNumberVisible){if((0,_util_assert__WEBPACK_IMPORTED_MODULE_4__.Yj)(void 0!==phoneNumber,"phone number can't be visible if not present"),0===virtualIndex)return{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.Header,getHeaderText:function(i18n){return i18n("icu:findByPhoneNumberHeader")}};if(1===virtualIndex)return{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.PhoneNumberCheckbox,isChecked:isPhoneNumberChecked,isFetching:(0,_util_uuidFetchState__WEBPACK_IMPORTED_MODULE_20__.Q)(uuidFetchState,phoneNumber.e164),phoneNumber};virtualIndex-=2}if(username){if(0===virtualIndex)return{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.Header,getHeaderText:function(i18n){return i18n("icu:findByUsernameHeader")}};if(1===virtualIndex)return{type:_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.UsernameCheckbox,isChecked:isUsernameChecked,isFetching:(0,_util_uuidFetchState__WEBPACK_IMPORTED_MODULE_20__.h)(uuidFetchState,username),username};virtualIndex-=2}},handleContactClick=function(conversationId,disabledReason){switch(disabledReason){case void 0:toggleSelectedContact(conversationId);break;case _conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__.B.AlreadyAdded:case _conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__.B.MaximumContactsSelected:break;default:throw(0,_util_missingCaseError__WEBPACK_IMPORTED_MODULE_21__.b)(disabledReason)}},renderItem=function(_ref2){var item,key=_ref2.key,index=_ref2.index,style=_ref2.style,row=getRow(index);switch(null==row?void 0:row.type){case _ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.Header:var headerText=row.getHeaderText(i18n);item=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("div",{className:"module-conversation-list__item--header","aria-label":headerText,children:headerText});break;case _ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.ContactCheckbox:item=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_conversationList_ContactCheckbox__WEBPACK_IMPORTED_MODULE_13__.F,Object.assign({i18n,theme},row.contact,{onClick:handleContactClick,isChecked:row.isChecked,badge:void 0}));break;case _ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.UsernameCheckbox:item=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_conversationList_UsernameCheckbox__WEBPACK_IMPORTED_MODULE_17__.s,{i18n,theme,username:row.username,isChecked:row.isChecked,isFetching:row.isFetching,toggleConversationInChooseMembers:function(conversationId){return handleContactClick(conversationId,void 0)},showUserNotFoundModal,setIsFetchingUUID,lookupConversationWithoutUuid});break;case _ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.PhoneNumberCheckbox:item=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_conversationList_PhoneNumberCheckbox__WEBPACK_IMPORTED_MODULE_18__.e,{phoneNumber:row.phoneNumber,lookupConversationWithoutUuid,showUserNotFoundModal,setIsFetchingUUID,toggleConversationInChooseMembers:function(conversationId){return handleContactClick(conversationId,void 0)},isChecked:row.isChecked,isFetching:row.isFetching,i18n,theme})}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("div",{style,children:item},key)};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_ModalHost__WEBPACK_IMPORTED_MODULE_9__.l,{modalName:"AddGroupMembersModal.ChooseGroupMembersModal",onClose,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsxs)("div",{className:"module-AddGroupMembersModal module-AddGroupMembersModal--choose-members",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("button",{"aria-label":i18n("icu:close"),className:"module-AddGroupMembersModal__close-button",type:"button",onClick:function(){onClose()}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("h1",{className:"module-AddGroupMembersModal__header",children:i18n("icu:AddGroupMembersModal--title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_SearchInput__WEBPACK_IMPORTED_MODULE_15__.M,{i18n,placeholder:i18n("icu:contactSearchPlaceholder"),onChange:function(event){setSearchTerm(event.target.value)},onKeyDown:function(event){canContinue&&"Enter"===event.key&&confirmAdds()},ref:(0,_util_refMerger__WEBPACK_IMPORTED_MODULE_5__.M)(inputRef,focusRef),value:searchTerm}),Boolean(selectedContacts.length)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_ContactPills__WEBPACK_IMPORTED_MODULE_10__.b,{children:selectedContacts.map((function(contact){var _contact$systemGivenN;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_ContactPill__WEBPACK_IMPORTED_MODULE_11__.p,{acceptedMessageRequest:contact.acceptedMessageRequest,avatarPath:contact.avatarPath,color:contact.color,firstName:null!==(_contact$systemGivenN=contact.systemGivenName)&&void 0!==_contact$systemGivenN?_contact$systemGivenN:contact.firstName,i18n,isMe:contact.isMe,id:contact.id,phoneNumber:contact.phoneNumber,profileName:contact.profileName,sharedGroupNames:contact.sharedGroupNames,title:contact.title,onClickRemove:function(){removeSelectedContact(contact.id)}},contact.id)}))}),rowCount?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(react_measure__WEBPACK_IMPORTED_MODULE_2__.Z,{bounds:!0,children:function(_ref3){var contentRect=_ref3.contentRect,measureRef=_ref3.measureRef,_ref4=contentRect.bounds||{},_ref4$width=_ref4.width,width=void 0===_ref4$width?100:_ref4$width,_ref4$height=_ref4.height,height=void 0===_ref4$height?100:_ref4$height;return width&&height?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("div",{className:"module-AddGroupMembersModal__list-wrapper",ref:measureRef,onKeyDown:function(event){var _inputRef$current;"Enter"===event.key&&(null===(_inputRef$current=inputRef.current)||void 0===_inputRef$current||_inputRef$current.focus())},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_ListView__WEBPACK_IMPORTED_MODULE_16__.B,{width,height,rowCount,calculateRowHeight:function(index){var row=getRow(index);return row?row.type===_ConversationList__WEBPACK_IMPORTED_MODULE_12__.aC.Header?40:52:((0,_util_assert__WEBPACK_IMPORTED_MODULE_4__.q8)(!1,`Expected a row at index ${index}`),52)},rowRenderer:renderItem})}):null}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)("div",{className:"module-AddGroupMembersModal__no-candidate-contacts",children:i18n("icu:noContactsFound")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsxs)("div",{className:"module-AddGroupMembersModal__button-container",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_14__.zx,{onClick:onClose,variant:_Button__WEBPACK_IMPORTED_MODULE_14__.Wu.Secondary,children:i18n("icu:cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_19__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_14__.zx,{disabled:!canContinue,onClick:confirmAdds,children:i18n("icu:AddGroupMembersModal--continue-to-confirm")})]})]})})}ChooseGroupMembersModal.displayName="ChooseGroupMembersModal"},"./ts/components/conversation/conversation-details/AddGroupMembersModal/ConfirmAdditionsModal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>ConfirmAdditionsModal});__webpack_require__("./node_modules/react/index.js");var _util_assert__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/assert.ts"),_ModalHost__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ModalHost.tsx"),_Button__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Button.tsx"),_Spinner__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/Spinner.tsx"),_util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/conversation/conversation-details/util.ts"),_Intl__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/Intl.tsx"),_ContactName__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),_UserText__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/components/UserText.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConfirmAdditionsModal(_ref){var groupTitle=_ref.groupTitle,i18n=_ref.i18n,makeRequest=_ref.makeRequest,onClose=_ref.onClose,requestState=_ref.requestState,selectedContacts=_ref.selectedContacts,firstContact=selectedContacts[0];(0,_util_assert__WEBPACK_IMPORTED_MODULE_1__.q8)(firstContact,"Expected at least one conversation to be selected but none were picked");var headerText,buttonContents,groupTitleNode=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_UserText__WEBPACK_IMPORTED_MODULE_8__.a,{text:groupTitle});return headerText=1===selectedContacts.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_6__.R,{i18n,id:"icu:AddGroupMembersModal--confirm-title--one",components:{person:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_7__.K,{title:firstContact.title}),group:groupTitleNode}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_6__.R,{i18n,id:"icu:AddGroupMembersModal--confirm-title--many",components:{count:selectedContacts.length,group:groupTitleNode}}),buttonContents=requestState===_util__WEBPACK_IMPORTED_MODULE_5__.y.Active?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_4__.$j,{size:"20px",svgSize:"small",direction:"on-avatar"}):1===selectedContacts.length?i18n("icu:AddGroupMembersModal--confirm-button--one"):i18n("icu:AddGroupMembersModal--confirm-button--many"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ModalHost__WEBPACK_IMPORTED_MODULE_2__.l,{modalName:"AddGroupMemberModal.ConfirmAdditionsModal",onClose,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"module-AddGroupMembersModal module-AddGroupMembersModal--confirm-adds",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("h1",{className:"module-AddGroupMembersModal__header",children:headerText}),requestState===_util__WEBPACK_IMPORTED_MODULE_5__.y.InactiveWithError&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-AddGroupMembersModal__error-message",children:i18n("icu:updateGroupAttributes__error-message")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"module-AddGroupMembersModal__button-container",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_3__.zx,{onClick:onClose,variant:_Button__WEBPACK_IMPORTED_MODULE_3__.Wu.Secondary,children:i18n("icu:cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_3__.zx,{disabled:requestState===_util__WEBPACK_IMPORTED_MODULE_5__.y.Active,onClick:makeRequest,variant:_Button__WEBPACK_IMPORTED_MODULE_3__.Wu.Primary,children:buttonContents})]})]})})}ConfirmAdditionsModal.displayName="ConfirmAdditionsModal"},"./ts/components/conversation/conversation-details/util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>bemGenerator,y:()=>RequestState});var RequestState,classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__);!function(RequestState){RequestState[RequestState.Inactive=0]="Inactive",RequestState[RequestState.InactiveWithError=1]="InactiveWithError",RequestState[RequestState.Active=2]="Active"}(RequestState||(RequestState={}));var bemGenerator=function(block){return function(element,modifier){var base=`${block}__${element}`,classes=[base],conditionals={};return modifier&&("string"==typeof modifier?classes.push(`${base}--${modifier}`):conditionals=Object.keys(modifier).reduce((function(acc,key){return Object.assign({},acc,{[`${base}--${key}`]:modifier[key]})}),{})),classnames__WEBPACK_IMPORTED_MODULE_0___default()(classes,conditionals)}}},"./ts/hooks/useRestoreFocus.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>useRestoreFocus,e:()=>useDelayedRestoreFocus});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),useRestoreFocus=function(){var toFocusRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),lastFocusedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),setFocusRef=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(toFocus){toFocus&&(toFocusRef.current||(toFocusRef.current=toFocus,lastFocusedRef.current=document.activeElement,toFocus.focus()))}),[]);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){return function(){setTimeout((function(){lastFocusedRef.current&&lastFocusedRef.current.focus&&lastFocusedRef.current.focus()}))}}),[]),[setFocusRef]},useDelayedRestoreFocus=function(){var toFocusRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),lastFocusedRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),setFocusRef=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(toFocus){var timeout=setTimeout((function setFocus(){toFocus&&(toFocusRef.current||(toFocusRef.current=toFocus,lastFocusedRef.current=document.activeElement,toFocus.focus()))}),250);return function(){clearTimeout(timeout)}}),[]);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){return function(){setTimeout((function(){lastFocusedRef.current&&lastFocusedRef.current.focus&&lastFocusedRef.current.focus()}))}}),[]),[setFocusRef]}},"./ts/test-both/helpers/fakeLookupConversationWithoutUuid.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>useUuidFetchState,y:()=>makeFakeLookupConversationWithoutUuid});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_util_sleep__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/sleep.ts"),_util_durations__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/durations/index.ts"),_getDefaultConversation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/test-both/helpers/getDefaultConversation.ts");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VALID_IDENTIFIERS=new Set(["e164:+12125551234","username:bobross"]);function makeFakeLookupConversationWithoutUuid(saveConversation){var cache=new Map;return async function(options){var identifier="e164"===options.type?`e164:${options.e164}`:`username:${options.username}`,result=cache.get(identifier);return result?result.id:(VALID_IDENTIFIERS.has(identifier)&&saveConversation&&(result=(0,_getDefaultConversation__WEBPACK_IMPORTED_MODULE_2__.E$)(Object.assign({firstName:void 0,avatarPath:void 0,name:void 0,profileName:void 0},"e164"===options.type?{title:options.e164,e164:options.e164,phoneNumber:options.e164}:{title:`@${options.username}`,username:options.username})),cache.set(identifier,result),saveConversation(result)),options.setIsFetchingUUID(identifier,!0),await(0,_util_sleep__WEBPACK_IMPORTED_MODULE_3__._)(_util_durations__WEBPACK_IMPORTED_MODULE_1__.sh),options.setIsFetchingUUID(identifier,!1),result?result.id:void options.showUserNotFoundModal("username"===options.type?options:{type:"phoneNumber",phoneNumber:options.phoneNumber}))}}function useUuidFetchState(){var initial=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_useState=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initial),_useState2=_slicedToArray(_useState,2),uuidFetchState=_useState2[0],setUuidFetchState=_useState2[1],setIsFetchingUUID=function(key,value){setUuidFetchState((function(prev){return Object.assign({},prev,{[key]:value})}))};return[uuidFetchState,setIsFetchingUUID]}},"./ts/types/Username.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var ReserveUsernameError,ConfirmUsernameResult;function getUsernameFromSearch(searchTerm){var _ref,match=searchTerm.match(/^(?:(?<valid>[a-z_][0-9a-z_]*(?:\.\d*)?)|@(?<start>.*?)@?|@?(?<end>.*?)?@)$/);if(match){var groups=match.groups;if(groups)return null!==(_ref=groups.valid||groups.start||groups.end)&&void 0!==_ref?_ref:void 0}}function getNickname(username){var match=username.match(/^(.*?)(?:\.|$)/);if(match)return match[1]}function getDiscriminator(username){var match=username.match(/(\..*)$/);return match?match[1]:""}__webpack_require__.d(__webpack_exports__,{cR:()=>getDiscriminator,vm:()=>getUsernameFromSearch,y:()=>getNickname}),function(ReserveUsernameError){ReserveUsernameError.Unprocessable="Unprocessable",ReserveUsernameError.Conflict="Conflict",ReserveUsernameError.NotEnoughCharacters="NotEnoughCharacters",ReserveUsernameError.TooManyCharacters="TooManyCharacters",ReserveUsernameError.CheckStartingCharacter="CheckStartingCharacter",ReserveUsernameError.CheckCharacters="CheckCharacters"}(ReserveUsernameError||(ReserveUsernameError={})),function(ConfirmUsernameResult){ConfirmUsernameResult.Ok="Ok",ConfirmUsernameResult.ConflictOrGone="ConflictOrGone"}(ConfirmUsernameResult||(ConfirmUsernameResult={}))},"./ts/util/filterAndSortConversations.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>filterAndSortConversationsByRecent});var fuse_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/fuse.js/dist/fuse.esm.js"),_libphonenumberInstance__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/libphonenumberInstance.ts");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ACTIVE_AT_SCORE_FACTOR=1/__webpack_require__("./ts/util/durations/index.ts").ps*.01,FUSE_OPTIONS={threshold:.2,includeScore:!0,useExtendedSearch:!0,shouldSort:!0,distance:200,keys:[{name:"searchableTitle",weight:1},{name:"title",weight:1},{name:"name",weight:1},{name:"username",weight:1},{name:"e164",weight:.5}]},cachedIndices=new WeakMap,COMMANDS=new Map;function filterAndSortConversationsByRecent(conversations,searchTerm,regionCode){if(searchTerm.length){var now=Date.now();return function searchConversations(conversations,searchTerm,regionCode){var maybeCommand=searchTerm.match(/^!([^\s]+):(.*)$/);if(maybeCommand){var _maybeCommand=_slicedToArray(maybeCommand,3),commandName=_maybeCommand[1],_query=_maybeCommand[2],command=COMMANDS.get(commandName);if(command)return command(conversations,_query).map((function(item){return{item}}))}var phoneNumber=(0,_libphonenumberInstance__WEBPACK_IMPORTED_MODULE_0__.i9)(searchTerm,regionCode),extendedSearchTerm=searchTerm;phoneNumber&&(extendedSearchTerm+=` | ${phoneNumber.e164}`);var index=cachedIndices.get(conversations);return index||(index=new fuse_js__WEBPACK_IMPORTED_MODULE_2__.Z(conversations,FUSE_OPTIONS),cachedIndices.set(conversations,index)),index.search(extendedSearchTerm)}(conversations.filter((function(item){return item.titleNoDefault})),searchTerm,regionCode).slice().sort((function(a,b){var _a$score,_b$score,_a$item=a.item,_a$item$activeAt=_a$item.activeAt,aActiveAt=void 0===_a$item$activeAt?0:_a$item$activeAt,_a$item$left=_a$item.left,aLeft=void 0!==_a$item$left&&_a$item$left,_b$item=b.item,_b$item$activeAt=_b$item.activeAt,bActiveAt=void 0===_b$item$activeAt?0:_b$item$activeAt,_b$item$left=_b$item.left,bLeft=void 0!==_b$item$left&&_b$item$left;return(now-aActiveAt)*ACTIVE_AT_SCORE_FACTOR+(null!==(_a$score=a.score)&&void 0!==_a$score?_a$score:0)+(aLeft?1:0)-((now-bActiveAt)*ACTIVE_AT_SCORE_FACTOR+(null!==(_b$score=b.score)&&void 0!==_b$score?_b$score:0)+(bLeft?1:0))})).map((function(result){return result.item}))}return conversations.concat().sort((function(a,b){return a.activeAt&&b.activeAt?a.activeAt>b.activeAt?-1:1:a.activeAt&&!b.activeAt?-1:1}))}COMMANDS.set("uuidEndsWith",(function(conversations,query){return conversations.filter((function(convo){var _convo$uuid;return null===(_convo$uuid=convo.uuid)||void 0===_convo$uuid?void 0:_convo$uuid.endsWith(query)}))})),COMMANDS.set("idEndsWith",(function(conversations,query){return conversations.filter((function(convo){var _convo$id;return null===(_convo$id=convo.id)||void 0===_convo$id?void 0:_convo$id.endsWith(query)}))})),COMMANDS.set("e164EndsWith",(function(conversations,query){return conversations.filter((function(convo){var _convo$e;return null===(_convo$e=convo.e164)||void 0===_convo$e?void 0:_convo$e.endsWith(query)}))})),COMMANDS.set("groupIdEndsWith",(function(conversations,query){return conversations.filter((function(convo){var _convo$groupId;return null===(_convo$groupId=convo.groupId)||void 0===_convo$groupId?void 0:_convo$groupId.endsWith(query)}))}))},"./ts/util/libphonenumberInstance.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M9:()=>PhoneNumberFormat,eE:()=>instance,i9:()=>parseAndFormatPhoneNumber});var google_libphonenumber__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/google-libphonenumber/dist/libphonenumber.js"),google_libphonenumber__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(google_libphonenumber__WEBPACK_IMPORTED_MODULE_0__),instance=google_libphonenumber__WEBPACK_IMPORTED_MODULE_0___default().PhoneNumberUtil.getInstance(),PhoneNumberFormat=google_libphonenumber__WEBPACK_IMPORTED_MODULE_0___default().PhoneNumberFormat;function parseAndFormatPhoneNumber(str,regionCode){var result,format=arguments.length>2&&void 0!==arguments[2]?arguments[2]:PhoneNumberFormat.E164;try{result=instance.parse(str,regionCode)}catch(err){return}return{isValid:instance.isValidNumber(result),userInput:str,e164:instance.format(result,format)}}},"./ts/util/scrollUtil.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Og:()=>scrollToBottom,bV:()=>setScrollBottom,rA:()=>getScrollBottom});var getScrollBottom=function(el){return el.scrollHeight-el.scrollTop-el.clientHeight};function setScrollBottom(el,newScrollBottom){el.scrollTop=el.scrollHeight-newScrollBottom-el.clientHeight}function scrollToBottom(el){el.scrollTop=el.scrollHeight}},"./ts/util/sleep.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function sleep(ms,abortSignal){return new Promise((function(resolve,reject){var timeout=setTimeout(resolve,ms);null==abortSignal||abortSignal.addEventListener("abort",(function(){void 0!==timeout&&(clearTimeout(timeout),timeout=void 0),reject(new Error("Aborted"))}))}))}__webpack_require__.d(__webpack_exports__,{_:()=>sleep})},"./ts/util/uuidFetchState.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>isFetchingByE164,h:()=>isFetchingByUsername});var isFetchingByUsername=function(fetchState,username){return Boolean(fetchState[`username:${username}`])},isFetchingByE164=function(fetchState,e164){return Boolean(fetchState[`e164:${e164}`])}}}]);
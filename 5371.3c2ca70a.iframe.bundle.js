"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[5371],{"./ts/components/AvatarColorPicker.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>AvatarColorPicker});__webpack_require__("./node_modules/react/index.js");var _types_Colors__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/types/Colors.ts"),_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/BetterAvatarBubble.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AvatarColorPicker(_ref){var i18n=_ref.i18n,onColorSelected=_ref.onColorSelected,selectedColor=_ref.selectedColor;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"AvatarEditor__avatar-selector-title",children:i18n("icu:AvatarColorPicker--choose")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"AvatarEditor__avatars",children:_types_Colors__WEBPACK_IMPORTED_MODULE_1__.sj.map((function(color){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__.p,{color,i18n,isSelected:selectedColor===color,onSelect:function(){onColorSelected(color)}},color)}))})]})}},"./ts/components/AvatarIconEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{J:()=>AvatarIconEditor});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/AvatarColorPicker.tsx"),_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/AvatarModalButtons.tsx"),_AvatarPreview__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/AvatarPreview.tsx"),_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/util/avatarDataToBytes.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarIconEditor(_ref){var initialAvatarData=_ref.avatarData,i18n=_ref.i18n,onClose=_ref.onClose,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(),2),avatarBuffer=_useState2[0],setAvatarBuffer=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialAvatarData),2),avatarData=_useState4[0],setAvatarData=_useState4[1],onColorSelected=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(color){setAvatarData(Object.assign({},avatarData,{color}))}),[avatarData]);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var shouldCancel=!1;return async function loadAvatar(){var buffer=await(0,_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_4__.u)(avatarData);shouldCancel||setAvatarBuffer(buffer)}(),function(){shouldCancel=!0}}),[avatarData,setAvatarBuffer]);var hasChanges=avatarData!==initialAvatarData;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_AvatarPreview__WEBPACK_IMPORTED_MODULE_3__.B,{avatarColor:avatarData.color,avatarValue:avatarBuffer,conversationTitle:avatarData.text,i18n}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)("hr",{className:"AvatarEditor__divider"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_1__.n,{i18n,onColorSelected,selectedColor:avatarData.color}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_2__.T,{hasChanges,i18n,onCancel:onClose,onSave:function(){return onClose(Object.assign({},avatarData,{buffer:avatarBuffer}))}})]})}},"./ts/components/AvatarModalButtons.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>AvatarModalButtons});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Button.tsx"),_ConfirmDiscardDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ConfirmDiscardDialog.tsx"),_Modal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Modal.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarModalButtons(_ref){var hasChanges=_ref.hasChanges,i18n=_ref.i18n,onCancel=_ref.onCancel,onSave=_ref.onSave,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0),2),confirmDiscardAction=_useState2[0],setConfirmDiscardAction=_useState2[1];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_Modal__WEBPACK_IMPORTED_MODULE_3__.u_.ButtonFooter,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.zx,{onClick:function(){hasChanges?setConfirmDiscardAction((function(){return onCancel})):onCancel()},variant:_Button__WEBPACK_IMPORTED_MODULE_1__.Wu.Secondary,children:i18n("icu:cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.zx,{disabled:!hasChanges,onClick:onSave,children:i18n("icu:save")}),confirmDiscardAction&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ConfirmDiscardDialog__WEBPACK_IMPORTED_MODULE_2__.a,{i18n,onDiscard:confirmDiscardAction,onClose:function(){return setConfirmDiscardAction(void 0)}})]})}AvatarModalButtons.displayName="AvatarModalButtons"},"./ts/components/AvatarPreview.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>AvatarPreview});var noop=__webpack_require__("./node_modules/lodash/noop.js"),noop_default=__webpack_require__.n(noop),react=__webpack_require__("./node_modules/react/index.js"),log=__webpack_require__("./ts/logging/log.ts"),Spinner=__webpack_require__("./ts/components/Spinner.tsx"),Colors=__webpack_require__("./ts/types/Colors.ts"),getInitials=__webpack_require__("./ts/util/getInitials.ts"),canvasToBytes=__webpack_require__("./ts/util/canvasToBytes.ts");var ImageStatus,jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarPreview(_ref){var _ref$avatarColor=_ref.avatarColor,avatarColor=void 0===_ref$avatarColor?Colors.sj[0]:_ref$avatarColor,avatarPath=_ref.avatarPath,avatarValue=_ref.avatarValue,conversationTitle=_ref.conversationTitle,i18n=_ref.i18n,isEditable=_ref.isEditable,isGroup=_ref.isGroup,onAvatarLoaded=_ref.onAvatarLoaded,onClear=_ref.onClear,onClick=_ref.onClick,_ref$style=_ref.style,style=void 0===_ref$style?{}:_ref$style,_useState2=_slicedToArray((0,react.useState)(),2),avatarPreview=_useState2[0],setAvatarPreview=_useState2[1];(0,react.useEffect)((function(){if(isEditable){if(!avatarPath)return noop_default();var shouldCancel=!1;return async function(){try{var buffer=await async function imagePathToBytes(src){var image=new Image,canvas=document.createElement("canvas"),context=canvas.getContext("2d");if(!context)throw new Error("imagePathToArrayBuffer: could not get canvas rendering context");return image.src=src,await image.decode(),canvas.width=image.width,canvas.height=image.height,context.drawImage(image,0,0),(0,canvasToBytes.E)(canvas)}(avatarPath);if(shouldCancel)return;setAvatarPreview(buffer),null==onAvatarLoaded||onAvatarLoaded(buffer)}catch(err){if(shouldCancel)return;log.warn(`Failed to convert image URL to array buffer. Error message: ${err&&err.message}`)}}(),function(){shouldCancel=!0}}}),[avatarPath,onAvatarLoaded,isEditable]),(0,react.useEffect)((function(){setAvatarPreview(avatarValue||void 0)}),[avatarValue]);var imageStatus,encodedPath,_useState4=_slicedToArray((0,react.useState)(),2),objectUrl=_useState4[0],setObjectUrl=_useState4[1];(0,react.useEffect)((function(){if(!avatarPreview)return setObjectUrl(void 0),noop_default();var url=URL.createObjectURL(new Blob([avatarPreview]));return setObjectUrl(url),function(){URL.revokeObjectURL(url)}}),[avatarPreview]),avatarValue&&!objectUrl?imageStatus=ImageStatus.Loading:objectUrl?(encodedPath=objectUrl,imageStatus=ImageStatus.HasImage):avatarPath?(encodedPath=encodeURI(avatarPath),imageStatus=ImageStatus.HasImage):imageStatus=ImageStatus.Nothing;var isLoading=imageStatus===ImageStatus.Loading,clickProps=onClick?{role:"button",onClick,tabIndex:0,onKeyDown:function(event){"Enter"!==event.key&&" "!==event.key||onClick()}}:{},componentStyle=Object.assign({},style);return onClick&&(componentStyle.cursor="pointer"),imageStatus===ImageStatus.Nothing?(0,jsx_runtime.jsx)("div",{className:"AvatarPreview",children:(0,jsx_runtime.jsxs)("div",Object.assign({className:`AvatarPreview__avatar BetterAvatarBubble--${avatarColor}`},clickProps,{style:componentStyle,children:[isGroup?(0,jsx_runtime.jsx)("div",{className:`BetterAvatarBubble--${avatarColor}--icon AvatarPreview__group`}):(0,getInitials.Q)(conversationTitle),isEditable&&(0,jsx_runtime.jsx)("div",{className:"AvatarPreview__upload"})]}))}):(0,jsx_runtime.jsx)("div",{className:"AvatarPreview",children:(0,jsx_runtime.jsxs)("div",Object.assign({className:`AvatarPreview__avatar AvatarPreview__avatar--${imageStatus}`},clickProps,{style:imageStatus===ImageStatus.HasImage&&encodedPath?Object.assign({},componentStyle,{backgroundImage:`url('${encodedPath}')`}):componentStyle,children:[isLoading&&(0,jsx_runtime.jsx)(Spinner.$j,{size:"70px",svgSize:"normal",direction:"on-avatar"}),imageStatus===ImageStatus.HasImage&&onClear&&(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:delete"),className:"AvatarPreview__clear",onClick:onClear,tabIndex:-1,type:"button"}),isEditable&&(0,jsx_runtime.jsx)("div",{className:"AvatarPreview__upload"})]}))})}!function(ImageStatus){ImageStatus.Nothing="nothing",ImageStatus.Loading="loading",ImageStatus.HasImage="has-image"}(ImageStatus||(ImageStatus={})),AvatarPreview.displayName="AvatarPreview"},"./ts/components/BetterAvatarBubble.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{p:()=>BetterAvatarBubble});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BetterAvatarBubble(_ref){var children=_ref.children,color=_ref.color,i18n=_ref.i18n,isSelected=_ref.isSelected,onDelete=_ref.onDelete,onSelect=_ref.onSelect,style=_ref.style;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()({BetterAvatarBubble:!0,"BetterAvatarBubble--selected":isSelected},color&&`BetterAvatarBubble--${color}`),onKeyDown:function(ev){"Enter"===ev.key&&onSelect()},onClick:onSelect,role:"button",style,tabIndex:0,children:[onDelete&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("button",{"aria-label":i18n("icu:delete"),className:"BetterAvatarBubble__delete",onClick:onDelete,tabIndex:-1,type:"button"}),children]})}BetterAvatarBubble.displayName="BetterAvatarBubble"},"./ts/components/ConfirmDiscardDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>ConfirmDiscardDialog});__webpack_require__("./node_modules/react/index.js");var _ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConfirmDiscardDialog(_ref){var i18n=_ref.i18n,onClose=_ref.onClose,onDiscard=_ref.onDiscard;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__.U,{dialogName:"ConfirmDiscardDialog",actions:[{action:onDiscard,text:i18n("icu:discard"),style:"negative"}],i18n,onClose,children:i18n("icu:ConfirmDiscardDialog--discard")})}ConfirmDiscardDialog.displayName="ConfirmDiscardDialog"},"./ts/util/avatarDataToBytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{u:()=>avatarDataToBytes});var _types_Colors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/Colors.ts"),_canvasToBytes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/canvasToBytes.ts"),_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/avatarTextSizeCalculator.ts");function getAvatarColor(color){return _types_Colors__WEBPACK_IMPORTED_MODULE_0__.nE.get(color)||{bg:"black",fg:"white"}}function setCanvasBackground(bg,context,canvas){context.fillStyle=bg,context.fillRect(0,0,canvas.width,canvas.height)}async function drawImage(src,context,canvas){var image=new Image;image.src=src,await image.decode(),canvas.width=image.width,canvas.height=image.height,context.drawImage(image,0,0)}async function avatarDataToBytes(avatarData){var canvas=document.createElement("canvas");canvas.width=1024,canvas.height=1024;var context=canvas.getContext("2d");if(!context)throw new Error("avatarDataToBytes: could not get canvas rendering context");var _window$Signal,color=avatarData.color,icon=avatarData.icon,imagePath=avatarData.imagePath,text=avatarData.text;if(imagePath)await drawImage(null!==(_window$Signal=window.Signal)&&void 0!==_window$Signal&&_window$Signal.Migrations?window.Signal.Migrations.getAbsoluteAvatarPath(imagePath):imagePath,context,canvas);else if(color&&text){var _getAvatarColor=getAvatarColor(color),bg=_getAvatarColor.bg,fg=_getAvatarColor.fg,textToWrite=text.toLocaleUpperCase();setCanvasBackground(bg,context,canvas),context.fillStyle=fg;var font=await async function getFont(text){var font=new window.FontFace("Inter",'url("fonts/inter-v3.19/Inter-Regular.woff2")');await font.load();var measurerCanvas=document.createElement("canvas");measurerCanvas.width=1024,measurerCanvas.height=1024;var measurerContext=measurerCanvas.getContext("2d");if(!measurerContext)throw new Error("getFont: could not get canvas rendering context");return`${(0,_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_2__.Z)(1024,text,(function(candidateFontSize){var candidateFont=`${candidateFontSize}px Inter`;measurerContext.font=candidateFont;var _measurerContext$meas=measurerContext.measureText(text),actualBoundingBoxLeft=_measurerContext$meas.actualBoundingBoxLeft,actualBoundingBoxRight=_measurerContext$meas.actualBoundingBoxRight,actualBoundingBoxAscent=_measurerContext$meas.actualBoundingBoxAscent,actualBoundingBoxDescent=_measurerContext$meas.actualBoundingBoxDescent,width=Math.abs(actualBoundingBoxLeft)+Math.abs(actualBoundingBoxRight);return{height:Math.abs(actualBoundingBoxAscent)+Math.abs(actualBoundingBoxDescent),width}}))}px Inter`}(textToWrite);context.font=font,context.textBaseline="middle",context.textAlign="center",context.fillText(textToWrite,512,542)}else if(color&&icon){var iconPath=`images/avatars/avatar_${icon}.svg`;await drawImage(iconPath,context,canvas),context.globalCompositeOperation="destination-over",setCanvasBackground(getAvatarColor(color).bg,context,canvas)}return(0,_canvasToBytes__WEBPACK_IMPORTED_MODULE_1__.E)(canvas)}},"./ts/util/avatarTextSizeCalculator.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>getFontSizes,Z:()=>getFittedFontSize});var _components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/components/emoji/lib.ts");function getFontSizes(bubbleSize){return{diameter:Math.ceil(.75*bubbleSize),singleEmoji:Math.ceil(.6*bubbleSize),smol:Math.ceil(.05*bubbleSize),text:Math.ceil(.45*bubbleSize)}}function getFittedFontSize(bubbleSize,text,measure){var sizes=getFontSizes(bubbleSize),candidateFontSize=sizes.text;for((0,_components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__.Mz)(text)||1!==(0,_components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__.J7)(text)||(candidateFontSize=sizes.singleEmoji);candidateFontSize>=sizes.smol;candidateFontSize-=1){var _measure=measure(candidateFontSize),height=_measure.height;if(_measure.width<sizes.diameter&&height<sizes.diameter)return candidateFontSize}return candidateFontSize}},"./ts/util/canvasToBlob.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>canvasToBlob});var _types_MIME__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/MIME.ts");async function canvasToBlob(canvas){var mimeType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,quality=arguments.length>2?arguments[2]:void 0;return new Promise((function(resolve,reject){return canvas.toBlob((function(result){result?resolve(result):reject(new Error("Couldn't convert the canvas to a Blob"))}),mimeType,quality)}))}},"./ts/util/canvasToBytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>canvasToBytes});var _canvasToBlob__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/canvasToBlob.ts");async function canvasToBytes(canvas,mimeType,quality){var blob=await(0,_canvasToBlob__WEBPACK_IMPORTED_MODULE_0__._)(canvas,mimeType,quality);return new Uint8Array(await blob.arrayBuffer())}},"./ts/util/createAvatarData.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>createAvatarData});var uuid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/uuid-browser/index.js");function createAvatarData(partialAvatarData){return Object.assign({id:(0,uuid__WEBPACK_IMPORTED_MODULE_0__.v4)()},partialAvatarData)}}}]);
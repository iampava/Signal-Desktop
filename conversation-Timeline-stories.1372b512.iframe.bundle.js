"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[5870],{"./ts/components/NewlyCreatedGroupInvitedContactsDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>NewlyCreatedGroupInvitedContactsDialog});__webpack_require__("./node_modules/react/index.js");var _Intl__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Intl.tsx"),_conversation_ContactName__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),_GroupDialog__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/GroupDialog.tsx"),_util_openLinkInWebBrowser__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/util/openLinkInWebBrowser.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function NewlyCreatedGroupInvitedContactsDialog(_ref){var body,contacts=_ref.contacts,getPreferredBadge=_ref.getPreferredBadge,i18n=_ref.i18n,onClose=_ref.onClose,theme=_ref.theme;if(1===contacts.length){var contact=contacts[0];body=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W.Paragraph,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_1__.R,{i18n,id:"icu:NewlyCreatedGroupInvitedContactsDialog--body--user-paragraph--one",components:{name:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_conversation_ContactName__WEBPACK_IMPORTED_MODULE_2__.K,{title:contact.title})}})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W.Paragraph,{children:i18n("icu:NewlyCreatedGroupInvitedContactsDialog--body--info-paragraph")})]})}else body=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W.Paragraph,{children:i18n("icu:NewlyCreatedGroupInvitedContactsDialog--body--user-paragraph--many")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W.Paragraph,{children:i18n("icu:NewlyCreatedGroupInvitedContactsDialog--body--info-paragraph")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W.Contacts,{contacts,getPreferredBadge,i18n,theme})]});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_GroupDialog__WEBPACK_IMPORTED_MODULE_3__.W,{i18n,onClickPrimaryButton:onClose,primaryButtonText:i18n("icu:Confirmation--confirm"),secondaryButtonText:i18n("icu:NewlyCreatedGroupInvitedContactsDialog--body--learn-more"),onClickSecondaryButton:function(){(0,_util_openLinkInWebBrowser__WEBPACK_IMPORTED_MODULE_5__.P)("https://support.signal.org/hc/articles/360007319331-Group-chats")},onClose,title:i18n("icu:NewlyCreatedGroupInvitedContactsDialog--title",{count:contacts.length}),children:body})}NewlyCreatedGroupInvitedContactsDialog.displayName="NewlyCreatedGroupInvitedContactsDialog"},"./ts/components/SharedGroupNames.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>SharedGroupNames});var lodash_take__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/take.js"),lodash_take__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_take__WEBPACK_IMPORTED_MODULE_0__),_Intl__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./ts/components/Intl.tsx")),_UserText__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/UserText.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function SharedGroupNames(_ref){var i18n=_ref.i18n,nameClassName=_ref.nameClassName,sharedGroupNames=_ref.sharedGroupNames,firstThreeGroups=lodash_take__WEBPACK_IMPORTED_MODULE_0___default()(sharedGroupNames,3).map((function(group,i){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("strong",{className:nameClassName,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_UserText__WEBPACK_IMPORTED_MODULE_3__.a,{text:group})},i)}));if(sharedGroupNames.length>=5){var remainingCount=sharedGroupNames.length-3;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_2__.R,{i18n,id:"icu:member-of-more-than-3-groups--multiple-more",components:{group1:firstThreeGroups[0],group2:firstThreeGroups[1],group3:firstThreeGroups[2],remainingCount}})}return 4===sharedGroupNames.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_2__.R,{i18n,id:"icu:member-of-more-than-3-groups--one-more",components:{group1:firstThreeGroups[0],group2:firstThreeGroups[1],group3:firstThreeGroups[2]}}):3===firstThreeGroups.length?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_2__.R,{i18n,id:"icu:member-of-3-groups",components:{group1:firstThreeGroups[0],group2:firstThreeGroups[1],group3:firstThreeGroups[2]}}):firstThreeGroups.length>=2?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_2__.R,{i18n,id:"icu:member-of-2-groups",components:{group1:firstThreeGroups[0],group2:firstThreeGroups[1]}}):firstThreeGroups.length>=1?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_2__.R,{i18n,id:"icu:member-of-1-group",components:{group:firstThreeGroups[0]}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:i18n("icu:no-groups-in-common")})}},"./ts/components/conversation/About.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>About});__webpack_require__("./node_modules/react/index.js");var _Emojify__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/Emojify.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function About(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"module-about__text":_ref$className,text=_ref.text;return text?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className,dir:"auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_Emojify__WEBPACK_IMPORTED_MODULE_1__.u,{text:text||""})}):null}About.displayName="About"},"./ts/components/conversation/ContactSpoofingReviewDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>ContactSpoofingReviewDialog});var orderBy=__webpack_require__("./node_modules/lodash/orderBy.js"),orderBy_default=__webpack_require__.n(orderBy),concat=__webpack_require__("./node_modules/lodash/concat.js"),concat_default=__webpack_require__.n(concat),react=__webpack_require__("./node_modules/react/index.js"),MessageRequestActionsConfirmation=__webpack_require__("./ts/components/conversation/MessageRequestActionsConfirmation.tsx"),contactSpoofing=__webpack_require__("./ts/util/contactSpoofing.ts"),Modal=__webpack_require__("./ts/components/Modal.tsx"),RemoveGroupMemberConfirmationDialog=__webpack_require__("./ts/components/conversation/RemoveGroupMemberConfirmationDialog.tsx"),assert=__webpack_require__("./ts/util/assert.ts"),Avatar=__webpack_require__("./ts/components/Avatar.tsx"),ContactName=__webpack_require__("./ts/components/conversation/ContactName.tsx"),SharedGroupNames=__webpack_require__("./ts/components/SharedGroupNames.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function ContactSpoofingReviewDialogPerson(_ref){var children=_ref.children,conversation=_ref.conversation,getPreferredBadge=_ref.getPreferredBadge,i18n=_ref.i18n,onClick=_ref.onClick,theme=_ref.theme;(0,assert.q8)("direct"===conversation.type,"<ContactSpoofingReviewDialogPerson> expected a direct conversation");var contents=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Avatar.qE,Object.assign({},conversation,{badge:getPreferredBadge(conversation.badges),conversationType:conversation.type,size:Avatar.DZ.FORTY_EIGHT,className:"module-ContactSpoofingReviewDialogPerson__avatar",i18n,theme})),(0,jsx_runtime.jsxs)("div",{className:"module-ContactSpoofingReviewDialogPerson__info",children:[(0,jsx_runtime.jsx)(ContactName.K,{module:"module-ContactSpoofingReviewDialogPerson__info__contact-name",title:conversation.title}),conversation.phoneNumber?(0,jsx_runtime.jsx)("div",{className:"module-ContactSpoofingReviewDialogPerson__info__property",children:conversation.phoneNumber}):null,(0,jsx_runtime.jsx)("div",{className:"module-ContactSpoofingReviewDialogPerson__info__property",children:(0,jsx_runtime.jsx)(SharedGroupNames.S,{i18n,sharedGroupNames:conversation.sharedGroupNames||[]})}),children]})]});return onClick?(0,jsx_runtime.jsx)("button",{type:"button",className:"module-ContactSpoofingReviewDialogPerson",onClick,children:contents}):(0,jsx_runtime.jsx)("div",{className:"module-ContactSpoofingReviewDialogPerson",children:contents})}ContactSpoofingReviewDialogPerson.displayName="ContactSpoofingReviewDialogPerson";var ConfirmationStateType,Button=__webpack_require__("./ts/components/Button.tsx"),Intl=__webpack_require__("./ts/components/Intl.tsx"),missingCaseError=__webpack_require__("./ts/util/missingCaseError.ts"),isInSystemContacts=__webpack_require__("./ts/util/isInSystemContacts.ts"),UserText=__webpack_require__("./ts/components/UserText.tsx");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ContactSpoofingReviewDialog(props){var title,contents,acceptConversation=props.acceptConversation,blockAndReportSpam=props.blockAndReportSpam,blockConversation=props.blockConversation,conversationId=props.conversationId,deleteConversation=props.deleteConversation,getPreferredBadge=props.getPreferredBadge,i18n=props.i18n,onClose=props.onClose,showContactModal=props.showContactModal,removeMember=props.removeMember,theme=props.theme,_useState2=_slicedToArray((0,react.useState)(),2),confirmationState=_useState2[0],setConfirmationState=_useState2[1];if(confirmationState){var type=confirmationState.type,affectedConversation=confirmationState.affectedConversation;switch(type){case ConfirmationStateType.ConfirmingDelete:case ConfirmationStateType.ConfirmingBlock:return(0,jsx_runtime.jsx)(MessageRequestActionsConfirmation.D,{acceptConversation,blockAndReportSpam,blockConversation,conversationId:affectedConversation.id,conversationType:"direct",deleteConversation,i18n,title:affectedConversation.title,state:type===ConfirmationStateType.ConfirmingDelete?MessageRequestActionsConfirmation.L.deleting:MessageRequestActionsConfirmation.L.blocking,onChangeState:function(messageRequestState){switch(messageRequestState){case MessageRequestActionsConfirmation.L.blocking:setConfirmationState({type:ConfirmationStateType.ConfirmingBlock,affectedConversation});break;case MessageRequestActionsConfirmation.L.deleting:setConfirmationState({type:ConfirmationStateType.ConfirmingDelete,affectedConversation});break;case MessageRequestActionsConfirmation.L.unblocking:(0,assert.q8)(!1,"Got unexpected MessageRequestState.unblocking state. Clearing confiration state"),setConfirmationState(void 0);break;case MessageRequestActionsConfirmation.L.default:setConfirmationState(void 0);break;default:throw(0,missingCaseError.b)(messageRequestState)}}});case ConfirmationStateType.ConfirmingGroupRemoval:var group=confirmationState.group;return(0,jsx_runtime.jsx)(RemoveGroupMemberConfirmationDialog.m,{conversation:affectedConversation,group,i18n,onClose:function(){setConfirmationState(void 0)},onRemove:function(){removeMember(conversationId,affectedConversation.id)}});default:throw(0,missingCaseError.b)(type)}}switch(props.type){case contactSpoofing.K.DirectConversationWithSameTitle:var possiblyUnsafeConversation=props.possiblyUnsafeConversation,safeConversation=props.safeConversation;(0,assert.q8)("direct"===possiblyUnsafeConversation.type,'<ContactSpoofingReviewDialog> expected a direct conversation for the "possibly unsafe" conversation'),(0,assert.q8)("direct"===safeConversation.type,'<ContactSpoofingReviewDialog> expected a direct conversation for the "safe" conversation'),title=i18n("icu:ContactSpoofingReviewDialog__title"),contents=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{children:i18n("icu:ContactSpoofingReviewDialog__description")}),(0,jsx_runtime.jsx)("h2",{children:i18n("icu:ContactSpoofingReviewDialog__possibly-unsafe-title")}),(0,jsx_runtime.jsx)(ContactSpoofingReviewDialogPerson,{conversation:possiblyUnsafeConversation,getPreferredBadge,i18n,theme,children:(0,jsx_runtime.jsxs)("div",{className:"module-ContactSpoofingReviewDialog__buttons",children:[(0,jsx_runtime.jsx)(Button.zx,{variant:Button.Wu.SecondaryDestructive,onClick:function(){setConfirmationState({type:ConfirmationStateType.ConfirmingDelete,affectedConversation:possiblyUnsafeConversation})},children:i18n("icu:MessageRequests--delete")}),(0,jsx_runtime.jsx)(Button.zx,{variant:Button.Wu.SecondaryDestructive,onClick:function(){setConfirmationState({type:ConfirmationStateType.ConfirmingBlock,affectedConversation:possiblyUnsafeConversation})},children:i18n("icu:MessageRequests--block")})]})}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsx)("h2",{children:i18n("icu:ContactSpoofingReviewDialog__safe-title")}),(0,jsx_runtime.jsx)(ContactSpoofingReviewDialogPerson,{conversation:safeConversation,getPreferredBadge,i18n,onClick:function(){showContactModal(safeConversation.id)},theme})]});break;case contactSpoofing.K.MultipleGroupMembersWithSameTitle:var _group=props.group,collisionInfoByTitle=props.collisionInfoByTitle,unsortedConversationInfos=concat_default().apply(void 0,[[]].concat(_toConsumableArray(Object.values(collisionInfoByTitle)))),conversationInfos=orderBy_default()(unsortedConversationInfos,["title","id"]);title=i18n("icu:ContactSpoofingReviewDialog__group__title"),contents=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("p",{children:i18n("icu:ContactSpoofingReviewDialog__group__description",{count:conversationInfos.length})}),(0,jsx_runtime.jsx)("h2",{children:i18n("icu:ContactSpoofingReviewDialog__group__members-header")}),conversationInfos.map((function(conversationInfo,index){var button;_group.areWeAdmin?button=(0,jsx_runtime.jsx)(Button.zx,{variant:Button.Wu.SecondaryAffirmative,onClick:function(){setConfirmationState({type:ConfirmationStateType.ConfirmingGroupRemoval,affectedConversation:conversationInfo.conversation,group:_group})},children:i18n("icu:RemoveGroupMemberConfirmation__remove-button")}):conversationInfo.conversation.isBlocked?button=(0,jsx_runtime.jsx)(Button.zx,{variant:Button.Wu.SecondaryAffirmative,onClick:function(){acceptConversation(conversationInfo.conversation.id)},children:i18n("icu:MessageRequests--unblock")}):(0,isInSystemContacts.H)(conversationInfo.conversation)||(button=(0,jsx_runtime.jsx)(Button.zx,{variant:Button.Wu.SecondaryDestructive,onClick:function(){setConfirmationState({type:ConfirmationStateType.ConfirmingBlock,affectedConversation:conversationInfo.conversation})},children:i18n("icu:MessageRequests--block")}));var callout,oldName=conversationInfo.oldName,newName=conversationInfo.conversation.profileName||conversationInfo.conversation.title;return oldName&&oldName!==newName&&(callout=(0,jsx_runtime.jsx)("div",{className:"module-ContactSpoofingReviewDialogPerson__info__property module-ContactSpoofingReviewDialogPerson__info__property--callout",children:(0,jsx_runtime.jsx)(Intl.R,{i18n,id:"icu:ContactSpoofingReviewDialog__group__name-change-info",components:{oldName:(0,jsx_runtime.jsx)(UserText.a,{text:oldName}),newName:(0,jsx_runtime.jsx)(UserText.a,{text:newName})}})})),(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[0!==index&&(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsxs)(ContactSpoofingReviewDialogPerson,{conversation:conversationInfo.conversation,getPreferredBadge,i18n,theme,children:[callout,button&&(0,jsx_runtime.jsx)("div",{className:"module-ContactSpoofingReviewDialog__buttons",children:button})]},conversationInfo.conversation.id)]})}))]});break;default:throw(0,missingCaseError.b)(props)}return(0,jsx_runtime.jsx)(Modal.u_,{modalName:"ContactSpoofingReviewDialog",hasXButton:!0,i18n,moduleClassName:"module-ContactSpoofingReviewDialog",onClose,title,children:contents})}!function(ConfirmationStateType){ConfirmationStateType[ConfirmationStateType.ConfirmingDelete=0]="ConfirmingDelete",ConfirmationStateType[ConfirmationStateType.ConfirmingBlock=1]="ConfirmingBlock",ConfirmationStateType[ConfirmationStateType.ConfirmingGroupRemoval=2]="ConfirmingGroupRemoval"}(ConfirmationStateType||(ConfirmationStateType={})),ContactSpoofingReviewDialog.displayName="ContactSpoofingReviewDialog"},"./ts/components/conversation/ConversationHero.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>ConversationHero});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Avatar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Avatar.tsx"),_ContactName__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),_About__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/About.tsx"),_GroupDescription__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/conversation/GroupDescription.tsx"),_SharedGroupNames__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/SharedGroupNames.tsx"),_types_Stories__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/types/Stories.ts"),_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),_Button__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/components/Button.tsx"),_util_shouldBlurAvatar__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./ts/util/shouldBlurAvatar.ts"),_util_openLinkInWebBrowser__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./ts/util/openLinkInWebBrowser.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var renderMembershipRow=function(_ref){var acceptedMessageRequest=_ref.acceptedMessageRequest,conversationType=_ref.conversationType,i18n=_ref.i18n,isMe=_ref.isMe,onClickMessageRequestWarning=_ref.onClickMessageRequestWarning,phoneNumber=_ref.phoneNumber,sharedGroupNames=_ref.sharedGroupNames,className="module-conversation-hero__membership";return"direct"!==conversationType?null:isMe?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className,children:i18n("icu:noteToSelfHero")}):sharedGroupNames.length>0?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_SharedGroupNames__WEBPACK_IMPORTED_MODULE_5__.S,{i18n,nameClassName:`${className}__name`,sharedGroupNames})}):acceptedMessageRequest?phoneNumber?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className,children:i18n("icu:no-groups-in-common")}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"module-conversation-hero__message-request-warning",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-conversation-hero__message-request-warning__message",children:i18n("icu:no-groups-in-common-warning")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_8__.zx,{onClick:onClickMessageRequestWarning,size:_Button__WEBPACK_IMPORTED_MODULE_8__.qE.Small,variant:_Button__WEBPACK_IMPORTED_MODULE_8__.Wu.SecondaryAffirmative,children:i18n("icu:MessageRequestWarning__learn-more")})]})};function ConversationHero(_ref2){var i18n=_ref2.i18n,about=_ref2.about,acceptedMessageRequest=_ref2.acceptedMessageRequest,avatarPath=_ref2.avatarPath,badge=_ref2.badge,color=_ref2.color,conversationType=_ref2.conversationType,groupDescription=_ref2.groupDescription,hasStories=_ref2.hasStories,id=_ref2.id,isMe=_ref2.isMe,isSignalConversation=_ref2.isSignalConversation,membersCount=_ref2.membersCount,_ref2$sharedGroupName=_ref2.sharedGroupNames,sharedGroupNames=void 0===_ref2$sharedGroupName?[]:_ref2$sharedGroupName,name=_ref2.name,phoneNumber=_ref2.phoneNumber,profileName=_ref2.profileName,theme=_ref2.theme,title=_ref2.title,unblurAvatar=_ref2.unblurAvatar,unblurredAvatarPath=_ref2.unblurredAvatarPath,updateSharedGroups=_ref2.updateSharedGroups,viewUserStories=_ref2.viewUserStories,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isShowingMessageRequestWarning=_useState2[0],setIsShowingMessageRequestWarning=_useState2[1],closeMessageRequestWarning=function(){setIsShowingMessageRequestWarning(!1)};(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){updateSharedGroups(id)}),[id,updateSharedGroups]);var avatarOnClick,avatarBlur=_Avatar__WEBPACK_IMPORTED_MODULE_1__.S7.NoBlur;(0,_util_shouldBlurAvatar__WEBPACK_IMPORTED_MODULE_10__.Y)({acceptedMessageRequest,avatarPath,isMe,sharedGroupNames,unblurredAvatarPath})?(avatarBlur=_Avatar__WEBPACK_IMPORTED_MODULE_1__.S7.BlurPictureWithClickToView,avatarOnClick=function(){return unblurAvatar(id)}):hasStories&&(avatarOnClick=function(){viewUserStories({conversationId:id,storyViewMode:_types_Stories__WEBPACK_IMPORTED_MODULE_6__.bX.User})});var phoneNumberOnly=Boolean(!name&&!profileName&&"direct"===conversationType);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:"module-conversation-hero",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Avatar__WEBPACK_IMPORTED_MODULE_1__.qE,{acceptedMessageRequest,avatarPath,badge,blur:avatarBlur,className:"module-conversation-hero__avatar",color,conversationType,i18n,isMe,noteToSelf:isMe,onClick:avatarOnClick,profileName,sharedGroupNames,size:_Avatar__WEBPACK_IMPORTED_MODULE_1__.DZ.EIGHTY,storyRing:isMe?void 0:hasStories,theme,title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("h1",{className:"module-conversation-hero__profile-name",children:[isMe?i18n("icu:noteToSelf"):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_2__.K,{isSignalConversation,title}),isMe&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("span",{className:"ContactModal__official-badge__large"})]}),about&&!isMe&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-about__container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_About__WEBPACK_IMPORTED_MODULE_3__.C,{text:about})}),isMe?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-conversation-hero__with",children:groupDescription?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_GroupDescription__WEBPACK_IMPORTED_MODULE_4__.m,{i18n,title,text:groupDescription}):null!=membersCount?i18n("icu:ConversationHero--members",{count:membersCount}):phoneNumberOnly?null:phoneNumber}),!isSignalConversation&&renderMembershipRow({acceptedMessageRequest,conversationType,i18n,isMe,onClickMessageRequestWarning:function(){setIsShowingMessageRequestWarning(!0)},phoneNumber,sharedGroupNames}),!isSignalConversation&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"module-conversation-hero__linkNotification",children:i18n("icu:messageHistoryUnsynced")})]}),isShowingMessageRequestWarning&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_7__.U,{dialogName:"ConversationHere.messageRequestWarning",i18n,onClose:closeMessageRequestWarning,actions:[{text:i18n("icu:MessageRequestWarning__dialog__learn-even-more"),action:function(){(0,_util_openLinkInWebBrowser__WEBPACK_IMPORTED_MODULE_11__.P)("https://support.signal.org/hc/articles/360007459591"),closeMessageRequestWarning()}}],children:i18n("icu:MessageRequestWarning__dialog__details")})]})}renderMembershipRow.displayName="renderMembershipRow"},"./ts/components/conversation/ErrorBoundary.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>ErrorBoundary});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_types_errors__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/types/errors.ts"),_logging_log__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/logging/log.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var CSS_MODULE="module-error-boundary-notification",ErrorBoundary=function(_React$PureComponent){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(ErrorBoundary,_React$PureComponent);var _super=_createSuper(ErrorBoundary);function ErrorBoundary(props){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ErrorBoundary),(_this=_super.call(this,props)).state={error:void 0},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(ErrorBoundary,[{key:"render",value:function render(){var error=this.state.error,_this$props=this.props,i18n=_this$props.i18n,children=_this$props.children;return error?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:CSS_MODULE,onClick:this.onClick.bind(this),onKeyDown:this.onKeyDown.bind(this),role:"button",tabIndex:0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:`${CSS_MODULE}__icon-container`,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:`${CSS_MODULE}__icon`})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:`${CSS_MODULE}__message`,children:i18n("icu:ErrorBoundaryNotification__text")})]}):children}},{key:"onClick",value:function onClick(event){event.stopPropagation(),event.preventDefault(),this.onAction()}},{key:"onKeyDown",value:function onKeyDown(event){"Enter"!==event.key&&" "!==event.key||(event.stopPropagation(),event.preventDefault(),this.onAction())}},{key:"onAction",value:function onAction(){(0,this.props.showDebugLog)()}}],[{key:"getDerivedStateFromError",value:function getDerivedStateFromError(error){return _logging_log__WEBPACK_IMPORTED_MODULE_2__.error("ErrorBoundary: captured rendering error",_types_errors__WEBPACK_IMPORTED_MODULE_1__.G(error)),{error}}}]),ErrorBoundary}(react__WEBPACK_IMPORTED_MODULE_0__.PureComponent)},"./ts/components/conversation/GroupDescription.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>GroupDescription});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Modal__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Modal.tsx"),_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/GroupDescriptionText.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function GroupDescription(_ref){var i18n=_ref.i18n,title=_ref.title,text=_ref.text,textRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),hasReadMore=_useState2[0],setHasReadMore=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),showFullDescription=_useState4[0],setShowFullDescription=_useState4[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){textRef&&textRef.current&&setHasReadMore(textRef.current.scrollHeight-5>textRef.current.clientHeight)}),[setHasReadMore,text,textRef]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[showFullDescription&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_Modal__WEBPACK_IMPORTED_MODULE_1__.u_,{modalName:"GroupDescription",hasXButton:!0,i18n,onClose:function(){return setShowFullDescription(!1)},title,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__.F,{text})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"GroupDescription__text",ref:textRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_GroupDescriptionText__WEBPACK_IMPORTED_MODULE_2__.F,{text})}),hasReadMore&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("button",{className:"GroupDescription__read-more",onClick:function(ev){ev.preventDefault(),ev.stopPropagation(),setShowFullDescription(!0)},type:"button",children:i18n("icu:GroupDescription__read-more")})]})}},"./ts/components/conversation/LastSeenIndicator.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>LastSeenIndicator});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),LastSeenIndicator=(0,react__WEBPACK_IMPORTED_MODULE_0__.forwardRef)((function LastSeenIndicatorInner(_ref,ref){var count=_ref.count,i18n=_ref.i18n,message=1===count?i18n("icu:unreadMessage"):i18n("icu:unreadMessages",{count});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("div",{className:"module-last-seen-indicator",ref,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"module-last-seen-indicator__bar",role:"separator"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{"aria-level":6,className:"module-last-seen-indicator__text",role:"heading",children:message})]})}))},"./ts/components/conversation/MessageRequestActionsConfirmation.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>MessageRequestActionsConfirmation,L:()=>MessageRequestState});__webpack_require__("./node_modules/react/index.js");var MessageRequestState,_ContactName__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),_Intl__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Intl.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MessageRequestActionsConfirmation(_ref){var acceptConversation=_ref.acceptConversation,blockAndReportSpam=_ref.blockAndReportSpam,blockConversation=_ref.blockConversation,conversationId=_ref.conversationId,conversationType=_ref.conversationType,deleteConversation=_ref.deleteConversation,i18n=_ref.i18n,onChangeState=_ref.onChangeState,state=_ref.state,title=_ref.title;return state===MessageRequestState.blocking?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"messageRequestActionsConfirmation.blocking",i18n,onClose:function(){onChangeState(MessageRequestState.default)},title:"direct"===conversationType?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:MessageRequests--block-direct-confirm-title",components:{title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{title},"name")}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:MessageRequests--block-group-confirm-title",components:{title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{title},"name")}}),actions:[].concat(_toConsumableArray("direct"===conversationType?[{text:i18n("icu:MessageRequests--block-and-report-spam"),action:function(){return blockAndReportSpam(conversationId)},style:"negative"}]:[]),[{text:i18n("icu:MessageRequests--block"),action:function(){return blockConversation(conversationId)},style:"negative"}]),children:i18n("direct"===conversationType?"icu:MessageRequests--block-direct-confirm-body":"icu:MessageRequests--block-group-confirm-body")}):state===MessageRequestState.unblocking?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"messageRequestActionsConfirmation.unblocking",i18n,onClose:function(){onChangeState(MessageRequestState.default)},title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:MessageRequests--unblock-direct-confirm-title",components:{name:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{title},"name")}}),actions:[{text:i18n("icu:MessageRequests--unblock"),action:function(){return acceptConversation(conversationId)},style:"affirmative"}],children:i18n("direct"===conversationType?"icu:MessageRequests--unblock-direct-confirm-body":"icu:MessageRequests--unblock-group-confirm-body")}):state===MessageRequestState.deleting?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"messageRequestActionsConfirmation.deleting",i18n,onClose:function(){onChangeState(MessageRequestState.default)},title:"direct"===conversationType?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:MessageRequests--delete-direct-confirm-title"}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:MessageRequests--delete-group-confirm-title",components:{title:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_1__.K,{title},"name")}}),actions:[{text:i18n("direct"===conversationType?"icu:MessageRequests--delete-direct":"icu:MessageRequests--delete-group"),action:function(){return deleteConversation(conversationId)},style:"negative"}],children:i18n("direct"===conversationType?"icu:MessageRequests--delete-direct-confirm-body":"icu:MessageRequests--delete-group-confirm-body")}):null}!function(MessageRequestState){MessageRequestState[MessageRequestState.blocking=0]="blocking",MessageRequestState[MessageRequestState.deleting=1]="deleting",MessageRequestState[MessageRequestState.unblocking=2]="unblocking",MessageRequestState[MessageRequestState.default=3]="default"}(MessageRequestState||(MessageRequestState={}))},"./ts/components/conversation/RemoveGroupMemberConfirmationDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>RemoveGroupMemberConfirmationDialog});__webpack_require__("./node_modules/react/index.js");var _groups_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/groups/util.ts"),_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),_Intl__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Intl.tsx"),_ContactName__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/conversation/ContactName.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");function RemoveGroupMemberConfirmationDialog(_ref){var conversation=_ref.conversation,group=_ref.group,i18n=_ref.i18n,onClose=_ref.onClose,onRemove=_ref.onRemove,accessControlEnabled=(0,_groups_util__WEBPACK_IMPORTED_MODULE_1__.g)(group.accessControlAddFromInviteLink),contactName=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ContactName__WEBPACK_IMPORTED_MODULE_4__.K,{title:conversation.title});return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_2__.U,{dialogName:"RemoveGroupMemberConfirmationDialog",actions:[{action:onRemove,text:i18n("icu:RemoveGroupMemberConfirmation__remove-button"),style:"negative"}],i18n,onClose,title:accessControlEnabled?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:RemoveGroupMemberConfirmation__description__with-link",components:{name:contactName}}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Intl__WEBPACK_IMPORTED_MODULE_3__.R,{i18n,id:"icu:RemoveGroupMemberConfirmation__description",components:{name:contactName}})})}RemoveGroupMemberConfirmationDialog.displayName="RemoveGroupMemberConfirmationDialog"},"./ts/components/conversation/ScrollDownButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$:()=>ScrollDownButton});__webpack_require__("./node_modules/react/index.js");var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ScrollDownButton(_ref){var badgeText,conversationId=_ref.conversationId,unreadCount=_ref.unreadCount,i18n=_ref.i18n,scrollDown=_ref.scrollDown,altText=i18n(unreadCount?"icu:messagesBelow":"icu:scrollDown");return unreadCount&&(badgeText=unreadCount<100?unreadCount.toString():"99+"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"ScrollDownButton",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)("button",{type:"button",className:"ScrollDownButton__button",onClick:function(){scrollDown(conversationId)},title:altText,children:[badgeText?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"ScrollDownButton__button__badge",children:badgeText}):null,(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("div",{className:"ScrollDownButton__button__icon"})]})})}ScrollDownButton.displayName="ScrollDownButton"},"./ts/components/conversation/Timeline.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EmptyJustHero:()=>EmptyJustHero,LastSeen:()=>LastSeen,OldestAndNewest:()=>OldestAndNewest,TargetIndexToTop:()=>TargetIndexToTop,TypingIndicator:()=>TypingIndicator,WithActiveMessageRequest:()=>WithActiveMessageRequest,WithInvitedContactsForANewlyCreatedGroup:()=>WithInvitedContactsForANewlyCreatedGroup,WithJustMiniPlayer:()=>WithJustMiniPlayer,WithSameNameInDirectConversationWarning:()=>WithSameNameInDirectConversationWarning,WithSameNameInGroupConversationWarning:()=>WithSameNameInGroupConversationWarning,WithoutNewestMessage:()=>WithoutNewestMessage,WithoutNewestMessageActiveMessageRequest:()=>WithoutNewestMessageActiveMessageRequest,WithoutOldestMessage:()=>WithoutOldestMessage,__namedExportsOrder:()=>__namedExportsOrder,default:()=>Timeline_stories});var times=__webpack_require__("./node_modules/lodash/times.js"),times_default=__webpack_require__.n(times),react=__webpack_require__("./node_modules/react/index.js"),uuid_browser=__webpack_require__("./node_modules/uuid-browser/index.js"),dist=__webpack_require__("./node_modules/@storybook/addon-knobs/dist/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),setupI18n=__webpack_require__("./ts/util/setupI18n.ts"),durations=__webpack_require__("./ts/util/durations/index.ts"),messages=__webpack_require__("./_locales/en/messages.json"),throttle=__webpack_require__("./node_modules/lodash/throttle.js"),throttle_default=__webpack_require__.n(throttle),last=__webpack_require__("./node_modules/lodash/last.js"),last_default=__webpack_require__.n(last),isNumber=__webpack_require__("./node_modules/lodash/isNumber.js"),isNumber_default=__webpack_require__.n(isNumber),get=__webpack_require__("./node_modules/lodash/get.js"),get_default=__webpack_require__.n(get),first=__webpack_require__("./node_modules/lodash/first.js"),first_default=__webpack_require__.n(first),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),index_esm=__webpack_require__("./node_modules/react-measure/dist/index.esm.js"),ScrollDownButton=__webpack_require__("./ts/components/conversation/ScrollDownButton.tsx"),assert=__webpack_require__("./ts/util/assert.ts"),util_missingCaseError=__webpack_require__("./ts/util/missingCaseError.ts"),clearTimeoutIfNecessary=__webpack_require__("./ts/util/clearTimeoutIfNecessary.ts"),_util=__webpack_require__("./ts/components/_util.ts"),ErrorBoundary=__webpack_require__("./ts/components/conversation/ErrorBoundary.tsx"),Intl=__webpack_require__("./ts/components/Intl.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),CLASS_NAME="module-TimelineWarning",ICON_CONTAINER_CLASS_NAME=`${CLASS_NAME}__icon-container`,GENERIC_ICON_CLASS_NAME=`${CLASS_NAME}__generic-icon`,TEXT_CLASS_NAME=`${CLASS_NAME}__text`,LINK_CLASS_NAME=`${TEXT_CLASS_NAME}__link`,CLOSE_BUTTON_CLASS_NAME=`${CLASS_NAME}__close-button`;function TimelineWarning(_ref){var children=_ref.children,i18n=_ref.i18n,onClose=_ref.onClose;return(0,jsx_runtime.jsxs)("div",{className:CLASS_NAME,children:[children,(0,jsx_runtime.jsx)("button",{"aria-label":i18n("icu:close"),className:CLOSE_BUTTON_CLASS_NAME,onClick:onClose,type:"button"})]})}function IconContainer(_ref2){var children=_ref2.children;return(0,jsx_runtime.jsx)("div",{className:ICON_CONTAINER_CLASS_NAME,children})}function GenericIcon(){return(0,jsx_runtime.jsx)("div",{className:GENERIC_ICON_CLASS_NAME})}function Text(_ref3){var children=_ref3.children;return(0,jsx_runtime.jsx)("div",{className:TEXT_CLASS_NAME,children})}function Link(_ref4){var children=_ref4.children,onClick=_ref4.onClick;return(0,jsx_runtime.jsx)("button",{className:LINK_CLASS_NAME,onClick,type:"button",children})}TimelineWarning.displayName="TimelineWarning",IconContainer.displayName="IconContainer",TimelineWarning.IconContainer=IconContainer,GenericIcon.displayName="GenericIcon",TimelineWarning.GenericIcon=GenericIcon,Text.displayName="Text",TimelineWarning.Text=Text,Link.displayName="Link",TimelineWarning.Link=Link;var TimelineWarnings=(0,react.forwardRef)((function TimelineWarningsInner(_ref,ref){var children=_ref.children;return(0,jsx_runtime.jsx)("div",{className:"module-TimelineWarnings",ref,children})})),NewlyCreatedGroupInvitedContactsDialog=__webpack_require__("./ts/components/NewlyCreatedGroupInvitedContactsDialog.tsx"),contactSpoofing=__webpack_require__("./ts/util/contactSpoofing.ts"),getOwn=(__webpack_require__("./node_modules/lodash/pickBy.js"),__webpack_require__("./node_modules/lodash/mapValues.js"),__webpack_require__("./ts/util/iterables.ts"),__webpack_require__("./ts/util/getOwn.ts"));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TimelineMessageLoadingState,ScrollAnchor,UnreadIndicatorPlacement,TimelineFloatingHeader=__webpack_require__("./ts/components/conversation/TimelineFloatingHeader.tsx");__webpack_require__("./ts/logging/log.ts"),__webpack_require__("./ts/util/timestamp.ts"),durations.EB;!function(TimelineMessageLoadingState){TimelineMessageLoadingState[TimelineMessageLoadingState.DoingInitialLoad=1]="DoingInitialLoad",TimelineMessageLoadingState[TimelineMessageLoadingState.LoadingOlderMessages=2]="LoadingOlderMessages",TimelineMessageLoadingState[TimelineMessageLoadingState.LoadingNewerMessages=3]="LoadingNewerMessages"}(TimelineMessageLoadingState||(TimelineMessageLoadingState={})),function(ScrollAnchor){ScrollAnchor[ScrollAnchor.ChangeNothing=0]="ChangeNothing",ScrollAnchor[ScrollAnchor.ScrollToBottom=1]="ScrollToBottom",ScrollAnchor[ScrollAnchor.ScrollToIndex=2]="ScrollToIndex",ScrollAnchor[ScrollAnchor.ScrollToUnreadIndicator=3]="ScrollToUnreadIndicator",ScrollAnchor[ScrollAnchor.Top=4]="Top",ScrollAnchor[ScrollAnchor.Bottom=5]="Bottom"}(ScrollAnchor||(ScrollAnchor={})),function(UnreadIndicatorPlacement){UnreadIndicatorPlacement[UnreadIndicatorPlacement.JustAbove=0]="JustAbove",UnreadIndicatorPlacement[UnreadIndicatorPlacement.JustBelow=1]="JustBelow"}(UnreadIndicatorPlacement||(UnreadIndicatorPlacement={}));var scrollUtil=__webpack_require__("./ts/util/scrollUtil.ts"),LastSeenIndicator=__webpack_require__("./ts/components/conversation/LastSeenIndicator.tsx");function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=Timeline_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Timeline_slicedToArray(arr,i){return function Timeline_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Timeline_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||Timeline_unsupportedIterableToArray(arr,i)||function Timeline_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Timeline_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return Timeline_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Timeline_arrayLikeToArray(o,minLen):void 0}}function Timeline_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){if(call&&("object"==typeof call||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var AT_BOTTOM_DETECTOR_STYLE={height:15},scrollToUnreadIndicator=Symbol("scrollToUnreadIndicator"),Timeline=function(_React$Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(Timeline,_React$Component);var _super=_createSuper(Timeline);function Timeline(){var _this;_classCallCheck(this,Timeline);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).containerRef=react.createRef(),_this.messagesRef=react.createRef(),_this.atBottomDetectorRef=react.createRef(),_this.lastSeenIndicatorRef=react.createRef(),_this.maxVisibleRows=Math.ceil(window.innerHeight/18),_this.state={hasRecentlyScrolled:!0,hasDismissedDirectContactSpoofingWarning:!1,lastMeasuredWarningHeight:0,widthBreakpoint:_util.Up.Wide},_this.onScroll=function(){_this.setState((function(oldState){return oldState.hasRecentlyScrolled?null:{hasRecentlyScrolled:!0}})),(0,clearTimeoutIfNecessary.S)(_this.hasRecentlyScrolledTimeout),_this.hasRecentlyScrolledTimeout=setTimeout((function(){_this.setState({hasRecentlyScrolled:!1})}),3e3)},_this.scrollToBottom=function(setFocus){var _this$props=_this.props,targetMessage=_this$props.targetMessage,id=_this$props.id,items=_this$props.items;if(setFocus&&items&&items.length>0){targetMessage(items[items.length-1],id)}else{var containerEl=_this.containerRef.current;containerEl&&(0,scrollUtil.Og)(containerEl)}},_this.onClickScrollDownButton=function(){_this.scrollDown(!1)},_this.scrollDown=function(setFocus){var _this$props2=_this.props,haveNewest=_this$props2.haveNewest,id=_this$props2.id,items=_this$props2.items,loadNewestMessages=_this$props2.loadNewestMessages,messageLoadingState=_this$props2.messageLoadingState,oldestUnseenIndex=_this$props2.oldestUnseenIndex,targetMessage=_this$props2.targetMessage,newestBottomVisibleMessageId=_this.state.newestBottomVisibleMessageId;if(items&&!(items.length<1))if(messageLoadingState)_this.scrollToBottom(setFocus);else if(newestBottomVisibleMessageId&&isNumber_default()(oldestUnseenIndex)&&items.findIndex((function(item){return item===newestBottomVisibleMessageId}))<oldestUnseenIndex)setFocus?targetMessage(items[oldestUnseenIndex],id):_this.scrollToItemIndex(oldestUnseenIndex);else if(haveNewest)_this.scrollToBottom(setFocus);else{var lastId=last_default()(items);lastId&&loadNewestMessages(id,lastId,setFocus)}},_this.markNewestBottomVisibleMessageRead=throttle_default()((function(){var _this$props3=_this.props,id=_this$props3.id,markMessageRead=_this$props3.markMessageRead,newestBottomVisibleMessageId=_this.state.newestBottomVisibleMessageId;newestBottomVisibleMessageId&&markMessageRead(id,newestBottomVisibleMessageId)}),500),_this.handleBlur=function(event){var clearTargetedMessage=_this.props.clearTargetedMessage,currentTarget=event.currentTarget;setTimeout((function(){Array.from(document.querySelectorAll("body > div:not(.inbox)")).some((function(el){return el.contains(document.activeElement)}))||currentTarget.contains(document.activeElement)||clearTargetedMessage()}),0)},_this.handleKeyDown=function(event){var _this$props4=_this.props,targetMessage=_this$props4.targetMessage,targetedMessageId=_this$props4.targetedMessageId,items=_this$props4.items,id=_this$props4.id,commandKey="darwin"===get_default()(window,"platform")&&event.metaKey,controlKey="darwin"!==get_default()(window,"platform")&&event.ctrlKey,commandOrCtrl=commandKey||controlKey;if(items&&!(items.length<1)){if(targetedMessageId&&!commandOrCtrl&&("ArrowUp"===event.key||"PageUp"===event.key)){var targetedMessageIndex=items.findIndex((function(item){return item===targetedMessageId}));if(targetedMessageIndex<0)return;var targetIndex=targetedMessageIndex-("PageUp"===event.key?10:1);if(targetIndex<0)return;return targetMessage(items[targetIndex],id),event.preventDefault(),void event.stopPropagation()}if(targetedMessageId&&!commandOrCtrl&&("ArrowDown"===event.key||"PageDown"===event.key)){var _targetedMessageIndex=items.findIndex((function(item){return item===targetedMessageId}));if(_targetedMessageIndex<0)return;var _targetIndex=_targetedMessageIndex+("PageDown"===event.key?10:1);if(_targetIndex>=items.length)return;return targetMessage(items[_targetIndex],id),event.preventDefault(),void event.stopPropagation()}if("Home"===event.key||commandOrCtrl&&"ArrowUp"===event.key){var firstMessageId=first_default()(items);firstMessageId&&(targetMessage(firstMessageId,id),event.preventDefault(),event.stopPropagation())}else("End"===event.key||commandOrCtrl&&"ArrowDown"===event.key)&&(_this.scrollDown(!0),event.preventDefault(),event.stopPropagation())}},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}(Timeline,[{key:"scrollToItemIndex",value:function scrollToItemIndex(itemIndex){var _this$messagesRef$cur,_this$messagesRef$cur2;null===(_this$messagesRef$cur=this.messagesRef.current)||void 0===_this$messagesRef$cur||null===(_this$messagesRef$cur2=_this$messagesRef$cur.querySelector(`[data-item-index="${itemIndex}"]`))||void 0===_this$messagesRef$cur2||_this$messagesRef$cur2.scrollIntoViewIfNeeded()}},{key:"isAtBottom",value:function isAtBottom(){var containerEl=this.containerRef.current;if(!containerEl)return!1;var isScrolledNearBottom=(0,scrollUtil.rA)(containerEl)<=15,hasScrollbars=containerEl.clientHeight<containerEl.scrollHeight;return isScrolledNearBottom||!hasScrollbars}},{key:"updateIntersectionObserver",value:function updateIntersectionObserver(){var _this$intersectionObs,_this2=this,containerEl=this.containerRef.current,messagesEl=this.messagesRef.current,atBottomDetectorEl=this.atBottomDetectorRef.current;if(containerEl&&messagesEl&&atBottomDetectorEl){var _this$props5=this.props,haveNewest=_this$props5.haveNewest,haveOldest=_this$props5.haveOldest,id=_this$props5.id,items=_this$props5.items,loadNewerMessages=_this$props5.loadNewerMessages,loadOlderMessages=_this$props5.loadOlderMessages,messageLoadingState=_this$props5.messageLoadingState,setIsNearBottom=_this$props5.setIsNearBottom;null===(_this$intersectionObs=this.intersectionObserver)||void 0===_this$intersectionObs||_this$intersectionObs.disconnect(),void 0!==this.intersectionObserverCallbackFrame&&window.cancelAnimationFrame(this.intersectionObserverCallbackFrame);var intersectionRatios=new Map,intersectionObserverCallback=function(entries){entries.forEach((function(entry){intersectionRatios.set(entry.target,entry.intersectionRatio)}));var oldestPartiallyVisible,newestPartiallyVisible,newestFullyVisible,_step,newestBottomVisible,newIsNearBottom=!1,_iterator=_createForOfIteratorHelper(intersectionRatios);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _ref2=Timeline_slicedToArray(_step.value,2),element=_ref2[0],intersectionRatio=_ref2[1];0!==intersectionRatio&&(element===atBottomDetectorEl?newIsNearBottom=!0:(oldestPartiallyVisible=oldestPartiallyVisible||element,newestPartiallyVisible=element,1===intersectionRatio&&(newestFullyVisible=element)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}newestFullyVisible?newestBottomVisible=newestFullyVisible:(newIsNearBottom||newestPartiallyVisible!==oldestPartiallyVisible)&&(newestBottomVisible=oldestPartiallyVisible);var oldestPartiallyVisibleMessageId=getMessageIdFromElement(oldestPartiallyVisible),newestBottomVisibleMessageId=getMessageIdFromElement(newestBottomVisible);if(_this2.setState({oldestPartiallyVisibleMessageId,newestBottomVisibleMessageId}),setIsNearBottom(id,newIsNearBottom),newestBottomVisibleMessageId){_this2.markNewestBottomVisibleMessageRead();var rowIndex=function getRowIndexFromElement(element){return element instanceof HTMLElement&&element.dataset.itemIndex?parseInt(element.dataset.itemIndex,10):void 0}(newestBottomVisible),maxRowIndex=items.length-1;!messageLoadingState&&!haveNewest&&isNumber_default()(rowIndex)&&maxRowIndex>=0&&rowIndex>=maxRowIndex-5&&loadNewerMessages(id,newestBottomVisibleMessageId)}messageLoadingState||haveOldest||!oldestPartiallyVisibleMessageId||oldestPartiallyVisibleMessageId!==items[0]||loadOlderMessages(id,oldestPartiallyVisibleMessageId)};this.intersectionObserver=new IntersectionObserver((function(entries,observer){(0,assert.q8)(_this2.intersectionObserver===observer,"observer.disconnect() should prevent callbacks from firing"),_this2.intersectionObserverCallbackFrame=window.requestAnimationFrame((function(){_this2.intersectionObserver===observer&&intersectionObserverCallback(entries)}))}),{root:containerEl,threshold:[0,1]});var _step2,_iterator2=_createForOfIteratorHelper(messagesEl.children);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var child=_step2.value;child.dataset.messageId&&this.intersectionObserver.observe(child)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.intersectionObserver.observe(atBottomDetectorEl)}}},{key:"componentDidMount",value:function componentDidMount(){var _this3=this,containerEl=this.containerRef.current,messagesEl=this.messagesRef.current,isConversationSelected=this.props.isConversationSelected;(0,assert.Yj)(containerEl&&messagesEl||!isConversationSelected,"<Timeline> mounted without some refs"),this.updateIntersectionObserver(),window.SignalContext.activeWindowService.registerForActive(this.markNewestBottomVisibleMessageRead),this.delayedPeekTimeout=setTimeout((function(){var _this3$props=_this3.props,id=_this3$props.id,peekGroupCallForTheFirstTime=_this3$props.peekGroupCallForTheFirstTime;_this3.delayedPeekTimeout=void 0,peekGroupCallForTheFirstTime(id)}),500),this.peekInterval=setInterval((function(){var _this3$props2=_this3.props,id=_this3$props2.id;(0,_this3$props2.peekGroupCallIfItHasMembers)(id)}),durations.EB)}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this$intersectionObs2,delayedPeekTimeout=this.delayedPeekTimeout,peekInterval=this.peekInterval;window.SignalContext.activeWindowService.unregisterForActive(this.markNewestBottomVisibleMessageRead),null===(_this$intersectionObs2=this.intersectionObserver)||void 0===_this$intersectionObs2||_this$intersectionObs2.disconnect(),(0,clearTimeoutIfNecessary.S)(delayedPeekTimeout),peekInterval&&clearInterval(peekInterval)}},{key:"getSnapshotBeforeUpdate",value:function getSnapshotBeforeUpdate(prevProps){var containerEl=this.containerRef.current;if(!containerEl)return null;var props=this.props,scrollToIndex=props.scrollToIndex,scrollAnchor=function getScrollAnchorBeforeUpdate(prevProps,props,isAtBottom){if(props.messageLoadingState||!props.items.length)return ScrollAnchor.ChangeNothing;var loadingStateThatJustFinished=!props.messageLoadingState&&prevProps.messageLoadingState?prevProps.messageLoadingState:void 0;if(isNumber_default()(props.scrollToIndex)&&(loadingStateThatJustFinished===TimelineMessageLoadingState.DoingInitialLoad||prevProps.scrollToIndex!==props.scrollToIndex||prevProps.scrollToIndexCounter!==props.scrollToIndexCounter))return ScrollAnchor.ScrollToIndex;switch(loadingStateThatJustFinished){case TimelineMessageLoadingState.DoingInitialLoad:return props.isIncomingMessageRequest?ScrollAnchor.ChangeNothing:isNumber_default()(props.oldestUnseenIndex)?ScrollAnchor.ScrollToUnreadIndicator:ScrollAnchor.ScrollToBottom;case TimelineMessageLoadingState.LoadingOlderMessages:return ScrollAnchor.Bottom;case TimelineMessageLoadingState.LoadingNewerMessages:return ScrollAnchor.Top;case void 0:if((prevProps.items.length!==props.items.length||props.haveNewest&&prevProps.isSomeoneTyping!==props.isSomeoneTyping)&&isAtBottom)return ScrollAnchor.ScrollToBottom;break;default:throw(0,util_missingCaseError.b)(loadingStateThatJustFinished)}return ScrollAnchor.ChangeNothing}(prevProps,props,this.isAtBottom());switch(scrollAnchor){case ScrollAnchor.ChangeNothing:return null;case ScrollAnchor.ScrollToBottom:return{scrollBottom:0};case ScrollAnchor.ScrollToIndex:return void 0===scrollToIndex?((0,assert.q8)(!1,'<Timeline> got "scroll to index" scroll anchor, but no index'),null):{scrollToIndex};case ScrollAnchor.ScrollToUnreadIndicator:return scrollToUnreadIndicator;case ScrollAnchor.Top:return{scrollTop:containerEl.scrollTop};case ScrollAnchor.Bottom:return{scrollBottom:(0,scrollUtil.rA)(containerEl)};default:throw(0,util_missingCaseError.b)(scrollAnchor)}}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,_prevState,snapshot){var oldItems=prevProps.items,previousMessageChangeCounter=prevProps.messageChangeCounter,previousMessageLoadingState=prevProps.messageLoadingState,_this$props6=this.props,discardMessages=_this$props6.discardMessages,id=_this$props6.id,newItems=_this$props6.items,messageChangeCounter=_this$props6.messageChangeCounter,messageLoadingState=_this$props6.messageLoadingState,containerEl=this.containerRef.current;if(containerEl&&snapshot)if(snapshot===scrollToUnreadIndicator){var lastSeenIndicatorEl=this.lastSeenIndicatorRef.current;lastSeenIndicatorEl?lastSeenIndicatorEl.scrollIntoView():((0,scrollUtil.Og)(containerEl),(0,assert.q8)(!1,"<Timeline> expected a last seen indicator but it was not found"))}else"scrollToIndex"in snapshot?this.scrollToItemIndex(snapshot.scrollToIndex):"scrollTop"in snapshot?containerEl.scrollTop=snapshot.scrollTop:(0,scrollUtil.bV)(containerEl,snapshot.scrollBottom);if(oldItems.length!==newItems.length){this.updateIntersectionObserver();var numberToKeepAtBottom=2*this.maxVisibleRows;this.isAtBottom()&&newItems.length>numberToKeepAtBottom&&discardMessages({conversationId:id,numberToKeepAtBottom});var loadingStateThatJustFinished=!messageLoadingState&&previousMessageLoadingState?previousMessageLoadingState:void 0,numberToKeepAtTop=5*this.maxVisibleRows;!this.isAtBottom()&&loadingStateThatJustFinished===TimelineMessageLoadingState.LoadingOlderMessages&&newItems.length>numberToKeepAtTop&&discardMessages({conversationId:id,numberToKeepAtTop})}previousMessageChangeCounter!==messageChangeCounter&&this.markNewestBottomVisibleMessageRead()}},{key:"render",value:function render(){var _this4=this,_this$props7=this.props,acknowledgeGroupMemberNameCollisions=_this$props7.acknowledgeGroupMemberNameCollisions,clearInvitedUuidsForNewlyCreatedGroup=_this$props7.clearInvitedUuidsForNewlyCreatedGroup,closeContactSpoofingReview=_this$props7.closeContactSpoofingReview,contactSpoofingReview=_this$props7.contactSpoofingReview,getPreferredBadge=_this$props7.getPreferredBadge,getTimestampForMessage=_this$props7.getTimestampForMessage,haveNewest=_this$props7.haveNewest,haveOldest=_this$props7.haveOldest,i18n=_this$props7.i18n,id=_this$props7.id,invitedContactsForNewlyCreatedGroup=_this$props7.invitedContactsForNewlyCreatedGroup,isConversationSelected=_this$props7.isConversationSelected,isGroupV1AndDisabled=_this$props7.isGroupV1AndDisabled,isSomeoneTyping=_this$props7.isSomeoneTyping,items=_this$props7.items,messageLoadingState=_this$props7.messageLoadingState,oldestUnseenIndex=_this$props7.oldestUnseenIndex,renderContactSpoofingReviewDialog=_this$props7.renderContactSpoofingReviewDialog,renderHeroRow=_this$props7.renderHeroRow,renderItem=_this$props7.renderItem,renderMiniPlayer=_this$props7.renderMiniPlayer,renderTypingBubble=_this$props7.renderTypingBubble,reviewGroupMemberNameCollision=_this$props7.reviewGroupMemberNameCollision,reviewMessageRequestNameCollision=_this$props7.reviewMessageRequestNameCollision,shouldShowMiniPlayer=_this$props7.shouldShowMiniPlayer,theme=_this$props7.theme,totalUnseen=_this$props7.totalUnseen,unreadCount=_this$props7.unreadCount,_this$state=this.state,hasRecentlyScrolled=_this$state.hasRecentlyScrolled,lastMeasuredWarningHeight=_this$state.lastMeasuredWarningHeight,newestBottomVisibleMessageId=_this$state.newestBottomVisibleMessageId,oldestPartiallyVisibleMessageId=_this$state.oldestPartiallyVisibleMessageId,widthBreakpoint=_this$state.widthBreakpoint;if(!isConversationSelected)return null;var floatingHeader,areThereAnyMessages=items.length>0,areAnyMessagesUnread=Boolean(unreadCount),areAnyMessagesBelowCurrentPosition=!haveNewest||Boolean(newestBottomVisibleMessageId&&newestBottomVisibleMessageId!==last_default()(items)),areSomeMessagesBelowCurrentPosition=!haveNewest||newestBottomVisibleMessageId&&!items.slice(-8).includes(newestBottomVisibleMessageId),areUnreadBelowCurrentPosition=Boolean(areThereAnyMessages&&areAnyMessagesUnread&&areAnyMessagesBelowCurrentPosition),shouldShowScrollDownButton=Boolean(areThereAnyMessages&&(areUnreadBelowCurrentPosition||areSomeMessagesBelowCurrentPosition)),oldestPartiallyVisibleMessageTimestamp=oldestPartiallyVisibleMessageId?getTimestampForMessage(oldestPartiallyVisibleMessageId):void 0;if(oldestPartiallyVisibleMessageId&&oldestPartiallyVisibleMessageTimestamp){var isLoadingMessages=Boolean(messageLoadingState);floatingHeader=(0,jsx_runtime.jsx)(TimelineFloatingHeader.g,{i18n,isLoading:isLoadingMessages,style:lastMeasuredWarningHeight?{marginTop:lastMeasuredWarningHeight}:void 0,timestamp:oldestPartiallyVisibleMessageTimestamp,visible:(hasRecentlyScrolled||isLoadingMessages)&&(!haveOldest||oldestPartiallyVisibleMessageId!==items[0])})}for(var messageNodes=[],itemIndex=0;itemIndex<items.length;itemIndex+=1){var nextItemIndex=itemIndex+1,previousMessageId=items[itemIndex-1],nextMessageId=items[nextItemIndex],_messageId4=items[itemIndex];if(_messageId4){var unreadIndicatorPlacement=void 0;oldestUnseenIndex===itemIndex?(unreadIndicatorPlacement=UnreadIndicatorPlacement.JustAbove,messageNodes.push((0,jsx_runtime.jsx)(LastSeenIndicator.N,{count:totalUnseen,i18n,ref:this.lastSeenIndicatorRef},"last seen indicator"))):oldestUnseenIndex===nextItemIndex&&(unreadIndicatorPlacement=UnreadIndicatorPlacement.JustBelow),messageNodes.push((0,jsx_runtime.jsx)("div",{"data-item-index":itemIndex,"data-message-id":_messageId4,role:"listitem",children:(0,jsx_runtime.jsx)(ErrorBoundary.S,{i18n,showDebugLog,children:renderItem({containerElementRef:this.containerRef,containerWidthBreakpoint:widthBreakpoint,conversationId:id,isOldestTimelineItem:haveOldest&&0===itemIndex,messageId:_messageId4,nextMessageId,previousMessageId,unreadIndicatorPlacement})})},_messageId4))}else(0,assert.q8)(!1,"<Timeline> iterated through items and got an empty message ID")}var headerElements,contactSpoofingReviewDialog,warning=Timeline.getWarning(this.props,this.state);if(warning||shouldShowMiniPlayer){var text,onClose;if(warning)switch(warning.type){case contactSpoofing.K.DirectConversationWithSameTitle:text=(0,jsx_runtime.jsx)(Intl.R,{i18n,id:"icu:ContactSpoofing__same-name--link",components:{reviewRequestLink:function(parts){return(0,jsx_runtime.jsx)(TimelineWarning.Link,{onClick:function(){reviewMessageRequestNameCollision({safeConversationId:warning.safeConversation.id})},children:parts})}}}),onClose=function(){_this4.setState({hasDismissedDirectContactSpoofingWarning:!0})};break;case contactSpoofing.K.MultipleGroupMembersWithSameTitle:var _groupNameCollisions=warning.groupNameCollisions;text=(0,jsx_runtime.jsx)(Intl.R,{i18n,id:"icu:ContactSpoofing__same-name-in-group--link",components:{count:Object.values(_groupNameCollisions).reduce((function(result,conversations){return result+conversations.length}),0),reviewRequestLink:function(parts){return(0,jsx_runtime.jsx)(TimelineWarning.Link,{onClick:function(){reviewGroupMemberNameCollision(id)},children:parts})}}}),onClose=function(){acknowledgeGroupMemberNameCollisions(id,_groupNameCollisions)};break;default:throw(0,util_missingCaseError.b)(warning)}headerElements=(0,jsx_runtime.jsx)(index_esm.Z,{bounds:!0,onResize:function(_ref3){var bounds=_ref3.bounds;bounds?_this4.setState({lastMeasuredWarningHeight:bounds.height}):(0,assert.q8)(!1,"We should be measuring the bounds")},children:function(_ref4){var measureRef=_ref4.measureRef;return(0,jsx_runtime.jsxs)(TimelineWarnings,{ref:measureRef,children:[renderMiniPlayer({shouldFlow:!0}),text&&(0,jsx_runtime.jsxs)(TimelineWarning,{i18n,onClose,children:[(0,jsx_runtime.jsx)(TimelineWarning.IconContainer,{children:(0,jsx_runtime.jsx)(TimelineWarning.GenericIcon,{})}),(0,jsx_runtime.jsx)(TimelineWarning.Text,{children:text})]})]})}})}if(contactSpoofingReview){var commonProps={conversationId:id,onClose:closeContactSpoofingReview};switch(contactSpoofingReview.type){case contactSpoofing.K.DirectConversationWithSameTitle:contactSpoofingReviewDialog=renderContactSpoofingReviewDialog(Object.assign({},commonProps,{type:contactSpoofing.K.DirectConversationWithSameTitle,possiblyUnsafeConversation:contactSpoofingReview.possiblyUnsafeConversation,safeConversation:contactSpoofingReview.safeConversation}));break;case contactSpoofing.K.MultipleGroupMembersWithSameTitle:contactSpoofingReviewDialog=renderContactSpoofingReviewDialog(Object.assign({},commonProps,{type:contactSpoofing.K.MultipleGroupMembersWithSameTitle,groupConversationId:id,collisionInfoByTitle:contactSpoofingReview.collisionInfoByTitle}));break;default:throw(0,util_missingCaseError.b)(contactSpoofingReview)}}return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(index_esm.Z,{bounds:!0,onResize:function(_ref5){var width,bounds=_ref5.bounds,isNearBottom=_this4.props.isNearBottom;(0,assert.Yj)(bounds,"We should be measuring the bounds"),_this4.setState({widthBreakpoint:(width=bounds.width,width>606?_util.Up.Wide:width>514?_util.Up.Medium:_util.Up.Narrow)}),_this4.maxVisibleRows=Math.ceil(bounds.height/18);var containerEl=_this4.containerRef.current;containerEl&&isNearBottom&&(0,scrollUtil.Og)(containerEl)},children:function(_ref6){var measureRef=_ref6.measureRef;return(0,jsx_runtime.jsxs)("div",{className:classnames_default()("module-timeline",isGroupV1AndDisabled?"module-timeline--disabled":null,`module-timeline--width-${widthBreakpoint}`),role:"presentation",tabIndex:-1,onBlur:_this4.handleBlur,onKeyDown:_this4.handleKeyDown,ref:measureRef,children:[headerElements,floatingHeader,(0,jsx_runtime.jsx)("main",{className:"module-timeline__messages__container",onScroll:_this4.onScroll,ref:_this4.containerRef,children:(0,jsx_runtime.jsxs)("div",{className:classnames_default()("module-timeline__messages",haveNewest&&"module-timeline__messages--have-newest",haveOldest&&"module-timeline__messages--have-oldest"),ref:_this4.messagesRef,role:"list",children:[haveOldest&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Timeline.getWarning(_this4.props,_this4.state)&&(0,jsx_runtime.jsx)("div",{style:{height:lastMeasuredWarningHeight}}),renderHeroRow(id)]}),messageNodes,isSomeoneTyping&&haveNewest&&renderTypingBubble(id),(0,jsx_runtime.jsx)("div",{className:"module-timeline__messages__at-bottom-detector",ref:_this4.atBottomDetectorRef,style:AT_BOTTOM_DETECTOR_STYLE})]})}),shouldShowScrollDownButton?(0,jsx_runtime.jsx)(ScrollDownButton.$,{conversationId:id,unreadCount:areUnreadBelowCurrentPosition?unreadCount:0,scrollDown:_this4.onClickScrollDownButton,i18n}):null]})}}),Boolean(invitedContactsForNewlyCreatedGroup.length)&&(0,jsx_runtime.jsx)(NewlyCreatedGroupInvitedContactsDialog.n,{contacts:invitedContactsForNewlyCreatedGroup,getPreferredBadge,i18n,onClose:clearInvitedUuidsForNewlyCreatedGroup,theme}),contactSpoofingReviewDialog]})}}],[{key:"getWarning",value:function getWarning(_ref7,state){var previous,current,warning=_ref7.warning;if(warning)switch(warning.type){case contactSpoofing.K.DirectConversationWithSameTitle:return state.hasDismissedDirectContactSpoofingWarning?void 0:warning;case contactSpoofing.K.MultipleGroupMembersWithSameTitle:return previous=warning.acknowledgedGroupNameCollisions,current=warning.groupNameCollisions,Object.entries(current).some((function(_ref){var _ref2=_slicedToArray(_ref,2),title=_ref2[0],currentIds=_ref2[1],previousIds=new Set((0,getOwn.G)(previous,title)||[]);return currentIds.some((function(currentId){return!previousIds.has(currentId)}))}))?warning:void 0;default:throw(0,util_missingCaseError.b)(warning)}}}]),Timeline}(react.Component);function getMessageIdFromElement(element){return element instanceof HTMLElement?element.dataset.messageId:void 0}function showDebugLog(){window.IPC.showDebugLog()}var TimelineItem=__webpack_require__("./ts/components/conversation/TimelineItem.tsx"),ContactSpoofingReviewDialog=__webpack_require__("./ts/components/conversation/ContactSpoofingReviewDialog.tsx"),StorybookThemeContext=__webpack_require__("./.storybook/StorybookThemeContext.js"),ConversationHero=__webpack_require__("./ts/components/conversation/ConversationHero.tsx"),getDefaultConversation=__webpack_require__("./ts/test-both/helpers/getDefaultConversation.ts"),getRandomColor=__webpack_require__("./ts/test-both/helpers/getRandomColor.ts"),TypingBubble=__webpack_require__("./ts/components/conversation/TypingBubble.tsx"),MessageReadStatus=__webpack_require__("./ts/messages/MessageReadStatus.ts"),Util=__webpack_require__("./ts/types/Util.ts"),Message=__webpack_require__("./ts/components/conversation/Message.tsx"),Payment=__webpack_require__("./ts/types/Payment.ts"),i18n=(0,setupI18n.E5)("en",messages);const Timeline_stories={title:"Components/Conversation/Timeline"};var noop=function(){};function mockMessageTimelineItem(id,data){return{type:"message",data:Object.assign({id,author:(0,getDefaultConversation.E$)({}),canDeleteForEveryone:!1,canDownload:!0,canEditMessage:!0,canReact:!0,canReply:!0,canRetry:!0,conversationId:"conversation-id",conversationTitle:"Conversation Title",conversationType:"group",conversationColor:"crimson",direction:"incoming",status:"sent",text:"Hello there from the new world!",isBlocked:!1,isMessageRequestAccepted:!0,isSelected:!1,isSelectMode:!1,isSpoilerExpanded:!1,previews:[],readStatus:MessageReadStatus.N.Read,canRetryDeleteForEveryone:!0,textDirection:Message.m5.Default,timestamp:Date.now()},data),timestamp:Date.now()}}var items={"id-1":mockMessageTimelineItem("id-1",{author:(0,getDefaultConversation.E$)({phoneNumber:"(202) 555-2001"}),conversationColor:"forest",text:""}),"id-2":mockMessageTimelineItem("id-2",{conversationColor:"forest",direction:"incoming",text:"Hello there from the new world! http://somewhere.com"}),"id-2.5":{type:"unsupportedMessage",data:{canProcessNow:!1,contact:{id:"061d3783-5736-4145-b1a2-6b6cf1156393",isMe:!1,phoneNumber:"(202) 555-1000",profileName:"Mr. Pig",title:"Mr. Pig"}},timestamp:Date.now()},"id-3":mockMessageTimelineItem("id-3",{}),"id-4":{type:"timerNotification",data:{disabled:!1,expireTimer:durations.kC.fromHours(2),title:"It's Me",type:"fromMe"},timestamp:Date.now()},"id-5":{type:"timerNotification",data:{disabled:!1,expireTimer:durations.kC.fromHours(2),title:"(202) 555-0000",type:"fromOther"},timestamp:Date.now()},"id-6":{type:"safetyNumberNotification",data:{contact:{id:"+1202555000",title:"Mr. Fire"},isGroup:!0},timestamp:Date.now()},"id-7":{type:"verificationNotification",data:{contact:{title:"Mrs. Ice"},isLocal:!0,type:"markVerified"},timestamp:Date.now()},"id-8":{type:"groupNotification",data:{changes:[{type:"name",newName:"Squirrels and their uses"},{type:"add",contacts:[(0,getDefaultConversation.E$)({phoneNumber:"(202) 555-0002",title:"Mr. Fire"}),(0,getDefaultConversation.E$)({phoneNumber:"(202) 555-0003",title:"Ms. Water"})]}],from:(0,getDefaultConversation.E$)({phoneNumber:"(202) 555-0001",title:"Mrs. Ice",isMe:!1})},timestamp:Date.now()},"id-9":{type:"resetSessionNotification",data:null,timestamp:Date.now()},"id-10":mockMessageTimelineItem("id-10",{conversationColor:"plum",direction:"outgoing",text:""}),"id-11":mockMessageTimelineItem("id-11",{direction:"outgoing",status:"read",text:"Hello there from the new world! http://somewhere.com"}),"id-12":mockMessageTimelineItem("id-12",{direction:"outgoing",text:"Hello there from the new world! "}),"id-13":mockMessageTimelineItem("id-13",{direction:"outgoing",text:"Hello there from the new world! And this is multiple lines of text. Lines and lines and lines."}),"id-14":mockMessageTimelineItem("id-14",{direction:"outgoing",status:"read",text:"Hello there from the new world! And this is multiple lines of text. Lines and lines and lines."}),"id-15":{type:"paymentEvent",data:{event:{kind:Payment.s.ActivationRequest},sender:(0,getDefaultConversation.E$)(),conversation:(0,getDefaultConversation.E$)()},timestamp:Date.now()},"id-16":{type:"paymentEvent",data:{event:{kind:Payment.s.Activation},sender:(0,getDefaultConversation.E$)(),conversation:(0,getDefaultConversation.E$)()},timestamp:Date.now()},"id-17":{type:"paymentEvent",data:{event:{kind:Payment.s.ActivationRequest},sender:(0,getDefaultConversation.E$)({isMe:!0}),conversation:(0,getDefaultConversation.E$)()},timestamp:Date.now()},"id-18":{type:"paymentEvent",data:{event:{kind:Payment.s.Activation},sender:(0,getDefaultConversation.E$)({isMe:!0}),conversation:(0,getDefaultConversation.E$)()},timestamp:Date.now()},"id-19":mockMessageTimelineItem("id-19",{direction:"outgoing",status:"read",payment:{kind:Payment.s.Notification,note:"Thanks"}})},actions=function(){return{acknowledgeGroupMemberNameCollisions:(0,esm.action)("acknowledgeGroupMemberNameCollisions"),blockGroupLinkRequests:(0,esm.action)("blockGroupLinkRequests"),checkForAccount:(0,esm.action)("checkForAccount"),clearInvitedUuidsForNewlyCreatedGroup:(0,esm.action)("clearInvitedUuidsForNewlyCreatedGroup"),setIsNearBottom:(0,esm.action)("setIsNearBottom"),loadOlderMessages:(0,esm.action)("loadOlderMessages"),loadNewerMessages:(0,esm.action)("loadNewerMessages"),loadNewestMessages:(0,esm.action)("loadNewestMessages"),markMessageRead:(0,esm.action)("markMessageRead"),toggleSelectMessage:(0,esm.action)("toggleSelectMessage"),targetMessage:(0,esm.action)("targetMessage"),clearTargetedMessage:(0,esm.action)("clearTargetedMessage"),updateSharedGroups:(0,esm.action)("updateSharedGroups"),reactToMessage:(0,esm.action)("reactToMessage"),setMessageToEdit:(0,esm.action)("setMessageToEdit"),setQuoteByMessageId:(0,esm.action)("setQuoteByMessageId"),retryDeleteForEveryone:(0,esm.action)("retryDeleteForEveryone"),retryMessageSend:(0,esm.action)("retryMessageSend"),saveAttachment:(0,esm.action)("saveAttachment"),pushPanelForConversation:(0,esm.action)("pushPanelForConversation"),showContactDetail:(0,esm.action)("showContactDetail"),showContactModal:(0,esm.action)("showContactModal"),showConversation:(0,esm.action)("showConversation"),kickOffAttachmentDownload:(0,esm.action)("kickOffAttachmentDownload"),markAttachmentAsCorrupted:(0,esm.action)("markAttachmentAsCorrupted"),messageExpanded:(0,esm.action)("messageExpanded"),showSpoiler:(0,esm.action)("showSpoiler"),showLightbox:(0,esm.action)("showLightbox"),showLightboxForViewOnceMedia:(0,esm.action)("showLightboxForViewOnceMedia"),doubleCheckMissingQuoteReference:(0,esm.action)("doubleCheckMissingQuoteReference"),openGiftBadge:(0,esm.action)("openGiftBadge"),scrollToQuotedMessage:(0,esm.action)("scrollToQuotedMessage"),showExpiredIncomingTapToViewToast:(0,esm.action)("showExpiredIncomingTapToViewToast"),showExpiredOutgoingTapToViewToast:(0,esm.action)("showExpiredOutgoingTapToViewToast"),toggleDeleteMessagesModal:(0,esm.action)("toggleDeleteMessagesModal"),toggleForwardMessagesModal:(0,esm.action)("toggleForwardMessagesModal"),toggleSafetyNumberModal:(0,esm.action)("toggleSafetyNumberModal"),startCallingLobby:(0,esm.action)("startCallingLobby"),startConversation:(0,esm.action)("startConversation"),returnToActiveCall:(0,esm.action)("returnToActiveCall"),closeContactSpoofingReview:(0,esm.action)("closeContactSpoofingReview"),reviewGroupMemberNameCollision:(0,esm.action)("reviewGroupMemberNameCollision"),reviewMessageRequestNameCollision:(0,esm.action)("reviewMessageRequestNameCollision"),unblurAvatar:(0,esm.action)("unblurAvatar"),peekGroupCallForTheFirstTime:(0,esm.action)("peekGroupCallForTheFirstTime"),peekGroupCallIfItHasMembers:(0,esm.action)("peekGroupCallIfItHasMembers"),viewStory:(0,esm.action)("viewStory"),onReplyToMessage:(0,esm.action)("onReplyToMessage")}},renderItem=function(_ref){var messageId=_ref.messageId,containerElementRef=_ref.containerElementRef,containerWidthBreakpoint=_ref.containerWidthBreakpoint;return(0,jsx_runtime.jsx)(TimelineItem.j,Object.assign({getPreferredBadge:function(){},id:"",isTargeted:!1,i18n,interactionMode:"keyboard",isNextItemCallingNotification:!1,theme:Util.f8.light,platform:"darwin",containerElementRef,containerWidthBreakpoint,conversationId:"",item:items[messageId],renderAudioAttachment:function(){return(0,jsx_runtime.jsx)("div",{children:"*AudioAttachment*"})},renderContact:function(){return"*ContactName*"},renderEmojiPicker:function(){return(0,jsx_runtime.jsx)("div",{})},renderReactionPicker:function(){return(0,jsx_runtime.jsx)("div",{})},renderUniversalTimerNotification:function(){return(0,jsx_runtime.jsx)("div",{children:"*UniversalTimerNotification*"})},shouldCollapseAbove:!1,shouldCollapseBelow:!1,shouldHideMetadata:!1,shouldRenderDateHeader:!1},actions()))};renderItem.displayName="renderItem";var renderContactSpoofingReviewDialog=function(props){var sharedProps={acceptConversation:(0,esm.action)("acceptConversation"),blockAndReportSpam:(0,esm.action)("blockAndReportSpam"),blockConversation:(0,esm.action)("blockConversation"),deleteConversation:(0,esm.action)("deleteConversation"),getPreferredBadge:function(){},i18n,removeMember:(0,esm.action)("removeMember"),showContactModal:(0,esm.action)("showContactModal"),theme:Util.f8.dark};return props.type===contactSpoofing.K.MultipleGroupMembersWithSameTitle?(0,jsx_runtime.jsx)(ContactSpoofingReviewDialog.L,Object.assign({},props,sharedProps,{group:Object.assign({},(0,getDefaultConversation.E$)(),{areWeAdmin:!0})})):(0,jsx_runtime.jsx)(ContactSpoofingReviewDialog.L,Object.assign({},props,sharedProps))};renderContactSpoofingReviewDialog.displayName="renderContactSpoofingReviewDialog";var renderHeroRow=function(){function Wrapper(){var theme=react.useContext(StorybookThemeContext.x);return(0,jsx_runtime.jsx)(ConversationHero.B,{about:(0,dist.text)("about"," Free to chat"),acceptedMessageRequest:!0,avatarPath:(0,dist.text)("avatarPath","/fixtures/kitten-4-112-112.jpg"),badge:void 0,conversationType:"direct",id:(0,getDefaultConversation.E$)().id,i18n,isMe:!1,phoneNumber:(0,dist.text)("phoneNumber","+1 (808) 555-1234"),profileName:(0,dist.text)("profileName","Cayce Bollard (profile)"),sharedGroupNames:["NYC Rock Climbers","Dinner Party"],theme,title:(0,dist.text)("name","Cayce Bollard"),unblurAvatar:(0,esm.action)("unblurAvatar"),updateSharedGroups:noop,viewUserStories:(0,esm.action)("viewUserStories")})}return(0,jsx_runtime.jsx)(Wrapper,{})};renderHeroRow.displayName="renderHeroRow";var renderTypingBubble=function(){return(0,jsx_runtime.jsx)(TypingBubble.x,{acceptedMessageRequest:!0,badge:void 0,color:(0,getRandomColor.m)(),conversationType:"direct",phoneNumber:"+18005552222",i18n,isMe:!1,title:"title",theme:Util.f8.light,sharedGroupNames:[]})};renderTypingBubble.displayName="renderTypingBubble";var renderMiniPlayer=function(){return(0,jsx_runtime.jsx)("div",{children:"If active, this is where smart mini player would be"})};renderMiniPlayer.displayName="renderMiniPlayer";var useProps=function(){var overrideProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({discardMessages:(0,esm.action)("discardMessages"),getPreferredBadge:function(){},i18n,theme:react.useContext(StorybookThemeContext.x),getTimestampForMessage:Date.now,haveNewest:(0,dist.boolean)("haveNewest",!1!==overrideProps.haveNewest),haveOldest:(0,dist.boolean)("haveOldest",!1!==overrideProps.haveOldest),isConversationSelected:!0,isIncomingMessageRequest:(0,dist.boolean)("isIncomingMessageRequest",!0===overrideProps.isIncomingMessageRequest),items:overrideProps.items||Object.keys(items),messageChangeCounter:0,scrollToIndex:overrideProps.scrollToIndex,scrollToIndexCounter:0,shouldShowMiniPlayer:Boolean(overrideProps.shouldShowMiniPlayer),totalUnseen:(0,dist.number)("totalUnseen",overrideProps.totalUnseen||0),oldestUnseenIndex:(0,dist.number)("oldestUnseenIndex",overrideProps.oldestUnseenIndex||0)||void 0,invitedContactsForNewlyCreatedGroup:overrideProps.invitedContactsForNewlyCreatedGroup||[],warning:overrideProps.warning,id:(0,uuid_browser.v4)(),renderItem,renderHeroRow,renderMiniPlayer,renderTypingBubble,renderContactSpoofingReviewDialog,isSomeoneTyping:overrideProps.isSomeoneTyping||!1},actions())};function OldestAndNewest(){var props=useProps();return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithActiveMessageRequest(){var props=useProps({isIncomingMessageRequest:!0});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithoutNewestMessage(){var props=useProps({haveNewest:!1});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithoutNewestMessageActiveMessageRequest(){var props=useProps({haveOldest:!1,isIncomingMessageRequest:!0});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithoutOldestMessage(){var props=useProps({haveOldest:!1,scrollToIndex:-1});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function EmptyJustHero(){var props=useProps({items:[]});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function LastSeen(){var props=useProps({oldestUnseenIndex:13,totalUnseen:2});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function TargetIndexToTop(){var props=useProps({scrollToIndex:0});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function TypingIndicator(){var props=useProps({isSomeoneTyping:!0});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithInvitedContactsForANewlyCreatedGroup(){var props=useProps({invitedContactsForNewlyCreatedGroup:[(0,getDefaultConversation.E$)({id:"abc123",title:"John Bon Bon Jovi"}),(0,getDefaultConversation.E$)({id:"def456",title:"Bon John Bon Jovi"})]});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithSameNameInDirectConversationWarning(){var props=useProps({warning:{type:contactSpoofing.K.DirectConversationWithSameTitle,safeConversation:(0,getDefaultConversation.E$)()},items:[]});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithSameNameInGroupConversationWarning(){var props=useProps({warning:{type:contactSpoofing.K.MultipleGroupMembersWithSameTitle,acknowledgedGroupNameCollisions:{},groupNameCollisions:{Alice:times_default()(2,(function(){return(0,uuid_browser.v4)()})),Bob:times_default()(3,(function(){return(0,uuid_browser.v4)()}))}},items:[]});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}function WithJustMiniPlayer(){var props=useProps({shouldShowMiniPlayer:!0,items:[]});return(0,jsx_runtime.jsx)(Timeline,Object.assign({},props))}OldestAndNewest.displayName="OldestAndNewest",OldestAndNewest.story={name:"Oldest and Newest"},WithActiveMessageRequest.displayName="WithActiveMessageRequest",WithActiveMessageRequest.story={name:"With active message request"},WithoutNewestMessage.displayName="WithoutNewestMessage",WithoutNewestMessageActiveMessageRequest.displayName="WithoutNewestMessageActiveMessageRequest",WithoutNewestMessageActiveMessageRequest.story={name:"Without newest message, active message request"},WithoutOldestMessage.displayName="WithoutOldestMessage",EmptyJustHero.displayName="EmptyJustHero",EmptyJustHero.story={name:"Empty (just hero)"},LastSeen.displayName="LastSeen",TargetIndexToTop.displayName="TargetIndexToTop",TargetIndexToTop.story={name:"Target Index to Top"},TypingIndicator.displayName="TypingIndicator",WithInvitedContactsForANewlyCreatedGroup.displayName="WithInvitedContactsForANewlyCreatedGroup",WithInvitedContactsForANewlyCreatedGroup.story={name:"With invited contacts for a newly-created group"},WithSameNameInDirectConversationWarning.displayName="WithSameNameInDirectConversationWarning",WithSameNameInDirectConversationWarning.story={name:'With "same name in direct conversation" warning'},WithSameNameInGroupConversationWarning.displayName="WithSameNameInGroupConversationWarning",WithSameNameInGroupConversationWarning.story={name:'With "same name in group conversation" warning'},WithJustMiniPlayer.displayName="WithJustMiniPlayer";var __namedExportsOrder=["OldestAndNewest","WithActiveMessageRequest","WithoutNewestMessage","WithoutNewestMessageActiveMessageRequest","WithoutOldestMessage","EmptyJustHero","LastSeen","TargetIndexToTop","TypingIndicator","WithInvitedContactsForANewlyCreatedGroup","WithSameNameInDirectConversationWarning","WithSameNameInGroupConversationWarning","WithJustMiniPlayer"]},"./ts/components/conversation/TimelineFloatingHeader.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>TimelineFloatingHeader});var classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_react_spring_web__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@react-spring/web/dist/react-spring-web.esm.js"),_TimelineDateHeader__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/conversation/TimelineDateHeader.tsx"),_Spinner__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/Spinner.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function TimelineFloatingHeader(_ref){var i18n=_ref.i18n,isLoading=_ref.isLoading,style=_ref.style,timestamp=_ref.timestamp,visible=_ref.visible,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),2),hasRendered=_useState2[0],setHasRendered=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(isLoading),2),showSpinner=_useState4[0],setShowSpinner=_useState4[1];(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){setHasRendered(!0)}),[]);var _useSpring2=_slicedToArray((0,_react_spring_web__WEBPACK_IMPORTED_MODULE_2__.useSpring)((function(){return{delay:300,duration:250,from:{opacity:1},to:{opacity:0},onRest:{opacity:function(_ref2){0===_ref2.value&&setShowSpinner(!1)}}}}),[isLoading]),2),spinnerStyles=_useSpring2[0],spinnerSpringRef=_useSpring2[1];return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){isLoading&&(spinnerSpringRef.stop(),spinnerSpringRef.set({opacity:1}),setShowSpinner(!0)),!isLoading&&showSpinner&&spinnerSpringRef.start(),isLoading||showSpinner||spinnerSpringRef.stop()}),[isLoading,showSpinner,spinnerSpringRef]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsxs)("div",{"aria-level":5,className:classnames__WEBPACK_IMPORTED_MODULE_0___default()("TimelineFloatingHeader","TimelineFloatingHeader--"+(visible&&hasRendered?"visible":"hidden")),role:"heading",style,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_TimelineDateHeader__WEBPACK_IMPORTED_MODULE_3__.e,{floating:!0,i18n,timestamp}),showSpinner&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_react_spring_web__WEBPACK_IMPORTED_MODULE_2__.animated.div,{className:"TimelineFloatingHeader__spinner-container",style:spinnerStyles,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_4__.$j,{direction:"on-background",size:"20px",svgSize:"small"})})]})}TimelineFloatingHeader.displayName="TimelineFloatingHeader"},"./ts/components/conversation/TypingAnimation.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{y:()=>TypingAnimation});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function TypingAnimation(_ref){var i18n=_ref.i18n,color=_ref.color;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:"module-typing-animation",title:i18n("icu:typingAlt"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-typing-animation__dot","module-typing-animation__dot--first",color?`module-typing-animation__dot--${color}`:null)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"module-typing-animation__spacer"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-typing-animation__dot","module-typing-animation__dot--second",color?`module-typing-animation__dot--${color}`:null)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"module-typing-animation__spacer"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-typing-animation__dot","module-typing-animation__dot--third",color?`module-typing-animation__dot--${color}`:null)})]})}TypingAnimation.displayName="TypingAnimation"},"./ts/components/conversation/TypingBubble.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>TypingBubble});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_TypingAnimation__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/conversation/TypingAnimation.tsx"),_Avatar__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Avatar.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function TypingBubble(_ref){var acceptedMessageRequest=_ref.acceptedMessageRequest,avatarPath=_ref.avatarPath,badge=_ref.badge,color=_ref.color,conversationType=_ref.conversationType,i18n=_ref.i18n,isMe=_ref.isMe,phoneNumber=_ref.phoneNumber,profileName=_ref.profileName,sharedGroupNames=_ref.sharedGroupNames,theme=_ref.theme,title=_ref.title,isGroup="group"===conversationType;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-message","module-message--incoming",isGroup?"module-message--group":null),children:[isGroup&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"module-message__author-avatar-container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Avatar__WEBPACK_IMPORTED_MODULE_3__.qE,{acceptedMessageRequest,avatarPath,badge,color,conversationType:"direct",i18n,isMe,phoneNumber,profileName,theme,title,sharedGroupNames,size:28})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"module-message__container-outer",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-message__container","module-message__container--incoming"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:"module-message__typing-container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_TypingAnimation__WEBPACK_IMPORTED_MODULE_2__.y,{color:"light",i18n})})})})]})}TypingBubble.displayName="TypingBubble"},"./ts/groups/util.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{g:()=>isAccessControlEnabled});var ACCESS_ENUM=__webpack_require__("./ts/protobuf/index.ts").g.AccessControl.AccessRequired;function isAccessControlEnabled(accessControl){return accessControl===ACCESS_ENUM.ANY||accessControl===ACCESS_ENUM.ADMINISTRATOR}},"./ts/util/contactSpoofing.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var ContactSpoofingType;__webpack_require__.d(__webpack_exports__,{K:()=>ContactSpoofingType}),function(ContactSpoofingType){ContactSpoofingType[ContactSpoofingType.DirectConversationWithSameTitle=0]="DirectConversationWithSameTitle",ContactSpoofingType[ContactSpoofingType.MultipleGroupMembersWithSameTitle=1]="MultipleGroupMembersWithSameTitle"}(ContactSpoofingType||(ContactSpoofingType={}))},"./ts/util/isInSystemContacts.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>isInSystemContacts});var isInSystemContacts=function(_ref){var type=_ref.type,name=_ref.name,systemGivenName=_ref.systemGivenName,systemFamilyName=_ref.systemFamilyName;return!("direct"!==type&&"private"!==type||"string"!=typeof name&&"string"!=typeof systemGivenName&&"string"!=typeof systemFamilyName)}},"./ts/util/scrollUtil.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Og:()=>scrollToBottom,bV:()=>setScrollBottom,rA:()=>getScrollBottom});var getScrollBottom=function(el){return el.scrollHeight-el.scrollTop-el.clientHeight};function setScrollBottom(el,newScrollBottom){el.scrollTop=el.scrollHeight-newScrollBottom-el.clientHeight}function scrollToBottom(el){el.scrollTop=el.scrollHeight}}}]);
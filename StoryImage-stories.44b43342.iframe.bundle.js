(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[6361],{"./ts/components/Spinner.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$j:()=>Spinner,me:()=>SpinnerSvgSizes,sX:()=>SpinnerDirections});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/getClassNamesFor.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),SpinnerSvgSizes=["small","normal"],SpinnerDirections=["outgoing","incoming","on-background","on-primary-button","on-progress-dialog","on-avatar"];function Spinner(_ref){var ariaLabel=_ref.ariaLabel,direction=_ref.direction,moduleClassName=_ref.moduleClassName,role=_ref.role,size=_ref.size,svgSize=_ref.svgSize,getClassName=(0,_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__.h)("module-spinner",moduleClassName);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__container"),getClassName(`__container--${svgSize}`),getClassName(direction&&`__container--${direction}`),getClassName(direction&&`__container--${svgSize}-${direction}`)),role,"aria-label":ariaLabel,style:{height:size,width:size},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__circle"),getClassName(`__circle--${svgSize}`),getClassName(direction&&`__circle--${direction}`),getClassName(direction&&`__circle--${svgSize}-${direction}`))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__arc"),getClassName(`__arc--${svgSize}`),getClassName(direction&&`__arc--${direction}`),getClassName(direction&&`__arc--${svgSize}-${direction}`))})]})}Spinner.displayName="Spinner"},"./ts/components/StoryImage.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BrokenImage:()=>BrokenImage,BrokenImageThumbnail:()=>BrokenImageThumbnail,ErrorImage:()=>ErrorImage,ErrorImageThumbnail:()=>ErrorImageThumbnail,ErrorImageYou:()=>ErrorImageYou,GoodStory:()=>GoodStory,GoodStoryThumbnail:()=>GoodStoryThumbnail,NotDownloaded:()=>NotDownloaded,NotDownloadedThumbnail:()=>NotDownloadedThumbnail,PendingDownload:()=>PendingDownload,PendingDownloadThumbnail:()=>PendingDownloadThumbnail,Video:()=>Video,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),uuid__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/react/index.js"),__webpack_require__("./node_modules/uuid-browser/index.js")),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),_StoryImage__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/StoryImage.tsx"),_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./_locales/en/messages.json"),_util_setupI18n__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/util/setupI18n.ts"),_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/test-both/helpers/fakeAttachment.ts"),_types_MIME__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/types/MIME.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js"),i18n=(0,_util_setupI18n__WEBPACK_IMPORTED_MODULE_6__.E5)("en",_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_5__);const __WEBPACK_DEFAULT_EXPORT__={title:"Components/StoryImage"};function getDefaultProps(){return{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({url:"/fixtures/nathan-anderson-316188-unsplash.jpg",thumbnail:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.Jh)("/fixtures/nathan-anderson-316188-unsplash.jpg")}),firstName:"Charlie",i18n,label:"A story",queueStoryDownload:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.action)("queueStoryDownload"),storyId:(0,uuid__WEBPACK_IMPORTED_MODULE_2__.v4)(),onMediaPlaybackStart:lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}}function GoodStory(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps()))}function GoodStoryThumbnail(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{isThumbnail:!0}))}function NotDownloaded(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)()}))}function NotDownloadedThumbnail(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)(),isThumbnail:!0}))}function PendingDownload(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({pending:!0})}))}function PendingDownloadThumbnail(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({pending:!0}),isThumbnail:!0}))}function BrokenImage(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({url:"/this/path/does/not/exist.jpg"})}))}function BrokenImageThumbnail(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({url:"/this/path/does/not/exist.jpg"}),isThumbnail:!0}))}function Video(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({contentType:_types_MIME__WEBPACK_IMPORTED_MODULE_8__.ml,url:"/fixtures/pixabay-Soap-Bubble-7141.mp4"})}))}function ErrorImage(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({error:!0,url:"/this/path/does/not/exist.jpg"})}))}function ErrorImageThumbnail(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({error:!0,url:"/this/path/does/not/exist.jpg"}),isThumbnail:!0}))}function ErrorImageYou(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_StoryImage__WEBPACK_IMPORTED_MODULE_4__.s,Object.assign({},getDefaultProps(),{isMe:!0,attachment:(0,_test_both_helpers_fakeAttachment__WEBPACK_IMPORTED_MODULE_7__.dh)({error:!0,url:"/this/path/does/not/exist.jpg"})}))}GoodStory.displayName="GoodStory",GoodStory.story={name:"Good story"},GoodStoryThumbnail.displayName="GoodStoryThumbnail",GoodStoryThumbnail.story={name:"Good story (thumbnail)"},NotDownloaded.displayName="NotDownloaded",NotDownloaded.story={name:"Not downloaded"},NotDownloadedThumbnail.displayName="NotDownloadedThumbnail",NotDownloadedThumbnail.story={name:"Not downloaded (thumbnail)"},PendingDownload.displayName="PendingDownload",PendingDownload.story={name:"Pending download"},PendingDownloadThumbnail.displayName="PendingDownloadThumbnail",PendingDownloadThumbnail.story={name:"Pending download (thumbnail)"},BrokenImage.displayName="BrokenImage",BrokenImageThumbnail.displayName="BrokenImageThumbnail",BrokenImageThumbnail.story={name:"Broken Image (thumbnail)"},Video.displayName="Video",ErrorImage.displayName="ErrorImage",ErrorImageThumbnail.displayName="ErrorImageThumbnail",ErrorImageThumbnail.story={name:"Error Image (thumbnail)"},ErrorImageYou.displayName="ErrorImageYou";var __namedExportsOrder=["GoodStory","GoodStoryThumbnail","NotDownloaded","NotDownloadedThumbnail","PendingDownload","PendingDownloadThumbnail","BrokenImage","BrokenImageThumbnail","Video","ErrorImage","ErrorImageThumbnail","ErrorImageYou"]},"./ts/components/StoryImage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{s:()=>StoryImage});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_blurhash__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-blurhash/es/index.js"),_Spinner__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Spinner.tsx"),_TextAttachment__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/TextAttachment.tsx"),_types_Util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/types/Util.ts"),_types_Attachment__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/types/Attachment.ts"),_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/util/getClassNamesFor.ts"),_util_GoogleChrome__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/util/GoogleChrome.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StoryImage(_ref){var _attachment$thumbnail,attachment=_ref.attachment,children=_ref.children,firstName=_ref.firstName,i18n=_ref.i18n,isMe=_ref.isMe,isMuted=_ref.isMuted,isPaused=_ref.isPaused,isThumbnail=_ref.isThumbnail,label=_ref.label,moduleClassName=_ref.moduleClassName,queueStoryDownload=_ref.queueStoryDownload,storyId=_ref.storyId,onMediaPlaybackStart=_ref.onMediaPlaybackStart,shouldDownloadAttachment=!(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.TG)(attachment)&&!(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.XN)(attachment)||(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.AR)(attachment),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),hasImgError=_useState2[0],setHasImgError=_useState2[1],videoRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);if((0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){shouldDownloadAttachment&&queueStoryDownload(storyId)}),[queueStoryDownload,shouldDownloadAttachment,storyId]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){videoRef.current&&(isPaused?videoRef.current.pause():(onMediaPlaybackStart(),videoRef.current.play()))}),[isPaused,onMediaPlaybackStart]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){setHasImgError(!1)}),[null==attachment?void 0:attachment.url,null==attachment||null===(_attachment$thumbnail=attachment.thumbnail)||void 0===_attachment$thumbnail?void 0:_attachment$thumbnail.url]),!attachment)return null;var storyElement,overlay,hasError=hasImgError||(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.uw)(attachment),isPending=Boolean(attachment.pending)&&!attachment.textAttachment&&!hasError,isNotReadyToShow=(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.AR)(attachment)||isPending||hasError,isSupportedVideo=(0,_util_GoogleChrome__WEBPACK_IMPORTED_MODULE_8__.eq)(attachment.contentType),getClassName=(0,_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_7__.h)("StoryImage",moduleClassName);if(attachment.textAttachment)storyElement=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_TextAttachment__WEBPACK_IMPORTED_MODULE_4__.S,{i18n,isThumbnail,textAttachment:attachment.textAttachment});else if(isNotReadyToShow)storyElement=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_blurhash__WEBPACK_IMPORTED_MODULE_2__.E,{hash:attachment.blurHash||(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.d0)(_types_Util__WEBPACK_IMPORTED_MODULE_5__.f8.dark),height:attachment.height,width:attachment.width});else if(!isThumbnail&&isSupportedVideo){var shouldLoop=(0,_types_Attachment__WEBPACK_IMPORTED_MODULE_6__.DQ)(attachment?[attachment]:void 0);storyElement=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("video",{autoPlay:!0,className:getClassName("__image"),controls:!1,loop:shouldLoop,muted:isMuted,ref:videoRef,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("source",{src:attachment.url})},attachment.url)}else storyElement=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("img",{alt:label,className:getClassName("__image"),onError:function(){return setHasImgError(!0)},src:isThumbnail&&attachment.thumbnail?attachment.thumbnail.url:attachment.url});if(isPending)overlay=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"StoryImage__overlay-container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"StoryImage__spinner-bubble",title:i18n("icu:loading"),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_3__.$j,{moduleClassName:"StoryImage__spinner",svgSize:"small"})})});else if(hasError){var content=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"StoryImage__error"});isThumbnail||(content=isMe?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:i18n("icu:StoryImage__error--you")}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.Fragment,{children:i18n("icu:StoryImage__error2",{name:firstName})})),overlay=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsx)("div",{className:"StoryImage__overlay-container",children:content})}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_9__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName(""),isThumbnail?getClassName("--thumbnail"):void 0),children:[storyElement,overlay,children]})}StoryImage.displayName="StoryImage"},"./ts/components/conversation/AddNewLines.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{K:()=>AddNewLines});__webpack_require__("./node_modules/react/index.js");var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),defaultRenderNonNewLine=function(_ref){return _ref.text};function AddNewLines(_ref2){var text=_ref2.text,_ref2$renderNonNewLin=_ref2.renderNonNewLine,renderNonNewLine=void 0===_ref2$renderNonNewLin?defaultRenderNonNewLine:_ref2$renderNonNewLin,results=[],FIND_NEWLINES=/\n/g,match=FIND_NEWLINES.exec(text),last=0,count=1;if(!match)return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:renderNonNewLine({text,key:0})});for(;match;){if(last<match.index){var textWithNoNewline=text.slice(last,match.index);count+=1,results.push(renderNonNewLine({text:textWithNoNewline,key:count}))}count+=1,results.push((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("br",{},count)),last=FIND_NEWLINES.lastIndex,match=FIND_NEWLINES.exec(text)}return last<text.length&&(count+=1,results.push(renderNonNewLine({text:text.slice(last),key:count}))),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:results})}},"./ts/hooks/useRefMerger.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>useRefMerger});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_util_refMerger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/refMerger.ts"),useRefMerger=function(){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(_util_refMerger__WEBPACK_IMPORTED_MODULE_1__.d,[])}},"./ts/test-both/helpers/fakeAttachment.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C4:()=>fakeDraftAttachment,Jh:()=>fakeThumbnail,dh:()=>fakeAttachment});var _types_MIME__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/MIME.ts"),fakeAttachment=function(){var overrides=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({contentType:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,width:800,height:600,size:10304},overrides)},fakeThumbnail=function(url){return{contentType:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,height:100,path:url,url,width:100}},fakeDraftAttachment=function(){var overrides=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({pending:!1,contentType:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,path:"file.jpg",size:10304},overrides)}},"./ts/types/LinkPreview.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Df:()=>isStickerPack,Hz:()=>isGroupLink,ge:()=>getDomain,go:()=>shouldPreviewHref,hH:()=>LinkPreviewSourceType,kz:()=>isLinkSneaky,rq:()=>findLinks,vl:()=>shouldLinkifyMessage});var LinkPreviewSourceType,lodash_range__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/range.js"),lodash_range__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_range__WEBPACK_IMPORTED_MODULE_0__),lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/isEmpty.js"),lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1__),lodash_compact__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash/compact.js"),lodash_compact__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_compact__WEBPACK_IMPORTED_MODULE_2__),lodash_isNumber__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/lodash/isNumber.js"),lodash_isNumber__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash_isNumber__WEBPACK_IMPORTED_MODULE_3__),url__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/url/url.js"),linkify_it__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/linkify-it/index.js"),linkify_it__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(linkify_it__WEBPACK_IMPORTED_MODULE_5__),_util_url__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/util/url.ts"),_util_emoji__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/util/emoji.ts");function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(LinkPreviewSourceType){LinkPreviewSourceType[LinkPreviewSourceType.Composer=0]="Composer",LinkPreviewSourceType[LinkPreviewSourceType.ForwardMessageModal=1]="ForwardMessageModal",LinkPreviewSourceType[LinkPreviewSourceType.StoryCreator=2]="StoryCreator"}(LinkPreviewSourceType||(LinkPreviewSourceType={}));var linkify=linkify_it__WEBPACK_IMPORTED_MODULE_5___default()();function shouldPreviewHref(href){var url=(0,_util_url__WEBPACK_IMPORTED_MODULE_7__.FS)(href);return Boolean(url&&"https:"===url.protocol&&!function isDomainExcluded(url){var _step,_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(EXCLUDED_DOMAINS);try{for(_iterator.s();!(_step=_iterator.n()).done;){var excludedDomain=_step.value;if(url.hostname.endsWith(`.${excludedDomain}`)||url.hostname===excludedDomain)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1}(url)&&!isLinkSneaky(href))}var EXCLUDED_DOMAINS=["debuglogs.org","example","example.com","example.net","example.org","invalid","localhost","onion","test"];var DIRECTIONAL_OVERRIDES=/[\u202c\u202d\u202e]/,UNICODE_DRAWING=/[\u2500-\u25FF]/;function shouldLinkifyMessage(message){return!message||!DIRECTIONAL_OVERRIDES.test(message)&&!UNICODE_DRAWING.test(message)}function isStickerPack(){var link=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return link.startsWith("https://signal.art/addstickers/")}function isGroupLink(){var link=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return link.startsWith("https://signal.group/")}function findLinks(text,caretLocation){if(!shouldLinkifyMessage(text))return[];var haveCaretLocation=lodash_isNumber__WEBPACK_IMPORTED_MODULE_3___default()(caretLocation),textLength=text?text.length:0,matches=linkify.match(text?(0,_util_emoji__WEBPACK_IMPORTED_MODULE_6__.s)(text):"")||[];return lodash_compact__WEBPACK_IMPORTED_MODULE_2___default()(matches.map((function(match){return haveCaretLocation?void 0===caretLocation?null:match.lastIndex===textLength&&caretLocation===textLength||match.index>caretLocation||match.lastIndex<caretLocation?match.text:null:match.text})))}function getDomain(href){var url=(0,_util_url__WEBPACK_IMPORTED_MODULE_7__.FS)(href);if(!url||!url.hostname)throw new Error("getDomain: Unable to extract hostname from href");return url.hostname}var VALID_URI_CHARACTERS=new Set(["%",":","/","?","#","[","]","@","!","$","&","'","(",")","*","+",",",";","="].concat(_toConsumableArray(String.fromCharCode.apply(String,_toConsumableArray(lodash_range__WEBPACK_IMPORTED_MODULE_0___default()(65,91)).concat(_toConsumableArray(lodash_range__WEBPACK_IMPORTED_MODULE_0___default()(97,123))))),_toConsumableArray(lodash_range__WEBPACK_IMPORTED_MODULE_0___default()(10).map(String)),["-",".","_","~"])),ASCII_PATTERN=/[\u0020-\u007F]/g;function isLinkSneaky(href){if(href.length>4096)return!0;var url=(0,_util_url__WEBPACK_IMPORTED_MODULE_7__.FS)(href);if(!url)return!0;if(url.username||url.password)return!0;if(!url.hostname)return!0;if(url.hostname.length>2048)return!0;if(url.hostname.includes("%"))return!0;var labels=url.hostname.split(".");if(labels.length<2||labels.some(lodash_isEmpty__WEBPACK_IMPORTED_MODULE_1___default()))return!0;var withoutPeriods=(url__WEBPACK_IMPORTED_MODULE_4__.domainToUnicode?url__WEBPACK_IMPORTED_MODULE_4__.domainToUnicode(url.hostname):url.hostname).replace(/\./g,""),hasASCII=ASCII_PATTERN.test(withoutPeriods),withoutASCII=withoutPeriods.replace(ASCII_PATTERN,"");if(hasASCII&&withoutASCII.length>0)return!0;var startOfPathAndHash=href.indexOf("/",url.protocol.length+4);return _toConsumableArray(-1===startOfPathAndHash?"":href.substr(startOfPathAndHash)).some((function(character){return!VALID_URI_CHARACTERS.has(character)}))}},"./ts/util/getClassNamesFor.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{h:()=>getClassNamesFor});var classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__);function getClassNamesFor(){for(var _len=arguments.length,modules=new Array(_len),_key=0;_key<_len;_key++)modules[_key]=arguments[_key];return function(modifier){if(void 0===modifier)return"";var cx=modules.flatMap((function(m){return m?m.split(" "):void 0})).map((function(parentModule){return parentModule?`${parentModule}${modifier}`:void 0}));return classnames__WEBPACK_IMPORTED_MODULE_0___default()(cx)}}},"./ts/util/refMerger.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{M:()=>refMerger,d:()=>createRefMerger});var memoizee__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/memoizee/index.js"),memoizee__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(memoizee__WEBPACK_IMPORTED_MODULE_0__);function refMerger(){for(var _len=arguments.length,refs=new Array(_len),_key=0;_key<_len;_key++)refs[_key]=arguments[_key];return function(el){refs.forEach((function(ref){"function"==typeof ref?ref(el):ref&&(ref.current=el)}))}}function createRefMerger(){return memoizee__WEBPACK_IMPORTED_MODULE_0___default()(refMerger,{length:!1,max:1})}},"./ts/util/url.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function maybeParseUrl(value){if("string"==typeof value)try{return new URL(value)}catch(err){}}__webpack_require__.d(__webpack_exports__,{FS:()=>maybeParseUrl})},"./node_modules/lodash/_unescapeHtmlChar.js":(module,__unused_webpack_exports,__webpack_require__)=>{var unescapeHtmlChar=__webpack_require__("./node_modules/lodash/_basePropertyOf.js")({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});module.exports=unescapeHtmlChar},"./node_modules/lodash/unescape.js":(module,__unused_webpack_exports,__webpack_require__)=>{var toString=__webpack_require__("./node_modules/lodash/toString.js"),unescapeHtmlChar=__webpack_require__("./node_modules/lodash/_unescapeHtmlChar.js"),reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reHasEscapedHtml=RegExp(reEscapedHtml.source);module.exports=function unescape(string){return(string=toString(string))&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}},"./node_modules/react-textarea-autosize/dist/react-textarea-autosize.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}__webpack_require__.d(__webpack_exports__,{Z:()=>react_textarea_autosize_browser_esm});var react=__webpack_require__("./node_modules/react/index.js");const use_isomorphic_layout_effect_browser_esm=react.useLayoutEffect;var updateRef=function updateRef(ref,value){"function"!=typeof ref?ref.current=value:ref(value)};const use_composed_ref_esm=function useComposedRef(libRef,userRef){var prevUserRef=(0,react.useRef)();return(0,react.useCallback)((function(instance){libRef.current=instance,prevUserRef.current&&updateRef(prevUserRef.current,null),prevUserRef.current=userRef,userRef&&updateRef(userRef,instance)}),[userRef])};var HIDDEN_TEXTAREA_STYLE={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},forceHiddenStyles=function forceHiddenStyles(node){Object.keys(HIDDEN_TEXTAREA_STYLE).forEach((function(key){node.style.setProperty(key,HIDDEN_TEXTAREA_STYLE[key],"important")}))},hiddenTextarea=null;var noop=function noop(){},SIZING_STYLE=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],isIE=!!document.documentElement.currentStyle,useWindowResizeListener=function useWindowResizeListener(listener){var latestListener=function useLatest(value){var ref=react.useRef(value);return use_isomorphic_layout_effect_browser_esm((function(){ref.current=value})),ref}(listener);(0,react.useLayoutEffect)((function(){var handler=function handler(event){latestListener.current(event)};return window.addEventListener("resize",handler),function(){window.removeEventListener("resize",handler)}}),[])},TextareaAutosize=function TextareaAutosize(_ref,userRef){var cacheMeasurements=_ref.cacheMeasurements,maxRows=_ref.maxRows,minRows=_ref.minRows,_ref$onChange=_ref.onChange,onChange=void 0===_ref$onChange?noop:_ref$onChange,_ref$onHeightChange=_ref.onHeightChange,onHeightChange=void 0===_ref$onHeightChange?noop:_ref$onHeightChange,props=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(_ref,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]);var isControlled=void 0!==props.value,libRef=(0,react.useRef)(null),ref=use_composed_ref_esm(libRef,userRef),heightRef=(0,react.useRef)(0),measurementsCacheRef=(0,react.useRef)(),resizeTextarea=function resizeTextarea(){var node=libRef.current,nodeSizingData=cacheMeasurements&&measurementsCacheRef.current?measurementsCacheRef.current:function getSizingData(node){var style=window.getComputedStyle(node);if(null===style)return null;var sizingStyle=function pick(props,obj){return props.reduce((function(acc,prop){return acc[prop]=obj[prop],acc}),{})}(SIZING_STYLE,style),boxSizing=sizingStyle.boxSizing;return""===boxSizing?null:(isIE&&"border-box"===boxSizing&&(sizingStyle.width=parseFloat(sizingStyle.width)+parseFloat(sizingStyle.borderRightWidth)+parseFloat(sizingStyle.borderLeftWidth)+parseFloat(sizingStyle.paddingRight)+parseFloat(sizingStyle.paddingLeft)+"px"),{sizingStyle,paddingSize:parseFloat(sizingStyle.paddingBottom)+parseFloat(sizingStyle.paddingTop),borderSize:parseFloat(sizingStyle.borderBottomWidth)+parseFloat(sizingStyle.borderTopWidth)})}(node);if(nodeSizingData){measurementsCacheRef.current=nodeSizingData;var _calculateNodeHeight=function calculateNodeHeight(sizingData,value,minRows,maxRows){void 0===minRows&&(minRows=1),void 0===maxRows&&(maxRows=1/0),hiddenTextarea||((hiddenTextarea=document.createElement("textarea")).setAttribute("tabindex","-1"),hiddenTextarea.setAttribute("aria-hidden","true"),forceHiddenStyles(hiddenTextarea)),null===hiddenTextarea.parentNode&&document.body.appendChild(hiddenTextarea);var paddingSize=sizingData.paddingSize,borderSize=sizingData.borderSize,sizingStyle=sizingData.sizingStyle,boxSizing=sizingStyle.boxSizing;Object.keys(sizingStyle).forEach((function(_key){var key=_key;hiddenTextarea.style[key]=sizingStyle[key]})),forceHiddenStyles(hiddenTextarea),hiddenTextarea.value=value;var height=function getHeight(node,sizingData){var height=node.scrollHeight;return"border-box"===sizingData.sizingStyle.boxSizing?height+sizingData.borderSize:height-sizingData.paddingSize}(hiddenTextarea,sizingData);hiddenTextarea.value="x";var rowHeight=hiddenTextarea.scrollHeight-paddingSize,minHeight=rowHeight*minRows;"border-box"===boxSizing&&(minHeight=minHeight+paddingSize+borderSize),height=Math.max(minHeight,height);var maxHeight=rowHeight*maxRows;return"border-box"===boxSizing&&(maxHeight=maxHeight+paddingSize+borderSize),[height=Math.min(maxHeight,height),rowHeight]}(nodeSizingData,node.value||node.placeholder||"x",minRows,maxRows),height=_calculateNodeHeight[0],rowHeight=_calculateNodeHeight[1];heightRef.current!==height&&(heightRef.current=height,node.style.setProperty("height",height+"px","important"),onHeightChange(height,{rowHeight}))}};return(0,react.useLayoutEffect)(resizeTextarea),useWindowResizeListener(resizeTextarea),(0,react.createElement)("textarea",_extends({},props,{onChange:function handleChange(event){isControlled||resizeTextarea(),onChange(event)},ref}))};const react_textarea_autosize_browser_esm=(0,react.forwardRef)(TextareaAutosize)},"./node_modules/uuid-browser/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{var v1=__webpack_require__("./node_modules/uuid-browser/v1.js"),v4=__webpack_require__("./node_modules/uuid-browser/v4.js"),uuid=v4;uuid.v1=v1,uuid.v4=v4,module.exports=uuid},"./node_modules/uuid-browser/v1.js":(module,__unused_webpack_exports,__webpack_require__)=>{var rng=__webpack_require__("./node_modules/uuid-browser/lib/rng-browser.js"),bytesToUuid=__webpack_require__("./node_modules/uuid-browser/lib/bytesToUuid.js"),_seedBytes=rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0;module.exports=function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[],clockseq=void 0!==(options=options||{}).clockseq?options.clockseq:_clockseq,msecs=void 0!==options.msecs?options.msecs:(new Date).getTime(),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(clockseq=clockseq+1&16383),(dt<0||msecs>_lastMSecs)&&void 0===options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq;var tl=(1e4*(268435455&(msecs+=122192928e5))+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var node=options.node||_nodeId,n=0;n<6;++n)b[i+n]=node[n];return buf||bytesToUuid(b)}}}]);
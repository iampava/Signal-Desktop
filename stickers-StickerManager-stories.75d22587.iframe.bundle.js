"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[5149],{"./ts/components/Tabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{m:()=>Tabs});var react=__webpack_require__("./node_modules/react/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),assert=__webpack_require__("./ts/util/assert.ts"),getClassNamesFor=__webpack_require__("./ts/util/getClassNamesFor.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _excluded=["children"];function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}function Tabs(props){var children=props.children,_useTabs=function useTabs(options){(0,assert.q8)(options.tabs.length,"Tabs needs more than 1 tab present");var selectedTab,onChange,getClassName=(0,getClassNamesFor.h)("Tabs",options.moduleClassName);if("selectedTab"in options)selectedTab=options.selectedTab,onChange=options.onTabChange;else{var _useState2=_slicedToArray((0,react.useState)(options.initialSelectedTab||options.tabs[0].id),2),tabState=_useState2[0],setTabState=_useState2[1];selectedTab=tabState,onChange=function(newTab){var _options$onTabChange;setTabState(newTab),null===(_options$onTabChange=options.onTabChange)||void 0===_options$onTabChange||_options$onTabChange.call(options,newTab)}}var tabsHeaderElement=(0,jsx_runtime.jsx)("div",{className:getClassName(""),"data-supertab":!0,children:options.tabs.map((function(_ref){var id=_ref.id,label=_ref.label;return(0,jsx_runtime.jsx)("div",{"aria-selected":selectedTab===id,className:classnames_default()(getClassName("__tab"),selectedTab===id&&getClassName("__tab--selected")),onClick:function(){onChange(id)},onKeyUp:function(e){e.target===e.currentTarget&&13===e.keyCode&&(onChange(id),e.preventDefault(),e.stopPropagation())},role:"tab",tabIndex:0,children:label},id)}))});return{selectedTab,tabsHeaderElement}}(_objectWithoutProperties(props,_excluded)),selectedTab=_useTabs.selectedTab,tabsHeaderElement=_useTabs.tabsHeaderElement;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[tabsHeaderElement,children({selectedTab})]})}},"./ts/components/stickers/StickerManager.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Empty:()=>Empty,Full:()=>Full,InstalledKnownPacks:()=>InstalledKnownPacks,InstalledPacks:()=>InstalledPacks,ReceivedPacks:()=>ReceivedPacks,__namedExportsOrder:()=>__namedExportsOrder,default:()=>StickerManager_stories});var react=__webpack_require__("./node_modules/react/index.js"),esm=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),setupI18n=__webpack_require__("./ts/util/setupI18n.ts"),messages=__webpack_require__("./_locales/en/messages.json"),ConfirmationDialog=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),Button=__webpack_require__("./ts/components/Button.tsx"),UserText=__webpack_require__("./ts/components/UserText.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TabViews,StickerManagerPackRow=react.memo((function StickerManagerPackRowInner(_ref){var installStickerPack=_ref.installStickerPack,uninstallStickerPack=_ref.uninstallStickerPack,onClickPreview=_ref.onClickPreview,pack=_ref.pack,i18n=_ref.i18n,id=pack.id,key=pack.key,isBlessed=pack.isBlessed,_React$useState2=_slicedToArray(react.useState(!1),2),uninstalling=_React$useState2[0],setUninstalling=_React$useState2[1],clearUninstalling=react.useCallback((function(){setUninstalling(!1)}),[setUninstalling]),handleInstall=react.useCallback((function(e){e.stopPropagation(),installStickerPack&&installStickerPack(id,key)}),[id,installStickerPack,key]),handleUninstall=react.useCallback((function(e){e.stopPropagation(),isBlessed&&uninstallStickerPack?uninstallStickerPack(id,key):setUninstalling(!0)}),[id,isBlessed,key,setUninstalling,uninstallStickerPack]),handleConfirmUninstall=react.useCallback((function(){clearUninstalling(),uninstallStickerPack&&uninstallStickerPack(id,key)}),[id,key,clearUninstalling,uninstallStickerPack]),handleKeyDown=react.useCallback((function(event){!onClickPreview||"Enter"!==event.key&&"Space"!==event.key||(event.stopPropagation(),event.preventDefault(),onClickPreview(pack))}),[onClickPreview,pack]),handleClickPreview=react.useCallback((function(event){onClickPreview&&(event.stopPropagation(),event.preventDefault(),onClickPreview(pack))}),[onClickPreview,pack]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[uninstalling?(0,jsx_runtime.jsx)(ConfirmationDialog.U,{dialogName:"StickerManagerPackRow.confirmUninstall",i18n,onClose:clearUninstalling,actions:[{style:"negative",text:i18n("icu:stickers--StickerManager--Uninstall"),action:handleConfirmUninstall}],children:i18n("icu:stickers--StickerManager--UninstallWarning")}):null,(0,jsx_runtime.jsxs)("div",{tabIndex:0,role:"button",onKeyDown:handleKeyDown,onClick:handleClickPreview,className:"module-sticker-manager__pack-row","data-testid":id,children:[pack.cover?(0,jsx_runtime.jsx)("img",{src:pack.cover.url,alt:pack.title,className:"module-sticker-manager__pack-row__cover"}):(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__pack-row__cover-placeholder"}),(0,jsx_runtime.jsxs)("div",{className:"module-sticker-manager__pack-row__meta",children:[(0,jsx_runtime.jsxs)("div",{className:"module-sticker-manager__pack-row__meta__title",children:[(0,jsx_runtime.jsx)(UserText.a,{text:pack.title}),pack.isBlessed?(0,jsx_runtime.jsx)("span",{className:"module-sticker-manager__pack-row__meta__blessed-icon"}):null]}),(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__pack-row__meta__author",children:pack.author})]}),(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__pack-row__controls",children:"installed"===pack.status?(0,jsx_runtime.jsx)(Button.zx,{"aria-label":i18n("icu:stickers--StickerManager--Uninstall"),variant:Button.Wu.Secondary,onClick:handleUninstall,children:i18n("icu:stickers--StickerManager--Uninstall")}):(0,jsx_runtime.jsx)(Button.zx,{"aria-label":i18n("icu:stickers--StickerManager--Install"),variant:Button.Wu.Secondary,onClick:handleInstall,children:i18n("icu:stickers--StickerManager--Install")})})]})]})})),StickerPreviewModal=__webpack_require__("./ts/components/stickers/StickerPreviewModal.tsx"),Tabs=__webpack_require__("./ts/components/Tabs.tsx");function StickerManager_slicedToArray(arr,i){return function StickerManager_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function StickerManager_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function StickerManager_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return StickerManager_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return StickerManager_arrayLikeToArray(o,minLen)}(arr,i)||function StickerManager_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function StickerManager_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}!function(TabViews){TabViews.Available="Available",TabViews.Installed="Installed"}(TabViews||(TabViews={}));var StickerManager=react.memo((function StickerManagerInner(_ref){var blessedPacks=_ref.blessedPacks,closeStickerPackPreview=_ref.closeStickerPackPreview,downloadStickerPack=_ref.downloadStickerPack,i18n=_ref.i18n,installStickerPack=_ref.installStickerPack,installedPacks=_ref.installedPacks,knownPacks=_ref.knownPacks,receivedPacks=_ref.receivedPacks,uninstallStickerPack=_ref.uninstallStickerPack,focusRef=react.createRef(),_React$useState2=StickerManager_slicedToArray(react.useState(null),2),packToPreview=_React$useState2[0],setPackToPreview=_React$useState2[1];react.useEffect((function(){knownPacks&&(knownPacks.forEach((function(pack){downloadStickerPack(pack.id,pack.key)})),setTimeout((function(){focusRef.current&&focusRef.current.focus()})))}),[]);var clearPackToPreview=react.useCallback((function(){setPackToPreview(null)}),[setPackToPreview]),previewPack=react.useCallback((function(pack){setPackToPreview(pack)}),[]);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[packToPreview?(0,jsx_runtime.jsx)(StickerPreviewModal.p,{closeStickerPackPreview,downloadStickerPack,i18n,installStickerPack,onClose:clearPackToPreview,pack:packToPreview,uninstallStickerPack}):null,(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager","data-testid":"StickerManager",tabIndex:-1,ref:focusRef,children:(0,jsx_runtime.jsx)(Tabs.m,{initialSelectedTab:TabViews.Available,tabs:[{id:TabViews.Available,label:i18n("icu:stickers--StickerManager--Available")},{id:TabViews.Installed,label:i18n("icu:stickers--StickerManager--InstalledPacks")}],children:function(_ref2){var selectedTab=_ref2.selectedTab;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[selectedTab===TabViews.Available&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("h2",{className:"module-sticker-manager__text module-sticker-manager__text--heading",children:i18n("icu:stickers--StickerManager--BlessedPacks")}),blessedPacks.length>0?blessedPacks.map((function(pack){return(0,jsx_runtime.jsx)(StickerManagerPackRow,{pack,i18n,onClickPreview:previewPack,installStickerPack,uninstallStickerPack},pack.id)})):(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__empty",children:i18n("icu:stickers--StickerManager--BlessedPacks--Empty")}),(0,jsx_runtime.jsx)("h2",{className:"module-sticker-manager__text module-sticker-manager__text--heading",children:i18n("icu:stickers--StickerManager--ReceivedPacks")}),receivedPacks.length>0?receivedPacks.map((function(pack){return(0,jsx_runtime.jsx)(StickerManagerPackRow,{pack,i18n,onClickPreview:previewPack,installStickerPack,uninstallStickerPack},pack.id)})):(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__empty",children:i18n("icu:stickers--StickerManager--ReceivedPacks--Empty")})]}),selectedTab===TabViews.Installed&&(installedPacks.length>0?installedPacks.map((function(pack){return(0,jsx_runtime.jsx)(StickerManagerPackRow,{pack,i18n,onClickPreview:previewPack,installStickerPack,uninstallStickerPack},pack.id)})):(0,jsx_runtime.jsx)("div",{className:"module-sticker-manager__empty",children:i18n("icu:stickers--StickerManager--InstalledPacks--Empty")}))]})}})})]})})),StickerPicker_stories=__webpack_require__("./ts/components/stickers/StickerPicker.stories.tsx"),i18n=(0,setupI18n.E5)("en",messages);const StickerManager_stories={title:"Components/Stickers/StickerManager"};var receivedPacks=[(0,StickerPicker_stories.createPack)({id:"received-pack-1",status:"downloaded"},StickerPicker_stories.sticker1),(0,StickerPicker_stories.createPack)({id:"received-pack-2",status:"downloaded"},StickerPicker_stories.sticker2)],installedPacks=[(0,StickerPicker_stories.createPack)({id:"installed-pack-1",status:"installed"},StickerPicker_stories.sticker1),(0,StickerPicker_stories.createPack)({id:"installed-pack-2",status:"installed"},StickerPicker_stories.sticker2)],blessedPacks=[(0,StickerPicker_stories.createPack)({id:"blessed-pack-1",status:"downloaded",isBlessed:!0},StickerPicker_stories.sticker1),(0,StickerPicker_stories.createPack)({id:"blessed-pack-2",status:"downloaded",isBlessed:!0},StickerPicker_stories.sticker2)],knownPacks=[(0,StickerPicker_stories.createPack)({id:"known-pack-1",status:"known"},StickerPicker_stories.sticker1),(0,StickerPicker_stories.createPack)({id:"known-pack-2",status:"known"},StickerPicker_stories.sticker2)],createProps=function(){var overrideProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{blessedPacks:overrideProps.blessedPacks||[],closeStickerPackPreview:(0,esm.action)("closeStickerPackPreview"),downloadStickerPack:(0,esm.action)("downloadStickerPack"),i18n,installStickerPack:(0,esm.action)("installStickerPack"),installedPacks:overrideProps.installedPacks||[],knownPacks:overrideProps.knownPacks||[],receivedPacks:overrideProps.receivedPacks||[],uninstallStickerPack:(0,esm.action)("uninstallStickerPack")}};function Full(){var props=createProps({installedPacks,receivedPacks,blessedPacks});return(0,jsx_runtime.jsx)(StickerManager,Object.assign({},props))}function InstalledPacks(){var props=createProps({installedPacks});return(0,jsx_runtime.jsx)(StickerManager,Object.assign({},props))}function ReceivedPacks(){var props=createProps({receivedPacks});return(0,jsx_runtime.jsx)(StickerManager,Object.assign({},props))}function InstalledKnownPacks(){var props=createProps({installedPacks,knownPacks});return(0,jsx_runtime.jsx)(StickerManager,Object.assign({},props))}function Empty(){var props=createProps();return(0,jsx_runtime.jsx)(StickerManager,Object.assign({},props))}Full.displayName="Full",InstalledPacks.displayName="InstalledPacks",ReceivedPacks.displayName="ReceivedPacks",InstalledKnownPacks.displayName="InstalledKnownPacks",InstalledKnownPacks.story={name:"Installed + Known Packs"},Empty.displayName="Empty";var __namedExportsOrder=["Full","InstalledPacks","ReceivedPacks","InstalledKnownPacks","Empty"]}}]);
(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[5841],{"./ts/components/AvatarColorPicker.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>AvatarColorPicker});__webpack_require__("./node_modules/react/index.js");var _types_Colors__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/types/Colors.ts"),_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/BetterAvatarBubble.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AvatarColorPicker(_ref){var i18n=_ref.i18n,onColorSelected=_ref.onColorSelected,selectedColor=_ref.selectedColor;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"AvatarEditor__avatar-selector-title",children:i18n("icu:AvatarColorPicker--choose")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:"AvatarEditor__avatars",children:_types_Colors__WEBPACK_IMPORTED_MODULE_1__.sj.map((function(color){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_2__.p,{color,i18n,isSelected:selectedColor===color,onSelect:function(){onColorSelected(color)}},color)}))})]})}},"./ts/components/AvatarModalButtons.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{T:()=>AvatarModalButtons});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Button__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/Button.tsx"),_ConfirmDiscardDialog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/ConfirmDiscardDialog.tsx"),_Modal__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/Modal.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarModalButtons(_ref){var hasChanges=_ref.hasChanges,i18n=_ref.i18n,onCancel=_ref.onCancel,onSave=_ref.onSave,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0),2),confirmDiscardAction=_useState2[0],setConfirmDiscardAction=_useState2[1];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)(_Modal__WEBPACK_IMPORTED_MODULE_3__.u_.ButtonFooter,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.zx,{onClick:function(){hasChanges?setConfirmDiscardAction((function(){return onCancel})):onCancel()},variant:_Button__WEBPACK_IMPORTED_MODULE_1__.Wu.Secondary,children:i18n("icu:cancel")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_1__.zx,{disabled:!hasChanges,onClick:onSave,children:i18n("icu:save")}),confirmDiscardAction&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_ConfirmDiscardDialog__WEBPACK_IMPORTED_MODULE_2__.a,{i18n,onDiscard:confirmDiscardAction,onClose:function(){return setConfirmDiscardAction(void 0)}})]})}AvatarModalButtons.displayName="AvatarModalButtons"},"./ts/components/AvatarTextEditor.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Empty:()=>Empty,WithData:()=>WithData,WithWideCharacters:()=>WithWideCharacters,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),_util_setupI18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/setupI18n.ts"),_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./_locales/en/messages.json"),_AvatarTextEditor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/AvatarTextEditor.tsx"),_types_Colors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/types/Colors.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js"),i18n=(0,_util_setupI18n__WEBPACK_IMPORTED_MODULE_2__.E5)("en",_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__),createProps=function(){var overrideProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{avatarData:overrideProps.avatarData,i18n,onCancel:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("onCancel"),onDone:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("onDone")}};const __WEBPACK_DEFAULT_EXPORT__={title:"Components/AvatarTextEditor"};function Empty(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_AvatarTextEditor__WEBPACK_IMPORTED_MODULE_4__.g,Object.assign({},createProps()))}function WithData(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_AvatarTextEditor__WEBPACK_IMPORTED_MODULE_4__.g,Object.assign({},createProps({avatarData:{id:"123",color:_types_Colors__WEBPACK_IMPORTED_MODULE_5__.sj[6],text:"SUP"}})))}function WithWideCharacters(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_AvatarTextEditor__WEBPACK_IMPORTED_MODULE_4__.g,Object.assign({},createProps({avatarData:{id:"123",color:_types_Colors__WEBPACK_IMPORTED_MODULE_5__.sj[6],text:"â€±à¯¸ð’ˆ™"}})))}Empty.displayName="Empty",WithData.displayName="WithData",WithData.story={name:"with Data"},WithWideCharacters.displayName="WithWideCharacters",WithWideCharacters.story={name:"with wide characters"};var __namedExportsOrder=["Empty","WithData","WithWideCharacters"]},"./ts/components/AvatarTextEditor.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{g:()=>AvatarTextEditor});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_util_grapheme__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/grapheme.ts"),_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/AvatarColorPicker.tsx"),_types_Colors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/types/Colors.ts"),_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/components/AvatarModalButtons.tsx"),_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/BetterAvatarBubble.tsx"),_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./ts/util/avatarDataToBytes.ts"),_util_createAvatarData__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./ts/util/createAvatarData.ts"),_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./ts/util/avatarTextSizeCalculator.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AvatarTextEditor(_ref){var avatarData=_ref.avatarData,i18n=_ref.i18n,onCancel=_ref.onCancel,onDone=_ref.onDone,initialText=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(null==avatarData?void 0:avatarData.text)||""}),[avatarData]),initialColor=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(null==avatarData?void 0:avatarData.color)||_types_Colors__WEBPACK_IMPORTED_MODULE_4__.sj[0]}),[avatarData]),_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialText),2),inputText=_useState2[0],setInputText=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__.$)(120).text),2),fontSize=_useState4[0],setFontSize=_useState4[1],_useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initialColor),2),selectedColor=_useState6[0],setSelectedColor=_useState6[1],inputRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),focusInput=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){var inputEl=null==inputRef?void 0:inputRef.current;inputEl&&inputEl.focus()}),[]),handleChange=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(ev){var value=ev.target.value;_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(value)<=3&&setInputText(ev.target.value)}),[setInputText]),handlePaste=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(ev){var inputEl=ev.currentTarget,selectionStart=inputEl.selectionStart||0,selectionEnd=inputEl.selectionEnd||inputEl.selectionStart||0,textBeforeSelection=inputText.slice(0,selectionStart),textAfterSelection=inputText.slice(selectionEnd),pastedText=ev.clipboardData.getData("Text");_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(textBeforeSelection)+_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(pastedText)+_util_grapheme__WEBPACK_IMPORTED_MODULE_2__.QX(textAfterSelection)>3&&ev.preventDefault()}),[inputText]),onDoneRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(onDone);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){onDoneRef.current=onDone}),[onDone]);var handleDone=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((async function(){var newAvatarData=(0,_util_createAvatarData__WEBPACK_IMPORTED_MODULE_8__.s)({color:selectedColor,text:inputText}),buffer=await(0,_util_avatarDataToBytes__WEBPACK_IMPORTED_MODULE_7__.u)(newAvatarData);onDoneRef.current(buffer,newAvatarData)}),[inputText,selectedColor]);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return function(){onDoneRef.current=lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}}),[]);var measureElRef=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){var measureEl=measureElRef.current;if(measureEl){var nextFontSize=(0,_util_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_9__.Z)(120,inputText,(function(candidateFontSize){measureEl.style.fontSize=`${candidateFontSize}px`;var _measureEl$getBoundin=measureEl.getBoundingClientRect(),width=_measureEl$getBoundin.width;return{height:_measureEl$getBoundin.height,width}}));setFontSize(nextFontSize)}}),[inputText]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){focusInput()}),[focusInput]);var hasChanges=initialText!==inputText||selectedColor!==initialColor;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("div",{className:"AvatarEditor__preview",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_BetterAvatarBubble__WEBPACK_IMPORTED_MODULE_6__.p,{color:selectedColor,i18n,onSelect:focusInput,style:{height:120,width:120},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("input",{className:"AvatarTextEditor__input",onChange:handleChange,onPaste:handlePaste,ref:inputRef,style:{fontSize},type:"text",dir:"auto",value:inputText})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("hr",{className:"AvatarEditor__divider"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_AvatarColorPicker__WEBPACK_IMPORTED_MODULE_3__.n,{i18n,onColorSelected:function(color){setSelectedColor(color),focusInput()},selectedColor}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_AvatarModalButtons__WEBPACK_IMPORTED_MODULE_5__.T,{hasChanges,i18n,onCancel,onSave:handleDone}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)("div",{className:"AvatarTextEditor__measure",ref:measureElRef,children:inputText})]})}},"./ts/components/BetterAvatarBubble.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{p:()=>BetterAvatarBubble});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BetterAvatarBubble(_ref){var children=_ref.children,color=_ref.color,i18n=_ref.i18n,isSelected=_ref.isSelected,onDelete=_ref.onDelete,onSelect=_ref.onSelect,style=_ref.style;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()({BetterAvatarBubble:!0,"BetterAvatarBubble--selected":isSelected},color&&`BetterAvatarBubble--${color}`),onKeyDown:function(ev){"Enter"===ev.key&&onSelect()},onClick:onSelect,role:"button",style,tabIndex:0,children:[onDelete&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("button",{"aria-label":i18n("icu:delete"),className:"BetterAvatarBubble__delete",onClick:onDelete,tabIndex:-1,type:"button"}),children]})}BetterAvatarBubble.displayName="BetterAvatarBubble"},"./ts/components/Button.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Wu:()=>ButtonVariant,c:()=>ButtonIconType,qE:()=>ButtonSize,zx:()=>Button});var ButtonSize,ButtonVariant,ButtonIconType,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_assert__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/assert.ts"),_util_theme__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/util/theme.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");!function(ButtonSize){ButtonSize[ButtonSize.Large=0]="Large",ButtonSize[ButtonSize.Medium=1]="Medium",ButtonSize[ButtonSize.Small=2]="Small"}(ButtonSize||(ButtonSize={})),function(ButtonVariant){ButtonVariant.Calling="Calling",ButtonVariant.Destructive="Destructive",ButtonVariant.Details="Details",ButtonVariant.Primary="Primary",ButtonVariant.Secondary="Secondary",ButtonVariant.SecondaryAffirmative="SecondaryAffirmative",ButtonVariant.SecondaryDestructive="SecondaryDestructive",ButtonVariant.SystemMessage="SystemMessage"}(ButtonVariant||(ButtonVariant={})),function(ButtonIconType){ButtonIconType.audio="audio",ButtonIconType.muted="muted",ButtonIconType.search="search",ButtonIconType.unmuted="unmuted",ButtonIconType.video="video"}(ButtonIconType||(ButtonIconType={}));var SIZE_CLASS_NAMES=new Map([[ButtonSize.Large,"module-Button--large"],[ButtonSize.Medium,"module-Button--medium"],[ButtonSize.Small,"module-Button--small"]]),VARIANT_CLASS_NAMES=new Map([[ButtonVariant.Primary,"module-Button--primary"],[ButtonVariant.Secondary,"module-Button--secondary"],[ButtonVariant.SecondaryAffirmative,"module-Button--secondary module-Button--secondary--affirmative"],[ButtonVariant.SecondaryDestructive,"module-Button--secondary module-Button--secondary--destructive"],[ButtonVariant.Destructive,"module-Button--destructive"],[ButtonVariant.Calling,"module-Button--calling"],[ButtonVariant.SystemMessage,"module-Button--system-message"],[ButtonVariant.Details,"module-Button--details"]]),Button=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function ButtonInner(props,ref){var onClick,type,form,children=props.children,className=props.className,_props$disabled=props.disabled,disabled=void 0!==_props$disabled&&_props$disabled,icon=props.icon,style=props.style,tabIndex=props.tabIndex,theme=props.theme,_props$variant=props.variant,variant=void 0===_props$variant?ButtonVariant.Primary:_props$variant,_props$size=props.size,size=void 0===_props$size?variant===ButtonVariant.Details?ButtonSize.Small:ButtonSize.Medium:_props$size,ariaLabel=props["aria-label"],ariaDisabled=props["aria-disabled"];"onClick"in props?(onClick=props.onClick,type="button"):(onClick=void 0,type=props.type,form=props.form);var sizeClassName=SIZE_CLASS_NAMES.get(size);(0,_util_assert__WEBPACK_IMPORTED_MODULE_2__.q8)(sizeClassName,"<Button> size not found");var variantClassName=VARIANT_CLASS_NAMES.get(variant);(0,_util_assert__WEBPACK_IMPORTED_MODULE_2__.q8)(variantClassName,"<Button> variant not found");var buttonElement=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("button",{"aria-label":ariaLabel,"aria-disabled":ariaDisabled,className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("module-Button",sizeClassName,variantClassName,icon&&`module-Button--icon--${icon}`,className),disabled,onClick,form,ref,style,tabIndex,type,children});return theme?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{className:(0,_util_theme__WEBPACK_IMPORTED_MODULE_3__.j)(theme),children:buttonElement}):buttonElement}))},"./ts/components/ConfirmDiscardDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>ConfirmDiscardDialog});__webpack_require__("./node_modules/react/index.js");var _ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/components/ConfirmationDialog.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function ConfirmDiscardDialog(_ref){var i18n=_ref.i18n,onClose=_ref.onClose,onDiscard=_ref.onDiscard;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ConfirmationDialog__WEBPACK_IMPORTED_MODULE_1__.U,{dialogName:"ConfirmDiscardDialog",actions:[{action:onDiscard,text:i18n("icu:discard"),style:"negative"}],i18n,onClose,children:i18n("icu:ConfirmDiscardDialog--discard")})}ConfirmDiscardDialog.displayName="ConfirmDiscardDialog"},"./ts/components/ConfirmationDialog.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{U:()=>ConfirmationDialog});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_react_spring_web__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@react-spring/web/dist/react-spring-web.esm.js"),_Button__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/components/Button.tsx"),_ModalHost__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./ts/components/ModalHost.tsx"),_Modal__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/Modal.tsx"),_hooks_useAnimated__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/hooks/useAnimated.tsx"),_Spinner__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./ts/components/Spinner.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react/jsx-runtime.js");function focusRef(el){el&&el.focus()}var ConfirmationDialog=react__WEBPACK_IMPORTED_MODULE_0__.memo((function ConfirmationDialogInner(_ref){var _ref$actions=_ref.actions,actions=void 0===_ref$actions?[]:_ref$actions,dialogName=_ref.dialogName,cancelButtonVariant=_ref.cancelButtonVariant,cancelText=_ref.cancelText,children=_ref.children,hasXButton=_ref.hasXButton,i18n=_ref.i18n,isSpinning=_ref.isSpinning,moduleClassName=_ref.moduleClassName,noMouseClose=_ref.noMouseClose,noDefaultCancelButton=_ref.noDefaultCancelButton,onCancel=_ref.onCancel,onClose=_ref.onClose,onTopOfEverything=_ref.onTopOfEverything,theme=_ref.theme,title=_ref.title,_useAnimated=(0,_hooks_useAnimated__WEBPACK_IMPORTED_MODULE_5__.F)(onClose,{getFrom:function(){return{opacity:0,transform:"scale(0.25)"}},getTo:function(isOpen){return{opacity:isOpen?1:0,transform:"scale(1)"}}}),close=_useAnimated.close,overlayStyles=_useAnimated.overlayStyles,modalStyles=_useAnimated.modalStyles,cancelAndClose=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){onCancel&&onCancel(),close()}),[close,onCancel]),handleCancel=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(e){e.target===e.currentTarget&&cancelAndClose()}),[cancelAndClose]),hasActions=Boolean(actions.length),footer=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.Fragment,{children:[isSpinning||noDefaultCancelButton?null:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_2__.zx,{onClick:handleCancel,ref:focusRef,variant:cancelButtonVariant||(hasActions?_Button__WEBPACK_IMPORTED_MODULE_2__.Wu.Secondary:_Button__WEBPACK_IMPORTED_MODULE_2__.Wu.Primary),children:cancelText||i18n("icu:confirmation-dialog--Cancel")}),actions.map((function(action,i){var _action$id,buttonStyle;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Button__WEBPACK_IMPORTED_MODULE_2__.zx,{disabled:action.disabled||isSpinning,"aria-disabled":action["aria-disabled"],onClick:function(){action.action(),!1!==action.autoClose&&close()},"data-action":i,variant:(buttonStyle=action.style,"affirmative"===buttonStyle?_Button__WEBPACK_IMPORTED_MODULE_2__.Wu.Primary:"negative"===buttonStyle?_Button__WEBPACK_IMPORTED_MODULE_2__.Wu.Destructive:_Button__WEBPACK_IMPORTED_MODULE_2__.Wu.Secondary),children:isSpinning?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Spinner__WEBPACK_IMPORTED_MODULE_6__.$j,{size:"22px",svgSize:"small",direction:"on-primary-button"}):action.text},"string"==typeof action.text?null!==(_action$id=action.id)&&void 0!==_action$id?_action$id:action.text:action.id)}))]}),modalName=`ConfirmationDialog.${dialogName}`;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_ModalHost__WEBPACK_IMPORTED_MODULE_3__.l,{modalName,noMouseClose,onClose:close,onEscape:cancelAndClose,onTopOfEverything,overlayStyles,theme,moduleClassName:moduleClassName?`${moduleClassName}__ModalHost`:void 0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_react_spring_web__WEBPACK_IMPORTED_MODULE_1__.animated.div,{style:modalStyles,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_7__.jsx)(_Modal__WEBPACK_IMPORTED_MODULE_4__.P2,{modalName,hasXButton,i18n,moduleClassName,onClose:cancelAndClose,title,modalFooter:footer,children})})})}))},"./ts/components/Spinner.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$j:()=>Spinner,me:()=>SpinnerSvgSizes,sX:()=>SpinnerDirections});__webpack_require__("./node_modules/react/index.js");var classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/getClassNamesFor.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js"),SpinnerSvgSizes=["small","normal"],SpinnerDirections=["outgoing","incoming","on-background","on-primary-button","on-progress-dialog","on-avatar"];function Spinner(_ref){var ariaLabel=_ref.ariaLabel,direction=_ref.direction,moduleClassName=_ref.moduleClassName,role=_ref.role,size=_ref.size,svgSize=_ref.svgSize,getClassName=(0,_util_getClassNamesFor__WEBPACK_IMPORTED_MODULE_2__.h)("module-spinner",moduleClassName);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsxs)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__container"),getClassName(`__container--${svgSize}`),getClassName(direction&&`__container--${direction}`),getClassName(direction&&`__container--${svgSize}-${direction}`)),role,"aria-label":ariaLabel,style:{height:size,width:size},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__circle"),getClassName(`__circle--${svgSize}`),getClassName(direction&&`__circle--${direction}`),getClassName(direction&&`__circle--${svgSize}-${direction}`))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(getClassName("__arc"),getClassName(`__arc--${svgSize}`),getClassName(direction&&`__arc--${direction}`),getClassName(direction&&`__arc--${svgSize}-${direction}`))})]})}Spinner.displayName="Spinner"},"./ts/components/emoji/lib.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Eb:()=>getSizeClass,J7:()=>getEmojiCount,Mz:()=>hasNonEmojiText,PE:()=>emojiToData,al:()=>getImagePath,lu:()=>dataByCategory,nS:()=>convertShortName,pQ:()=>unifiedToEmoji,qg:()=>isShortName,rl:()=>emojiToImage,rz:()=>convertShortNameToData,yC:()=>search,yz:()=>getEmojiData});var lodash_take__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/take.js"),lodash_take__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_take__WEBPACK_IMPORTED_MODULE_0__),lodash_sortBy__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/sortBy.js"),lodash_sortBy__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_sortBy__WEBPACK_IMPORTED_MODULE_1__),lodash_mapValues__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/lodash/mapValues.js"),lodash_mapValues__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(lodash_mapValues__WEBPACK_IMPORTED_MODULE_2__),lodash_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/lodash/map.js"),lodash_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(lodash_map__WEBPACK_IMPORTED_MODULE_3__),lodash_keyBy__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/lodash/keyBy.js"),lodash_keyBy__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(lodash_keyBy__WEBPACK_IMPORTED_MODULE_4__),lodash_isNumber__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/lodash/isNumber.js"),lodash_isNumber__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(lodash_isNumber__WEBPACK_IMPORTED_MODULE_5__),lodash_groupBy__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/lodash/groupBy.js"),lodash_groupBy__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(lodash_groupBy__WEBPACK_IMPORTED_MODULE_6__),lodash_get__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/lodash/get.js"),lodash_get__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_7__),lodash_flatMap__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/lodash/flatMap.js"),lodash_flatMap__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(lodash_flatMap__WEBPACK_IMPORTED_MODULE_8__),lodash_compact__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/lodash/compact.js"),lodash_compact__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(lodash_compact__WEBPACK_IMPORTED_MODULE_9__),emoji_datasource__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/emoji-datasource/emoji.json"),emoji_regex__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/emoji-regex/index.js"),emoji_regex__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(emoji_regex__WEBPACK_IMPORTED_MODULE_11__),fuse_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/fuse.js/dist/fuse.esm.js"),p_queue__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/p-queue/dist/index.js"),_util_getOwn__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./ts/util/getOwn.ts"),_util_durations__WEBPACK_IMPORTED_MODULE_14__=(__webpack_require__("./ts/logging/log.ts"),__webpack_require__("./ts/util/durations/index.ts"));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var skinTones=["1F3FB","1F3FC","1F3FD","1F3FE","1F3FF"],data=emoji_datasource__WEBPACK_IMPORTED_MODULE_10__.filter((function(emoji){return emoji.has_img_apple})).map((function(emoji){return"People & Body"===emoji.category?Object.assign({},emoji,{sort_order:emoji.sort_order+1e3}):emoji})),ROOT_PATH=lodash_get__WEBPACK_IMPORTED_MODULE_7___default()("undefined"!=typeof window?window:null,"ROOT_PATH",""),makeImagePath=function(src){return`${ROOT_PATH}node_modules/emoji-datasource-apple/img/apple/64/${src}`},dataByShortName=(new p_queue__WEBPACK_IMPORTED_MODULE_12__.Z({concurrency:10,timeout:30*_util_durations__WEBPACK_IMPORTED_MODULE_14__.EB,throwOnTimeout:!0}),new Set,lodash_keyBy__WEBPACK_IMPORTED_MODULE_4___default()(data,"short_name")),imageByEmoji={},dataByEmoji={},dataByCategory=lodash_mapValues__WEBPACK_IMPORTED_MODULE_2___default()(lodash_groupBy__WEBPACK_IMPORTED_MODULE_6___default()(data,(function(_ref){var category=_ref.category;return"Activities"===category?"activity":"Animals & Nature"===category?"animal":"Flags"===category?"flag":"Food & Drink"===category?"food":"Objects"===category?"object":"Travel & Places"===category?"travel":"Smileys & Emotion"===category||"People & Body"===category?"emoji":"Symbols"===category?"symbol":"misc"})),(function(arr){return lodash_sortBy__WEBPACK_IMPORTED_MODULE_1___default()(arr,"sort_order")}));function getEmojiData(shortName,skinTone){var base=dataByShortName[shortName];if(skinTone&&base.skin_variations){var variation=lodash_isNumber__WEBPACK_IMPORTED_MODULE_5___default()(skinTone)?skinTones[skinTone-1]:skinTone;return base.skin_variations[variation]?base.skin_variations[variation]:base.skin_variations[`${variation}-${variation}`]}return base}function getImagePath(shortName,skinTone){var emojiData=getEmojiData(shortName,skinTone);return makeImagePath(emojiData.image)}var fuse=new fuse_js__WEBPACK_IMPORTED_MODULE_15__.Z(data,{shouldSort:!0,threshold:.2,minMatchCharLength:1,keys:["short_name","short_names"]}),fuseExactPrefix=new fuse_js__WEBPACK_IMPORTED_MODULE_15__.Z(data,{shouldSort:!0,threshold:0,minMatchCharLength:2,keys:["short_name","short_names"]});function search(query){var count=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,fuseIndex=2===query.length?fuseExactPrefix:fuse,results=fuseIndex.search(query.substr(0,32)).map((function(result){return result.item}));return count?lodash_take__WEBPACK_IMPORTED_MODULE_0___default()(results,count):results}var shortNames=new Set([].concat(_toConsumableArray(lodash_map__WEBPACK_IMPORTED_MODULE_3___default()(data,"short_name")),_toConsumableArray(lodash_compact__WEBPACK_IMPORTED_MODULE_9___default()(lodash_flatMap__WEBPACK_IMPORTED_MODULE_8___default()(data,"short_names")))));function isShortName(name){return shortNames.has(name)}function unifiedToEmoji(unified){return unified.split("-").map((function(c){return String.fromCodePoint(parseInt(c,16))})).join("")}function convertShortNameToData(shortName){var skinTone=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,base=dataByShortName[shortName];if(base){var toneKey=lodash_isNumber__WEBPACK_IMPORTED_MODULE_5___default()(skinTone)?skinTones[skinTone-1]:skinTone;if(skinTone&&base.skin_variations){var variation=base.skin_variations[toneKey];if(variation)return Object.assign({},base,variation)}return base}}function convertShortName(shortName){var skinTone=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,emojiData=convertShortNameToData(shortName,skinTone);return emojiData?unifiedToEmoji(emojiData.unified):""}function emojiToImage(emoji){return(0,_util_getOwn__WEBPACK_IMPORTED_MODULE_16__.G)(imageByEmoji,emoji)}function emojiToData(emoji){return(0,_util_getOwn__WEBPACK_IMPORTED_MODULE_16__.G)(dataByEmoji,emoji)}function getEmojiCount(str){var regex=emoji_regex__WEBPACK_IMPORTED_MODULE_11___default()(),match=regex.exec(str),count=0;if(!regex.global)return match?1:0;for(;match;)count+=1,match=regex.exec(str);return count}function hasNonEmojiText(str){return str.replace(emoji_regex__WEBPACK_IMPORTED_MODULE_11___default()(),"").trim().length>0}function getSizeClass(str){if(hasNonEmojiText(str))return"";var emojiCount=getEmojiCount(str);return 1===emojiCount?"max":2===emojiCount?"extra-large":3===emojiCount?"large":4===emojiCount?"medium":5===emojiCount?"small":""}data.forEach((function(emoji){var short_name=emoji.short_name,short_names=emoji.short_names,skin_variations=emoji.skin_variations,image=emoji.image;short_names&&short_names.forEach((function(name){dataByShortName[name]=emoji})),imageByEmoji[convertShortName(short_name)]=makeImagePath(image),dataByEmoji[convertShortName(short_name)]=emoji,skin_variations&&Object.entries(skin_variations).forEach((function(_ref2){var _ref3=_slicedToArray(_ref2,2),tone=_ref3[0],variation=_ref3[1];imageByEmoji[convertShortName(short_name,tone)]=makeImagePath(variation.image),dataByEmoji[convertShortName(short_name,tone)]=emoji}))}))},"./ts/types/Colors.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{A0:()=>ContactNameColors,Cy:()=>DEFAULT_CONVERSATION_COLOR,cU:()=>ConversationColors,hx:()=>getAvatarColor,nE:()=>AvatarColorMap,sj:()=>AvatarColors});var AvatarColorMap=new Map([["A100",{bg:"#e3e3fe",fg:"#3838f5"}],["A110",{bg:"#dde7fc",fg:"#1251d3"}],["A120",{bg:"#d8e8f0",fg:"#086da0"}],["A130",{bg:"#cde4cd",fg:"#067906"}],["A140",{bg:"#eae0fd",fg:"#661aff"}],["A150",{bg:"#f5e3fe",fg:"#9f00f0"}],["A160",{bg:"#f6d8ec",fg:"#b8057c"}],["A170",{bg:"#f5d7d7",fg:"#be0404"}],["A180",{bg:"#fef5d0",fg:"#836b01"}],["A190",{bg:"#eae6d5",fg:"#7d6f40"}],["A200",{bg:"#d2d2dc",fg:"#4f4f6d"}],["A210",{bg:"#d7d7d9",fg:"#5c5c5c"}]]),AvatarColors=Array.from(AvatarColorMap.keys()),ConversationColors=["ultramarine","crimson","vermilion","burlap","forest","wintergreen","teal","blue","indigo","violet","plum","taupe","steel","ember","midnight","infrared","lagoon","fluorescent","basil","sublime","sea","tangerine"],ContactNameColors=["200","120","300","010","210","330","230","180","030","340","270","090","000","150","240","040","160","280","080","320","020","140","260","060","350","100","290","130","220","050","170","250","070","190","310","110"],DEFAULT_CONVERSATION_COLOR={color:"ultramarine"};function getAvatarColor(color){return color||AvatarColors[0]}},"./ts/types/MIME.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Aw:()=>isLongMessage,F0:()=>isAudio,F5:()=>VIDEO_QUICKTIME,Ih:()=>IMAGE_PNG,Oh:()=>IMAGE_ICO,Or:()=>isImage,UG:()=>IMAGE_BMP,Wv:()=>isVideo,_l:()=>IMAGE_JPEG,cJ:()=>stringToMIMEType,dB:()=>IMAGE_GIF,ml:()=>VIDEO_MP4,np:()=>TEXT_ATTACHMENT,rJ:()=>LONG_MESSAGE,sY:()=>isGif,to:()=>IMAGE_WEBP,ty:()=>AUDIO_MP3});var stringToMIMEType=function(value){return value},AUDIO_MP3=(stringToMIMEType("application/octet-stream"),stringToMIMEType("application/json"),stringToMIMEType("audio/aac"),stringToMIMEType("audio/mp3")),IMAGE_GIF=stringToMIMEType("image/gif"),IMAGE_JPEG=stringToMIMEType("image/jpeg"),IMAGE_PNG=stringToMIMEType("image/png"),IMAGE_WEBP=stringToMIMEType("image/webp"),IMAGE_ICO=stringToMIMEType("image/x-icon"),IMAGE_BMP=stringToMIMEType("image/bmp"),VIDEO_MP4=stringToMIMEType("video/mp4"),VIDEO_QUICKTIME=stringToMIMEType("video/quicktime"),LONG_MESSAGE=stringToMIMEType("text/x-signal-plain"),TEXT_ATTACHMENT=stringToMIMEType("text/x-signal-story"),isGif=function(value){return"image/gif"===value},isImage=function(value){return Boolean(value)&&value.startsWith("image/")},isVideo=function(value){return Boolean(value)&&value.startsWith("video/")},isAudio=function(value){return Boolean(value)&&value.startsWith("audio/")&&!value.endsWith("aiff")},isLongMessage=function(value){return value===LONG_MESSAGE}},"./ts/util/avatarDataToBytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>avatarDataToBytes});var _types_Colors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/Colors.ts"),_canvasToBytes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/canvasToBytes.ts"),_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./ts/util/avatarTextSizeCalculator.ts");function getAvatarColor(color){return _types_Colors__WEBPACK_IMPORTED_MODULE_0__.nE.get(color)||{bg:"black",fg:"white"}}function setCanvasBackground(bg,context,canvas){context.fillStyle=bg,context.fillRect(0,0,canvas.width,canvas.height)}async function drawImage(src,context,canvas){var image=new Image;image.src=src,await image.decode(),canvas.width=image.width,canvas.height=image.height,context.drawImage(image,0,0)}async function avatarDataToBytes(avatarData){var canvas=document.createElement("canvas");canvas.width=1024,canvas.height=1024;var context=canvas.getContext("2d");if(!context)throw new Error("avatarDataToBytes: could not get canvas rendering context");var _window$Signal,color=avatarData.color,icon=avatarData.icon,imagePath=avatarData.imagePath,text=avatarData.text;if(imagePath)await drawImage(null!==(_window$Signal=window.Signal)&&void 0!==_window$Signal&&_window$Signal.Migrations?window.Signal.Migrations.getAbsoluteAvatarPath(imagePath):imagePath,context,canvas);else if(color&&text){var _getAvatarColor=getAvatarColor(color),bg=_getAvatarColor.bg,fg=_getAvatarColor.fg,textToWrite=text.toLocaleUpperCase();setCanvasBackground(bg,context,canvas),context.fillStyle=fg;var font=await async function getFont(text){var font=new window.FontFace("Inter",'url("fonts/inter-v3.19/Inter-Regular.woff2")');await font.load();var measurerCanvas=document.createElement("canvas");measurerCanvas.width=1024,measurerCanvas.height=1024;var measurerContext=measurerCanvas.getContext("2d");if(!measurerContext)throw new Error("getFont: could not get canvas rendering context");return`${(0,_avatarTextSizeCalculator__WEBPACK_IMPORTED_MODULE_2__.Z)(1024,text,(function(candidateFontSize){var candidateFont=`${candidateFontSize}px Inter`;measurerContext.font=candidateFont;var _measurerContext$meas=measurerContext.measureText(text),actualBoundingBoxLeft=_measurerContext$meas.actualBoundingBoxLeft,actualBoundingBoxRight=_measurerContext$meas.actualBoundingBoxRight,actualBoundingBoxAscent=_measurerContext$meas.actualBoundingBoxAscent,actualBoundingBoxDescent=_measurerContext$meas.actualBoundingBoxDescent,width=Math.abs(actualBoundingBoxLeft)+Math.abs(actualBoundingBoxRight);return{height:Math.abs(actualBoundingBoxAscent)+Math.abs(actualBoundingBoxDescent),width}}))}px Inter`}(textToWrite);context.font=font,context.textBaseline="middle",context.textAlign="center",context.fillText(textToWrite,512,542)}else if(color&&icon){var iconPath=`images/avatars/avatar_${icon}.svg`;await drawImage(iconPath,context,canvas),context.globalCompositeOperation="destination-over",setCanvasBackground(getAvatarColor(color).bg,context,canvas)}return(0,_canvasToBytes__WEBPACK_IMPORTED_MODULE_1__.E)(canvas)}},"./ts/util/avatarTextSizeCalculator.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>getFontSizes,Z:()=>getFittedFontSize});var _components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/components/emoji/lib.ts");function getFontSizes(bubbleSize){return{diameter:Math.ceil(.75*bubbleSize),singleEmoji:Math.ceil(.6*bubbleSize),smol:Math.ceil(.05*bubbleSize),text:Math.ceil(.45*bubbleSize)}}function getFittedFontSize(bubbleSize,text,measure){var sizes=getFontSizes(bubbleSize),candidateFontSize=sizes.text;for((0,_components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__.Mz)(text)||1!==(0,_components_emoji_lib__WEBPACK_IMPORTED_MODULE_0__.J7)(text)||(candidateFontSize=sizes.singleEmoji);candidateFontSize>=sizes.smol;candidateFontSize-=1){var _measure=measure(candidateFontSize),height=_measure.height;if(_measure.width<sizes.diameter&&height<sizes.diameter)return candidateFontSize}return candidateFontSize}},"./ts/util/canvasToBlob.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>canvasToBlob});var _types_MIME__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/types/MIME.ts");async function canvasToBlob(canvas){var mimeType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_types_MIME__WEBPACK_IMPORTED_MODULE_0__._l,quality=arguments.length>2?arguments[2]:void 0;return new Promise((function(resolve,reject){return canvas.toBlob((function(result){result?resolve(result):reject(new Error("Couldn't convert the canvas to a Blob"))}),mimeType,quality)}))}},"./ts/util/canvasToBytes.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E:()=>canvasToBytes});var _canvasToBlob__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/canvasToBlob.ts");async function canvasToBytes(canvas,mimeType,quality){var blob=await(0,_canvasToBlob__WEBPACK_IMPORTED_MODULE_0__._)(canvas,mimeType,quality);return new Uint8Array(await blob.arrayBuffer())}},"./ts/util/createAvatarData.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{s:()=>createAvatarData});var uuid__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/uuid-browser/index.js");function createAvatarData(partialAvatarData){return Object.assign({id:(0,uuid__WEBPACK_IMPORTED_MODULE_0__.v4)()},partialAvatarData)}},"./ts/util/durations/constants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{EB:()=>MINUTE,kr:()=>HOUR,ps:()=>WEEK,sh:()=>SECOND,vc:()=>MONTH,x4:()=>DAY});var SECOND=1e3,MINUTE=60*SECOND,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY},"./ts/util/durations/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{x4:()=>constants.x4,kC:()=>DurationInSeconds,kr:()=>constants.kr,EB:()=>constants.EB,vc:()=>constants.vc,sh:()=>constants.sh,ps:()=>constants.ps});var DurationInSeconds,_DurationInSeconds,constants=__webpack_require__("./ts/util/durations/constants.ts");(_DurationInSeconds=DurationInSeconds||(DurationInSeconds={})).fromMillis=function(ms){return ms/constants.sh},_DurationInSeconds.fromSeconds=function(seconds){return seconds},_DurationInSeconds.fromMinutes=function(m){return m*constants.EB/constants.sh},_DurationInSeconds.fromHours=function(h){return h*constants.kr/constants.sh},_DurationInSeconds.fromDays=function(d){return d*constants.x4/constants.sh},_DurationInSeconds.fromWeeks=function(d){return d*constants.ps/constants.sh},_DurationInSeconds.fromMonths=function(d){return d*constants.vc/constants.sh},_DurationInSeconds.toSeconds=function(d){return d},_DurationInSeconds.toMillis=function(d){return d*constants.sh},_DurationInSeconds.toHours=function(d){return d*constants.sh/constants.kr},_DurationInSeconds.ZERO=DurationInSeconds.fromSeconds(0),_DurationInSeconds.HOUR=DurationInSeconds.fromHours(1),_DurationInSeconds.MINUTE=DurationInSeconds.fromMinutes(1),_DurationInSeconds.DAY=DurationInSeconds.fromDays(1),_DurationInSeconds.WEEK=DurationInSeconds.fromWeeks(1)},"./ts/util/getOwn.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function getOwn(obj,key){return Object.hasOwn(obj,key)?obj[key]:void 0}__webpack_require__.d(__webpack_exports__,{G:()=>getOwn})},"./ts/util/grapheme.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{QX:()=>count,Rc:()=>truncateAndSize,i3:()=>isSingleGrapheme});var _iterables__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./ts/util/iterables.ts");function count(str){var segments=(new Intl.Segmenter).segment(str);return(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.dp)(segments)}function truncateAndSize(str,toSize){var segments=(new Intl.Segmenter).segment(str),originalSize=(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.dp)(segments);return void 0===toSize||originalSize<=toSize?[str,originalSize]:[(0,_iterables__WEBPACK_IMPORTED_MODULE_0__.v_)((0,_iterables__WEBPACK_IMPORTED_MODULE_0__.UI)((0,_iterables__WEBPACK_IMPORTED_MODULE_0__.qn)(segments,toSize),(function(s){return s.segment})),""),toSize]}function isSingleGrapheme(str){return""!==str&&(new Intl.Segmenter).segment(str).containing(0).segment===str}},"./ts/util/iterables.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function isIterable(value){return"object"==typeof value&&null!=value&&Symbol.iterator in value||"string"==typeof value}function size(iterable){if("string"==typeof iterable||Array.isArray(iterable))return iterable.length;if(iterable instanceof Set||iterable instanceof Map)return iterable.size;for(var iterator=iterable[Symbol.iterator](),result=-1,done=!1;!done;result+=1)done=Boolean(iterator.next().done);return result}__webpack_require__.d(__webpack_exports__,{TW:()=>isIterable,UI:()=>map,dp:()=>size,f9:()=>zipObject,hX:()=>filter,qn:()=>take,rx:()=>repeat,u4:()=>reduce,v_:()=>join,yW:()=>every});function every(iterable,predicate){var _step2,_iterator2=_createForOfIteratorHelper(iterable);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){if(!predicate(_step2.value))return!1}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return!0}function filter(iterable,predicate){return new FilterIterable(iterable,predicate)}var FilterIterable=function(_Symbol$iterator2){function FilterIterable(iterable,predicate){_classCallCheck(this,FilterIterable),this.iterable=iterable,this.predicate=predicate}return _createClass(FilterIterable,[{key:Symbol.iterator,value:function(){return new FilterIterator(this.iterable[Symbol.iterator](),this.predicate)}}]),FilterIterable}(),FilterIterator=function(){function FilterIterator(iterator,predicate){_classCallCheck(this,FilterIterator),this.iterator=iterator,this.predicate=predicate}return _createClass(FilterIterator,[{key:"next",value:function next(){for(;;){var nextIteration=this.iterator.next();if(nextIteration.done||this.predicate(nextIteration.value))return nextIteration}}}]),FilterIterator}();function join(iterable,separator){var _step6,hasProcessedFirst=!1,result="",_iterator6=_createForOfIteratorHelper(iterable);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _value4=_step6.value,stringifiedValue=null==_value4?"":String(_value4);hasProcessedFirst?result+=separator+stringifiedValue:result=stringifiedValue,hasProcessedFirst=!0}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return result}function map(iterable,fn){return new MapIterable(iterable,fn)}var MapIterable=function(_Symbol$iterator4){function MapIterable(iterable,fn){_classCallCheck(this,MapIterable),this.iterable=iterable,this.fn=fn}return _createClass(MapIterable,[{key:Symbol.iterator,value:function(){return new MapIterator(this.iterable[Symbol.iterator](),this.fn)}}]),MapIterable}(),MapIterator=function(){function MapIterator(iterator,fn){_classCallCheck(this,MapIterator),this.iterator=iterator,this.fn=fn}return _createClass(MapIterator,[{key:"next",value:function next(){var nextIteration=this.iterator.next();return nextIteration.done?nextIteration:{done:!1,value:this.fn(nextIteration.value)}}}]),MapIterator}();function reduce(iterable,fn,accumulator){var _step7,result=accumulator,_iterator7=_createForOfIteratorHelper(iterable);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){result=fn(result,_step7.value)}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}return result}function repeat(value){return new RepeatIterable(value)}var RepeatIterable=function(_Symbol$iterator5){function RepeatIterable(value){_classCallCheck(this,RepeatIterable),this.value=value}return _createClass(RepeatIterable,[{key:Symbol.iterator,value:function(){return new RepeatIterator(this.value)}}]),RepeatIterable}(),RepeatIterator=function(){function RepeatIterator(value){_classCallCheck(this,RepeatIterator),this.iteratorResult={done:!1,value}}return _createClass(RepeatIterator,[{key:"next",value:function next(){return this.iteratorResult}}]),RepeatIterator}();function take(iterable,amount){return new TakeIterable(iterable,amount)}var TakeIterable=function(_Symbol$iterator6){function TakeIterable(iterable,amount){_classCallCheck(this,TakeIterable),this.iterable=iterable,this.amount=amount}return _createClass(TakeIterable,[{key:Symbol.iterator,value:function(){return new TakeIterator(this.iterable[Symbol.iterator](),this.amount)}}]),TakeIterable}(),TakeIterator=function(){function TakeIterator(iterator,amount){_classCallCheck(this,TakeIterator),this.iterator=iterator,this.amount=amount}return _createClass(TakeIterator,[{key:"next",value:function next(){var nextIteration=this.iterator.next();return nextIteration.done||0===this.amount?{done:!0,value:void 0}:(this.amount-=1,nextIteration)}}]),TakeIterator}();function zipObject(props,values){for(var result={},propsIterator=props[Symbol.iterator](),valuesIterator=values[Symbol.iterator]();;){var propIteration=propsIterator.next();if(propIteration.done)break;var valueIteration=valuesIterator.next();if(valueIteration.done)break;result[propIteration.value]=valueIteration.value}return result}},"./ts/util/missingCaseError.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{b:()=>missingCaseError});var missingCaseError=function(x){return new TypeError(`Unhandled case: ${function reallyJsonStringify(value){var result;try{result=JSON.stringify(value)}catch(_err){result=void 0}return"string"==typeof result?result:Object.prototype.toString.call(value)}(x)}`)}},"./node_modules/lodash/first.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/lodash/head.js")},"./node_modules/lodash/head.js":module=>{module.exports=function head(array){return array&&array.length?array[0]:void 0}},"./node_modules/lodash/last.js":module=>{module.exports=function last(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}},"./node_modules/uuid-browser/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{var v1=__webpack_require__("./node_modules/uuid-browser/v1.js"),v4=__webpack_require__("./node_modules/uuid-browser/v4.js"),uuid=v4;uuid.v1=v1,uuid.v4=v4,module.exports=uuid},"./node_modules/uuid-browser/v1.js":(module,__unused_webpack_exports,__webpack_require__)=>{var rng=__webpack_require__("./node_modules/uuid-browser/lib/rng-browser.js"),bytesToUuid=__webpack_require__("./node_modules/uuid-browser/lib/bytesToUuid.js"),_seedBytes=rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0;module.exports=function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[],clockseq=void 0!==(options=options||{}).clockseq?options.clockseq:_clockseq,msecs=void 0!==options.msecs?options.msecs:(new Date).getTime(),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(clockseq=clockseq+1&16383),(dt<0||msecs>_lastMSecs)&&void 0===options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq;var tl=(1e4*(268435455&(msecs+=122192928e5))+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var node=options.node||_nodeId,n=0;n<6;++n)b[i+n]=node[n];return buf||bytesToUuid(b)}}}]);
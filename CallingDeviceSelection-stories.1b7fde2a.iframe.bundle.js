(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[2010],{"./ts/components/CallingDeviceSelection.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AllDevices:()=>AllDevices,Default:()=>Default,DefaultDevices:()=>DefaultDevices,SomeDevices:()=>SomeDevices,__namedExportsOrder:()=>__namedExportsOrder,default:()=>CallingDeviceSelection_stories});__webpack_require__("./node_modules/react/index.js");var esm=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),Modal=__webpack_require__("./ts/components/Modal.tsx"),Select=__webpack_require__("./ts/components/Select.tsx"),Calling=__webpack_require__("./ts/types/Calling.ts"),theme=__webpack_require__("./ts/util/theme.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function localizeDefault(i18n,deviceLabel){return deviceLabel.toLowerCase().startsWith("default")?deviceLabel.replace(/default/i,i18n("icu:callingDeviceSelection__select--default")):deviceLabel}function renderAudioOptions(devices,i18n){return devices.length?devices.map((function(device){return{text:localizeDefault(i18n,device.name),value:device.index}})):[{text:i18n("icu:callingDeviceSelection__select--no-device"),value:""}]}function renderVideoOptions(devices,i18n){return devices.length?devices.map((function(device){return{text:localizeDefault(i18n,device.label),value:device.deviceId}})):[{text:i18n("icu:callingDeviceSelection__select--no-device"),value:""}]}function createAudioChangeHandler(devices,changeIODevice,type){return function(value){changeIODevice({type,selectedDevice:devices[Number(value)]})}}function createCameraChangeHandler(changeIODevice){return function(value){changeIODevice({type:Calling.$B.CAMERA,selectedDevice:value})}}function CallingDeviceSelection(_ref){var availableCameras=_ref.availableCameras,availableMicrophones=_ref.availableMicrophones,availableSpeakers=_ref.availableSpeakers,changeIODevice=_ref.changeIODevice,i18n=_ref.i18n,selectedCamera=_ref.selectedCamera,selectedMicrophone=_ref.selectedMicrophone,selectedSpeaker=_ref.selectedSpeaker,toggleSettings=_ref.toggleSettings,selectedMicrophoneIndex=selectedMicrophone?selectedMicrophone.index:void 0,selectedSpeakerIndex=selectedSpeaker?selectedSpeaker.index:void 0;return(0,jsx_runtime.jsxs)(Modal.u_,{modalName:"CallingDeviceSelection",i18n,theme:theme.Q.Dark,onClose:toggleSettings,children:[(0,jsx_runtime.jsx)("div",{className:"module-calling-device-selection",children:(0,jsx_runtime.jsx)("button",{type:"button",className:"module-calling-device-selection__close-button",onClick:toggleSettings,tabIndex:0,"aria-label":i18n("icu:close")})}),(0,jsx_runtime.jsx)("h1",{className:"module-calling-device-selection__title",children:i18n("icu:callingDeviceSelection__settings")}),(0,jsx_runtime.jsx)("label",{htmlFor:"video",className:"module-calling-device-selection__label",children:i18n("icu:callingDeviceSelection__label--video")}),(0,jsx_runtime.jsx)("div",{className:"module-calling-device-selection__select",children:(0,jsx_runtime.jsx)(Select.P,{disabled:!availableCameras.length,id:"camera",name:"camera",onChange:createCameraChangeHandler(changeIODevice),options:renderVideoOptions(availableCameras,i18n),value:selectedCamera})}),(0,jsx_runtime.jsx)("label",{htmlFor:"audio-input",className:"module-calling-device-selection__label",children:i18n("icu:callingDeviceSelection__label--audio-input")}),(0,jsx_runtime.jsx)("div",{className:"module-calling-device-selection__select",children:(0,jsx_runtime.jsx)(Select.P,{disabled:!availableMicrophones.length,id:"audio-input",name:"audio-input",onChange:createAudioChangeHandler(availableMicrophones,changeIODevice,Calling.$B.MICROPHONE),options:renderAudioOptions(availableMicrophones,i18n),value:selectedMicrophoneIndex})}),(0,jsx_runtime.jsx)("label",{htmlFor:"audio-output",className:"module-calling-device-selection__label",children:i18n("icu:callingDeviceSelection__label--audio-output")}),(0,jsx_runtime.jsx)("div",{className:"module-calling-device-selection__select",children:(0,jsx_runtime.jsx)(Select.P,{disabled:!availableSpeakers.length,id:"audio-output",name:"audio-output",onChange:createAudioChangeHandler(availableSpeakers,changeIODevice,Calling.$B.SPEAKER),options:renderAudioOptions(availableSpeakers,i18n),value:selectedSpeakerIndex})})]})}CallingDeviceSelection.displayName="CallingDeviceSelection";var setupI18n=__webpack_require__("./ts/util/setupI18n.ts"),messages=__webpack_require__("./_locales/en/messages.json"),i18n=(0,setupI18n.E5)("en",messages),audioDevice={name:"",index:0,uniqueId:"",i18nKey:void 0},createProps=function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref$availableMicroph=_ref.availableMicrophones,availableMicrophones=void 0===_ref$availableMicroph?[]:_ref$availableMicroph,_ref$availableSpeaker=_ref.availableSpeakers,availableSpeakers=void 0===_ref$availableSpeaker?[]:_ref$availableSpeaker,_ref$selectedMicropho=_ref.selectedMicrophone,selectedMicrophone=void 0===_ref$selectedMicropho?audioDevice:_ref$selectedMicropho,_ref$selectedSpeaker=_ref.selectedSpeaker,selectedSpeaker=void 0===_ref$selectedSpeaker?audioDevice:_ref$selectedSpeaker,_ref$availableCameras=_ref.availableCameras,availableCameras=void 0===_ref$availableCameras?[]:_ref$availableCameras,_ref$selectedCamera=_ref.selectedCamera,selectedCamera=void 0===_ref$selectedCamera?"":_ref$selectedCamera;return{availableCameras,availableMicrophones,availableSpeakers,changeIODevice:(0,esm.action)("change-io-device"),i18n,selectedCamera,selectedMicrophone,selectedSpeaker,toggleSettings:(0,esm.action)("toggle-settings")}};const CallingDeviceSelection_stories={title:"Components/CallingDeviceSelection"};function Default(){return(0,jsx_runtime.jsx)(CallingDeviceSelection,Object.assign({},createProps()))}function SomeDevices(){var availableSpeakers=[{name:"Default",index:0,uniqueId:"Default",i18nKey:"default_communication_device"},{name:"Natalie's Airpods (Bluetooth)",index:1,uniqueId:"aa"},{name:"UE Boom (Bluetooth)",index:2,uniqueId:"bb"}],props=createProps({availableSpeakers,selectedSpeaker:availableSpeakers[0]});return(0,jsx_runtime.jsx)(CallingDeviceSelection,Object.assign({},props))}function DefaultDevices(){var availableSpeakers=[{name:"default (Headphones)",index:0,uniqueId:"Default",i18nKey:"default_communication_device"}],availableMicrophones=[{name:"DefAuLt (Headphones)",index:0,uniqueId:"Default",i18nKey:"default_communication_device"}],props=createProps({availableMicrophones,availableSpeakers,selectedMicrophone:availableMicrophones[0],selectedSpeaker:availableSpeakers[0]});return(0,jsx_runtime.jsx)(CallingDeviceSelection,Object.assign({},props))}function AllDevices(){var availableSpeakers=[{name:"Default",index:0,uniqueId:"Default",i18nKey:"default_communication_device"},{name:"Natalie's Airpods (Bluetooth)",index:1,uniqueId:"aa"},{name:"UE Boom (Bluetooth)",index:2,uniqueId:"bb"}],availableMicrophones=[{name:"Default",index:0,uniqueId:"Default",i18nKey:"default_communication_device"},{name:"Natalie's Airpods (Bluetooth)",index:1,uniqueId:"aa"}],props=createProps({availableCameras:[{deviceId:"dfbe6effe70b0611ba0fdc2a9ea3f39f6cb110e6687948f7e5f016c111b7329c",groupId:"63ee218d2446869e40adfc958ff98263e51f74382b0143328ee4826f20a76f47",kind:"videoinput",label:"FaceTime HD Camera (Built-in) (9fba:bced)",toJSON:function(){return""}},{deviceId:"e2db196a31d50ff9b135299dc0beea67f65b1a25a06d8a4ce76976751bb7a08d",groupId:"218ba7f00d7b1239cca15b9116769e5e7d30cc01104ebf84d667643661e0ecf9",kind:"videoinput",label:"Logitech Webcam (4e72:9058)",toJSON:function(){return""}}],availableMicrophones,availableSpeakers,selectedCamera:"dfbe6effe70b0611ba0fdc2a9ea3f39f6cb110e6687948f7e5f016c111b7329c",selectedMicrophone:availableMicrophones[0],selectedSpeaker:availableSpeakers[0]});return(0,jsx_runtime.jsx)(CallingDeviceSelection,Object.assign({},props))}Default.displayName="Default",SomeDevices.displayName="SomeDevices",DefaultDevices.displayName="DefaultDevices",AllDevices.displayName="AllDevices";var __namedExportsOrder=["Default","SomeDevices","DefaultDevices","AllDevices"]},"./ts/components/Select.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{P:()=>Select});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),Select=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function SelectInner(_ref,ref){var ariaLabel=_ref.ariaLabel,disabled=_ref.disabled,id=_ref.id,moduleClassName=_ref.moduleClassName,name=_ref.name,onChange=_ref.onChange,options=_ref.options,value=_ref.value,onSelectChange=(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(event){onChange(event.target.value)}),[onChange]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_1___default()(["module-select",moduleClassName]),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("select",{"aria-label":ariaLabel,disabled,id,name,value,onChange:onSelectChange,ref,children:options.map((function(_ref2){var optionDisabled=_ref2.disabled,text=_ref2.text,optionValue=_ref2.value;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("option",{disabled:optionDisabled,value:optionValue,"aria-label":text,children:text},optionValue)}))})})}))},"./ts/types/Calling.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";var CallMode,CallViewMode,CallState,CallEndedReason,GroupCallConnectionState,GroupCallJoinState,CallingDeviceType;__webpack_require__.d(__webpack_exports__,{$B:()=>CallingDeviceType,GT:()=>GroupCallJoinState,KQ:()=>CallEndedReason,L6:()=>CallMode,OX:()=>CallState,mB:()=>GroupCallConnectionState,pC:()=>CallViewMode}),function(CallMode){CallMode.None="None",CallMode.Direct="Direct",CallMode.Group="Group"}(CallMode||(CallMode={})),function(CallViewMode){CallViewMode.Grid="Grid",CallViewMode.Speaker="Speaker",CallViewMode.Presentation="Presentation"}(CallViewMode||(CallViewMode={})),function(CallState){CallState.Prering="idle",CallState.Ringing="ringing",CallState.Accepted="connected",CallState.Reconnecting="connecting",CallState.Ended="ended"}(CallState||(CallState={})),function(CallEndedReason){CallEndedReason.LocalHangup="LocalHangup",CallEndedReason.RemoteHangup="RemoteHangup",CallEndedReason.RemoteHangupNeedPermission="RemoteHangupNeedPermission",CallEndedReason.Declined="Declined",CallEndedReason.Busy="Busy",CallEndedReason.Glare="Glare",CallEndedReason.ReCall="ReCall",CallEndedReason.ReceivedOfferExpired="ReceivedOfferExpired",CallEndedReason.ReceivedOfferWhileActive="ReceivedOfferWhileActive",CallEndedReason.ReceivedOfferWithGlare="ReceivedOfferWithGlare",CallEndedReason.SignalingFailure="SignalingFailure",CallEndedReason.GlareFailure="GlareFailure",CallEndedReason.ConnectionFailure="ConnectionFailure",CallEndedReason.InternalFailure="InternalFailure",CallEndedReason.Timeout="Timeout",CallEndedReason.AcceptedOnAnotherDevice="AcceptedOnAnotherDevice",CallEndedReason.DeclinedOnAnotherDevice="DeclinedOnAnotherDevice",CallEndedReason.BusyOnAnotherDevice="BusyOnAnotherDevice",CallEndedReason.CallerIsNotMultiring="CallerIsNotMultiring"}(CallEndedReason||(CallEndedReason={})),function(GroupCallConnectionState){GroupCallConnectionState[GroupCallConnectionState.NotConnected=0]="NotConnected",GroupCallConnectionState[GroupCallConnectionState.Connecting=1]="Connecting",GroupCallConnectionState[GroupCallConnectionState.Connected=2]="Connected",GroupCallConnectionState[GroupCallConnectionState.Reconnecting=3]="Reconnecting"}(GroupCallConnectionState||(GroupCallConnectionState={})),function(GroupCallJoinState){GroupCallJoinState[GroupCallJoinState.NotJoined=0]="NotJoined",GroupCallJoinState[GroupCallJoinState.Joining=1]="Joining",GroupCallJoinState[GroupCallJoinState.Joined=2]="Joined"}(GroupCallJoinState||(GroupCallJoinState={})),function(CallingDeviceType){CallingDeviceType[CallingDeviceType.CAMERA=0]="CAMERA",CallingDeviceType[CallingDeviceType.MICROPHONE=1]="MICROPHONE",CallingDeviceType[CallingDeviceType.SPEAKER=2]="SPEAKER"}(CallingDeviceType||(CallingDeviceType={}))},"./ts/util/missingCaseError.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{b:()=>missingCaseError});var missingCaseError=function(x){return new TypeError(`Unhandled case: ${function reallyJsonStringify(value){var result;try{result=JSON.stringify(value)}catch(_err){result=void 0}return"string"==typeof result?result:Object.prototype.toString.call(value)}(x)}`)}},"./node_modules/lodash/first.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/lodash/head.js")},"./node_modules/lodash/head.js":module=>{module.exports=function head(array){return array&&array.length?array[0]:void 0}},"./node_modules/lodash/last.js":module=>{module.exports=function last(array){var length=null==array?0:array.length;return length?array[length-1]:void 0}}}]);
"use strict";(globalThis.webpackChunksignal_desktop=globalThis.webpackChunksignal_desktop||[]).push([[710],{"./ts/components/MediaQualitySelector.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{HighQuality:()=>HighQuality,StandardQuality:()=>StandardQuality,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/esm/index.js"),_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/addon-knobs/dist/index.js"),_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./_locales/en/messages.json"),_MediaQualitySelector__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/components/MediaQualitySelector.tsx"),_util_setupI18n__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/util/setupI18n.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Components/MediaQualitySelector"};var i18n=(0,_util_setupI18n__WEBPACK_IMPORTED_MODULE_5__.E5)("en",_locales_en_messages_json__WEBPACK_IMPORTED_MODULE_3__),createProps=function(){var overrideProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{conversationId:"abc123",i18n,isHighQuality:(0,_storybook_addon_knobs__WEBPACK_IMPORTED_MODULE_2__.boolean)("isHighQuality",Boolean(overrideProps.isHighQuality)),onSelectQuality:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_1__.action)("onSelectQuality")}};function StandardQuality(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_MediaQualitySelector__WEBPACK_IMPORTED_MODULE_4__.i,Object.assign({},createProps()))}function HighQuality(){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(_MediaQualitySelector__WEBPACK_IMPORTED_MODULE_4__.i,Object.assign({},createProps({isHighQuality:!0})))}StandardQuality.displayName="StandardQuality",HighQuality.displayName="HighQuality";var __namedExportsOrder=["StandardQuality","HighQuality"]},"./ts/components/MediaQualitySelector.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>MediaQualitySelector});var lodash_noop__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/lodash/noop.js"),lodash_noop__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(lodash_noop__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-dom/index.js"),classnames__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_3__),react_popper__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-popper/lib/esm/Manager.js"),react_popper__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/react-popper/lib/esm/Reference.js"),react_popper__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/react-popper/lib/esm/Popper.js"),_hooks_useRefMerger__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./ts/hooks/useRefMerger.ts"),_util_handleOutsideClick__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./ts/util/handleOutsideClick.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MediaQualitySelector(_ref){var conversationId=_ref.conversationId,i18n=_ref.i18n,isHighQuality=_ref.isHighQuality,onSelectQuality=_ref.onSelectQuality,_useState2=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),2),menuShowing=_useState2[0],setMenuShowing=_useState2[1],_useState4=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),2),popperRoot=_useState4[0],setPopperRoot=_useState4[1],_useState6=_slicedToArray((0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(void 0),2),focusedOption=_useState6[0],setFocusedOption=_useState6[1],buttonRef=react__WEBPACK_IMPORTED_MODULE_1__.useRef(null),refMerger=(0,_hooks_useRefMerger__WEBPACK_IMPORTED_MODULE_4__.T)(),handleClick=function(){setMenuShowing(!0)},handleKeyDown=function(ev){popperRoot?("ArrowDown"!==ev.key&&"ArrowUp"!==ev.key||(setFocusedOption((function(oldFocusedOption){return 1===oldFocusedOption?0:1})),ev.stopPropagation(),ev.preventDefault()),"Enter"===ev.key&&(onSelectQuality(conversationId,Boolean(focusedOption)),setMenuShowing(!1),ev.stopPropagation(),ev.preventDefault())):"Enter"===ev.key&&setFocusedOption(isHighQuality?1:0)},handleClose=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((function(){setMenuShowing(!1),setFocusedOption(void 0)}),[setMenuShowing]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){if(menuShowing){var root=document.createElement("div");return setPopperRoot(root),document.body.appendChild(root),function(){document.body.removeChild(root),setPopperRoot(null)}}return lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}),[menuShowing,setPopperRoot,handleClose]),(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){return menuShowing?(0,_util_handleOutsideClick__WEBPACK_IMPORTED_MODULE_5__.p)((function(){return handleClose(),!0}),{containerElements:[popperRoot,buttonRef],name:"MediaQualitySelector"}):lodash_noop__WEBPACK_IMPORTED_MODULE_0___default()}),[menuShowing,popperRoot,handleClose]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)(react_popper__WEBPACK_IMPORTED_MODULE_7__.dK,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_popper__WEBPACK_IMPORTED_MODULE_8__.s,{children:function(_ref2){var ref=_ref2.ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("button",{"aria-label":i18n("icu:MediaQualitySelector--button"),className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({MediaQualitySelector__button:!0,"MediaQualitySelector__button--hq":isHighQuality,"MediaQualitySelector__button--active":menuShowing}),onClick:handleClick,onKeyDown:handleKeyDown,ref:refMerger(buttonRef,ref),type:"button"})}}),menuShowing&&popperRoot?(0,react_dom__WEBPACK_IMPORTED_MODULE_2__.createPortal)((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)(react_popper__WEBPACK_IMPORTED_MODULE_9__.r,{placement:"top-start",strategy:"fixed",children:function(_ref3){var ref=_ref3.ref,style=_ref3.style,placement=_ref3.placement;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{className:"MediaQualitySelector__popper","data-placement":placement,ref,style,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"MediaQualitySelector__title",children:i18n("icu:MediaQualitySelector--title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{"aria-label":i18n("icu:MediaQualitySelector--standard-quality-title"),className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({MediaQualitySelector__option:!0,"MediaQualitySelector__option--focused":0===focusedOption}),type:"button",onClick:function(){onSelectQuality(conversationId,!1),setMenuShowing(!1)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({"MediaQualitySelector__option--checkmark":!0,"MediaQualitySelector__option--selected":!isHighQuality})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"MediaQualitySelector__option--title",children:i18n("icu:MediaQualitySelector--standard-quality-title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"MediaQualitySelector__option--description",children:i18n("icu:MediaQualitySelector--standard-quality-description")})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("button",{"aria-label":i18n("icu:MediaQualitySelector--high-quality-title"),className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({MediaQualitySelector__option:!0,"MediaQualitySelector__option--focused":1===focusedOption}),type:"button",onClick:function(){onSelectQuality(conversationId,!0),setMenuShowing(!1)},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:classnames__WEBPACK_IMPORTED_MODULE_3___default()({"MediaQualitySelector__option--checkmark":!0,"MediaQualitySelector__option--selected":isHighQuality})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"MediaQualitySelector__option--title",children:i18n("icu:MediaQualitySelector--high-quality-title")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_6__.jsx)("div",{className:"MediaQualitySelector__option--description",children:i18n("icu:MediaQualitySelector--high-quality-description")})]})]})]})}}),popperRoot):null]})}MediaQualitySelector.displayName="MediaQualitySelector"},"./ts/hooks/useRefMerger.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>useRefMerger});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_util_refMerger__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./ts/util/refMerger.ts"),useRefMerger=function(){return(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(_util_refMerger__WEBPACK_IMPORTED_MODULE_1__.d,[])}},"./ts/util/handleOutsideClick.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_require__.d(__webpack_exports__,{p:()=>handleOutsideClick});var fakeClickHandlers=new Array;function runFakeClickHandlers(event){var _step,_iterator=_createForOfIteratorHelper(fakeClickHandlers.slice().reverse());try{for(_iterator.s();!(_step=_iterator.n()).done;){if((0,_step.value.handleEvent)(event))break}}catch(err){_iterator.e(err)}finally{_iterator.f()}}var handleOutsideClick=function(handler,_ref){var name=_ref.name,containerElements=_ref.containerElements,fakeHandler={name,handleEvent:function(event){var target=event.target;return!!containerElements.some((function(elem){var _elem$current;return!!elem&&(elem instanceof Node?elem.contains(target):null===(_elem$current=elem.current)||void 0===_elem$current?void 0:_elem$current.contains(target))}))||handler(target)}};if(fakeClickHandlers.push(fakeHandler),1===fakeClickHandlers.length){document.addEventListener("click",runFakeClickHandlers,!0)}return function(){var index=fakeClickHandlers.indexOf(fakeHandler);if(fakeClickHandlers.splice(index,1),0===fakeClickHandlers.length){document.removeEventListener("click",runFakeClickHandlers,!0)}}}},"./ts/util/refMerger.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>refMerger,d:()=>createRefMerger});var memoizee__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/memoizee/index.js"),memoizee__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(memoizee__WEBPACK_IMPORTED_MODULE_0__);function refMerger(){for(var _len=arguments.length,refs=new Array(_len),_key=0;_key<_len;_key++)refs[_key]=arguments[_key];return function(el){refs.forEach((function(ref){"function"==typeof ref?ref(el):ref&&(ref.current=el)}))}}function createRefMerger(){return memoizee__WEBPACK_IMPORTED_MODULE_0___default()(refMerger,{length:!1,max:1})}},"./node_modules/react-popper/lib/esm/Manager.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C8:()=>ManagerReferenceNodeContext,dK:()=>Manager,mq:()=>ManagerReferenceNodeSetterContext});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),ManagerReferenceNodeContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext(),ManagerReferenceNodeSetterContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext();function Manager(_ref){var children=_ref.children,_React$useState=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),referenceNode=_React$useState[0],setReferenceNode=_React$useState[1],hasUnmounted=react__WEBPACK_IMPORTED_MODULE_0__.useRef(!1);react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){return function(){hasUnmounted.current=!0}}),[]);var handleSetReferenceNode=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(node){hasUnmounted.current||setReferenceNode(node)}),[]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(ManagerReferenceNodeContext.Provider,{value:referenceNode},react__WEBPACK_IMPORTED_MODULE_0__.createElement(ManagerReferenceNodeSetterContext.Provider,{value:handleSetReferenceNode},children))}},"./node_modules/react-popper/lib/esm/Popper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{r:()=>Popper});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_Manager__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-popper/lib/esm/Manager.js"),_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-popper/lib/esm/utils.js"),_usePopper__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-popper/lib/esm/usePopper.js"),NOOP=function NOOP(){},NOOP_PROMISE=function NOOP_PROMISE(){return Promise.resolve(null)},EMPTY_MODIFIERS=[];function Popper(_ref){var _ref$placement=_ref.placement,placement=void 0===_ref$placement?"bottom":_ref$placement,_ref$strategy=_ref.strategy,strategy=void 0===_ref$strategy?"absolute":_ref$strategy,_ref$modifiers=_ref.modifiers,modifiers=void 0===_ref$modifiers?EMPTY_MODIFIERS:_ref$modifiers,referenceElement=_ref.referenceElement,onFirstUpdate=_ref.onFirstUpdate,innerRef=_ref.innerRef,children=_ref.children,referenceNode=react__WEBPACK_IMPORTED_MODULE_0__.useContext(_Manager__WEBPACK_IMPORTED_MODULE_1__.C8),_React$useState=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),popperElement=_React$useState[0],setPopperElement=_React$useState[1],_React$useState2=react__WEBPACK_IMPORTED_MODULE_0__.useState(null),arrowElement=_React$useState2[0],setArrowElement=_React$useState2[1];react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_utils__WEBPACK_IMPORTED_MODULE_2__.k$)(innerRef,popperElement)}),[innerRef,popperElement]);var options=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return{placement,strategy,onFirstUpdate,modifiers:[].concat(modifiers,[{name:"arrow",enabled:null!=arrowElement,options:{element:arrowElement}}])}}),[placement,strategy,onFirstUpdate,modifiers,arrowElement]),_usePopper=(0,_usePopper__WEBPACK_IMPORTED_MODULE_3__.D)(referenceElement||referenceNode,popperElement,options),state=_usePopper.state,styles=_usePopper.styles,forceUpdate=_usePopper.forceUpdate,update=_usePopper.update,childrenProps=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return{ref:setPopperElement,style:styles.popper,placement:state?state.placement:placement,hasPopperEscaped:state&&state.modifiersData.hide?state.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:state&&state.modifiersData.hide?state.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:styles.arrow,ref:setArrowElement},forceUpdate:forceUpdate||NOOP,update:update||NOOP_PROMISE}}),[setPopperElement,setArrowElement,placement,state,styles,update,forceUpdate]);return(0,_utils__WEBPACK_IMPORTED_MODULE_2__.$p)(children)(childrenProps)}},"./node_modules/react-popper/lib/esm/Reference.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>Reference});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),warning__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/warning/warning.js"),warning__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(warning__WEBPACK_IMPORTED_MODULE_1__),_Manager__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-popper/lib/esm/Manager.js"),_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-popper/lib/esm/utils.js");function Reference(_ref){var children=_ref.children,innerRef=_ref.innerRef,setReferenceNode=react__WEBPACK_IMPORTED_MODULE_0__.useContext(_Manager__WEBPACK_IMPORTED_MODULE_2__.mq),refHandler=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(node){(0,_utils__WEBPACK_IMPORTED_MODULE_3__.k$)(innerRef,node),(0,_utils__WEBPACK_IMPORTED_MODULE_3__.DL)(setReferenceNode,node)}),[innerRef,setReferenceNode]);return react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){return function(){return(0,_utils__WEBPACK_IMPORTED_MODULE_3__.k$)(innerRef,null)}}),[]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){warning__WEBPACK_IMPORTED_MODULE_1___default()(Boolean(setReferenceNode),"`Reference` should not be used outside of a `Manager` component.")}),[setReferenceNode]),(0,_utils__WEBPACK_IMPORTED_MODULE_3__.$p)(children)({ref:refHandler})}},"./node_modules/warning/warning.js":module=>{var warning=function(){};module.exports=warning}}]);